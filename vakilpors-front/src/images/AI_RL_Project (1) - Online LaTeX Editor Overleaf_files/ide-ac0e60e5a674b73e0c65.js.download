/*! For license information please see ide-ac0e60e5a674b73e0c65.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Frontend=t():(e.Frontend=e.Frontend||{},e.Frontend.ide=t())}(self,(function(){return function(){var __webpack_modules__={62085:function(e,t,n){e.exports=n(58209)},54411:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,p=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return p=e.done,e},e:function(e){f=!0,d=e},f:function(){try{p||null==n.return||n.return()}finally{if(f)throw d}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(l=a.key,d=void 0,d=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(l,"string"),"symbol"===r(d)?d:String(d)),a)}var l,d}n(58188),n(88233),n(95342),n(32501),n(71372),n(18178),n(6710),n(43430),n(9575),n(96264),n(34115),n(634),n(71245),n(26936),n(27233),n(28673),n(77950),n(21850),n(20796),n(15735),n(6886);var p=function(){"use strict";function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==t&&(t=[]),this.changes=t,null==n&&(n=[]),this.comments=n,this.setIdSeed(e.generateIdSeed()),this.resetDirtyState()}var t,n,r;return t=e,r=[{key:"generateIdSeed",value:function(){var e=Math.floor(32767*Math.random()).toString(16),t=Math.floor(16777216*Math.random()).toString(16),n=Math.floor((new Date).valueOf()/1e3).toString(16);return"00000000".substr(0,8-n.length)+n+"000000".substr(0,6-t.length)+t+"0000".substr(0,4-e.length)+e}},{key:"generateId",value:function(){return this.generateIdSeed()+"000001"}}],(n=[{key:"getIdSeed",value:function(){return this.id_seed}},{key:"setIdSeed",value:function(e){this.id_seed=e,this.id_increment=0}},{key:"newId",value:function(){this.id_increment++;var e=this.id_increment.toString(16);return this.id_seed+"000000".substr(0,6-e.length)+e}},{key:"getComment",value:function(e){var t,n=null,r=a(this.comments);try{for(r.s();!(t=r.n()).done;){var l=t.value;if(l.id===e){n=l;break}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"removeCommentId",value:function(e){var t=this.getComment(e);null!=t&&(this.comments=this.comments.filter((function(t){return t.id!==e})),this._markAsDirty(t,"comment","removed"))}},{key:"moveCommentId",value:function(e,t,n){var r,l=a(this.comments);try{for(l.s();!(r=l.n()).done;){var d=r.value;d.id===e&&(d.op.p=t,d.op.c=n,this._markAsDirty(d,"comment","moved"))}}catch(e){l.e(e)}finally{l.f()}}},{key:"getChange",value:function(e){var t,n=null,r=a(this.changes);try{for(r.s();!(t=r.n()).done;){var l=t.value;if(l.id===e){n=l;break}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getChanges",value:function(e){var t,n=[],r={},l=a(e);try{for(l.s();!(t=l.n()).done;)r[t.value]=!0}catch(e){l.e(e)}finally{l.f()}var d,p=a(this.changes);try{for(p.s();!(d=p.n()).done;){var f=d.value;r[f.id]&&(delete r[f.id],n.push(f))}}catch(e){p.e(e)}finally{p.f()}return n}},{key:"removeChangeId",value:function(e){var t=this.getChange(e);null!=t&&this._removeChange(t)}},{key:"removeChangeIds",value:function(e){if(null!=e&&0!==e.length){var t,n={},r=a(e);try{for(r.s();!(t=r.n()).done;)n[t.value]=!0}catch(e){r.e(e)}finally{r.f()}var l,d=[],p=a(this.changes);try{for(p.s();!(l=p.n()).done;){var f=l.value;n[f.id]?(delete n[f.id],this._markAsDirty(f,"change","removed")):d.push(f)}}catch(e){p.e(e)}finally{p.f()}this.changes=d}}},{key:"validate",value:function(e){var t,n,r=a(this.changes);try{for(r.s();!(n=r.n()).done;){var l=n.value;if(null!=l.op.i&&(t=e.slice(l.op.p,l.op.p+l.op.i.length))!==l.op.i)throw new Error("Change (".concat(JSON.stringify(l),") doesn't match text (").concat(JSON.stringify(t),")"))}}catch(e){r.e(e)}finally{r.f()}var d,p=a(this.comments);try{for(p.s();!(d=p.n()).done;){var f=d.value;if((t=e.slice(f.op.p,f.op.p+f.op.c.length))!==f.op.c)throw new Error("Comment (".concat(JSON.stringify(f),") doesn't match text (").concat(JSON.stringify(t),")"))}}catch(e){p.e(e)}finally{p.f()}}},{key:"applyOp",value:function(e,t){if(null==t&&(t={}),null==t.ts&&(t.ts=new Date),null!=e.i)this.applyInsertToChanges(e,t),this.applyInsertToComments(e);else if(null!=e.d)this.applyDeleteToChanges(e,t),this.applyDeleteToComments(e);else{if(null==e.c)throw new Error("unknown op type");this.addComment(e,t)}}},{key:"applyOps",value:function(e,t){null==t&&(t={});var n,r=a(e);try{for(r.s();!(n=r.n()).done;){var l=n.value;this.applyOp(l,t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"addComment",value:function(e,t){var n;null!=this.getComment(e.t)?this.moveCommentId(e.t,e.p,e.c):(this.comments.push(n={id:e.t||this.newId(),op:{c:e.c,p:e.p,t:e.t},metadata:t}),this._markAsDirty(n,"comment","added"))}},{key:"applyInsertToComments",value:function(e){var t,n=a(this.comments);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e.p<=r.op.p)r.op.p+=e.i.length,this._markAsDirty(r,"comment","moved");else if(e.p<r.op.p+r.op.c.length){var l=e.p-r.op.p;r.op.c=r.op.c.slice(0,+(l-1)+1||void 0)+e.i+r.op.c.slice(l),this._markAsDirty(r,"comment","moved")}}}catch(e){n.e(e)}finally{n.f()}}},{key:"applyDeleteToComments",value:function(e){var t,n=e.p,r=e.d.length,l=e.p+r,d=a(this.comments);try{for(d.s();!(t=d.n()).done;){var p=t.value,f=p.op.p,h=p.op.p+p.op.c.length,y=h-f;if(l<=f)p.op.p-=r,this._markAsDirty(p,"comment","moved");else if(n>=h);else{var _=void 0,w=void 0;w=n<=f?"":p.op.c.slice(0,n-f),_=l>=h?"":p.op.c.slice(l-f);var k=p.op.c.slice(w.length,y-_.length),S=Math.max(0,f-n);if(k!==e.d.slice(S).slice(0,k.length))throw new Error("deleted content does not match comment content");p.op.p=Math.min(f,n),p.op.c=w+_,this._markAsDirty(p,"comment","moved")}}}catch(e){d.e(e)}finally{d.f()}}},{key:"applyInsertToChanges",value:function(e,t){for(var n,r=e.p,a=e.i.length,l=e.p+a,d=!!e.u,p=!1,f=null,h=[],y=[],_=[],w=0;w<this.changes.length;w++){var k=(n=this.changes[w]).op.p;if(null!=n.op.d)r<k?(n.op.p+=a,h.push(n)):r===k&&(d&&n.op.d.length>=e.i.length&&n.op.d.slice(0,e.i.length)===e.i?(n.op.d=n.op.d.slice(e.i.length),n.op.p+=e.i.length,""===n.op.d?y.push(n):h.push(n),p=!0):(n.op.p+=a,h.push(n)));else if(null!=n.op.i){var S=void 0,C=k+n.op.i.length,P=r>=k&&r<=C,E=t.user_id===n.metadata.user_id,O=this.changes[w+1],j=null!=O&&null!=O.op.d&&e.p===C&&O.op.p===e.p,z=d&&j&&O.op.d.slice(0,e.i.length)===e.i,x=null!=f&&null!=f.op.d&&f.op.p===l;if(this.track_changes&&P&&!x&&!p&&!z&&E)S=r-k,n.op.i=n.op.i.slice(0,S)+e.i+n.op.i.slice(S),n.metadata.ts=t.ts,p=!0,h.push(n);else if(r<=k)n.op.p+=a,h.push(n);else if((!E||!this.track_changes)&&k<r&&r<C){S=r-k;var T=n.op.i.slice(0,S),I=n.op.i.slice(S);n.op.i=T,h.push(n);var D={op:{i:I,p:k+S+a},metadata:{}};for(var M in n.metadata){var R=n.metadata[M];D.metadata[M]=R}_.push(D)}}f=n}this.track_changes&&!p&&this._addOp(e,t);for(var A=0,N=_;A<N.length;A++){var L=N[A];e=L.op,t=L.metadata,this._addOp(e,t)}for(var H=0,F=y;H<F.length;H++)n=F[H],this._removeChange(n);for(var U=0,W=h;U<W.length;U++)n=W[U],this._markAsDirty(n,"change","moved")}},{key:"applyDeleteToChanges",value:function(e,t){var n,r=this,l=e.p,d=e.d.length,p=e.p+d,f=[],h=[],y=[],_=a(this.changes);try{for(_.s();!(n=_.n()).done;){var w=n.value,k=void 0;if(null!=w.op.i){var S=(k=w.op.p)+w.op.i.length;if(p<=k)w.op.p-=d,h.push(w);else if(l>=S);else{var C=void 0,P=void 0,E=void 0,O=void 0;l>=k?(P="",O=w.op.i.slice(0,l-k)):(P=e.d.slice(0,k-l),O=""),p<=S?(C="",E=w.op.i.slice(p-k)):(C=e.d.slice(S-l),E="");var j=O+E;j.length>0?(w.op.i=j,w.op.p=Math.min(k,l),h.push(w)):f.push(w);var z=e.d.length-P.length-C.length,x=P.length,T={d:e.d.slice(x,x+z),p:x};T.d.length>0&&y.push(T)}}else if(null!=w.op.d)if(p<(k=w.op.p)||!this.track_changes&&p===k)w.op.p-=d,h.push(w);else if(l<=k&&k<=p)if(this.track_changes){var I=k-l;y.push({i:w.op.d,p:I}),f.push(w)}else w.op.p=l,h.push(w)}}catch(e){_.e(e)}finally{_.f()}e={p:e.p,d:this._applyOpModifications(e.d,y)};for(var D=0,M=f;D<M.length;D++){var R=M[D];e.d.length>0&&null!=R.op.d&&e.p<=R.op.p&&R.op.p<=e.p+e.d.length?(R.op.p=e.p,R.op.d=e.d,R.metadata=t,h.push(R),e.d=""):this._removeChange(R)}if(this.track_changes&&e.d.length>0)this._addOp(e,t);else{var A=this._scanAndMergeAdjacentUpdates();h=h.concat(A.movedChanges);var N,L=a(A.removeChanges);try{var H=function(){var e=N.value;r._removeChange(e),h=h.filter((function(t){return t!==e}))};for(L.s();!(N=L.n()).done;)H()}catch(e){L.e(e)}finally{L.f()}}var F,U=a(h);try{for(U.s();!(F=U.n()).done;){var W=F.value;this._markAsDirty(W,"change","moved")}}catch(e){U.e(e)}finally{U.f()}}},{key:"_addOp",value:function(e,t){var n={id:this.newId(),op:this._clone(e),metadata:this._clone(t)};this.changes.push(n),this.changes.sort((function(e,t){var n=e.op.p-t.op.p;return 0!==n?n:null!=e.op.i&&null!=t.op.d?1:null!=e.op.d&&null!=t.op.i?-1:0})),this._markAsDirty(n,"change","added")}},{key:"_removeChange",value:function(e){this.changes=this.changes.filter((function(t){return t.id!==e.id})),this._markAsDirty(e,"change","removed")}},{key:"_applyOpModifications",value:function(e,t){t.sort((function(e,t){var n=t.p-e.p;return 0!==n?n:null!=e.i&&null!=t.d?1:null!=e.d&&null!=t.i?-1:0}));var n,r=a(t);try{for(r.s();!(n=r.n()).done;){var l=n.value;if(null!=l.i)e=e.slice(0,l.p)+l.i+e.slice(l.p);else if(null!=l.d){if(e.slice(l.p,l.p+l.d.length)!==l.d)throw new Error("deleted content does not match. content: ".concat(JSON.stringify(e),"; modification: ").concat(JSON.stringify(l)));e=e.slice(0,l.p)+e.slice(l.p+l.d.length)}}}catch(e){r.e(e)}finally{r.f()}return e}},{key:"_scanAndMergeAdjacentUpdates",value:function(){var e,t=null,n=[],r=[],l=a(this.changes);try{for(l.s();!(e=l.n()).done;){var d,p,f,h=e.value;if(null!=(null===(d=t)||void 0===d?void 0:d.op.i)&&null!=h.op.i){var y=t.op.p+t.op.i.length,_=t.metadata.user_id,w=h.op.p,k=h.metadata.user_id;y===w&&_===k&&(n.push(h),t.op.i+=h.op.i,r.push(t))}else null!=(null===(p=t)||void 0===p?void 0:p.op.d)&&null!=h.op.d&&(null===(f=t)||void 0===f?void 0:f.op.p)===h.op.p?(t.op.d+=h.op.d,n.push(h),r.push(t)):t=h}}catch(e){l.e(e)}finally{l.f()}return{movedChanges:r,removeChanges:n}}},{key:"resetDirtyState",value:function(){this._dirtyState={comment:{moved:{},removed:{},added:{}},change:{moved:{},removed:{},added:{}}}}},{key:"getDirtyState",value:function(){return this._dirtyState}},{key:"_markAsDirty",value:function(e,t,n){this._dirtyState[t][n][e.id]=e}},{key:"_clone",value:function(e){var t={};for(var n in e){var r=e[n];t[n]=r}return t}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=p},20696:function(e,t,n){"use strict";n.d(t,{i:function(){return d}});var r=n(96227),a=n(99618),l=!1;function d(){if(!l){l=!0;var e=(0,a.Z)("ol-project_id");(0,r.BZ)("document-first-change",{projectId:e,isSmallDevice:r.UJ})}}},93519:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return On}});var r={};n.r(r);var a={};n.r(a);var l={};n.r(l);n(77950),n(94908),n(74069),n(32501),n(39529);var d=n(72079);n(26936),n(27233),n(28673),n(16781),n(18178),n(43450),n(43430),n(58188),n(73439),n(21515),n(71372),n(99805),n(31235),n(9575),n(96264),n(34115),n(634),n(71245),n(20796),n(15735),n(6886);d.Z.controller("FileTreeController",["$scope",function(e){e.openNewDocModal=function(){window.dispatchEvent(new CustomEvent("file-tree.start-creating",{detail:{mode:"doc"}}))},e.orderByFoldersFirst=function(e){return"folder"===(null!=e?e.type:void 0)?"0":"1"}}]);n(34769),n(95342),n(68625),n(1939),n(62775);var p,f=n(46353),h=n(76635),y=n.n(h),_=n(17754),w=n(13980),k=n.n(w),S=n(2784),C=n(28316),P=new Uint8Array(16);function E(){if(!p&&!(p="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return p(P)}var O=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var j=function(e){return"string"==typeof e&&O.test(e)},z=[],x=0;x<256;++x)z.push((x+256).toString(16).substr(1));var T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(z[e[t+0]]+z[e[t+1]]+z[e[t+2]]+z[e[t+3]]+"-"+z[e[t+4]]+z[e[t+5]]+"-"+z[e[t+6]]+z[e[t+7]]+"-"+z[e[t+8]]+z[e[t+9]]+"-"+z[e[t+10]]+z[e[t+11]]+z[e[t+12]]+z[e[t+13]]+z[e[t+14]]+z[e[t+15]]).toLowerCase();if(!j(n))throw TypeError("Stringified UUID is invalid");return n};var I=function(e,t,n){var r=(e=e||{}).random||(e.rng||E)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return T(r)},D=function(e){var t;void 0===e&&(e=S.Fragment);return{component:function(n){var r=(0,S.useState)([]),a=r[0],l=r[1];return(0,S.useEffect)((function(){t=function(e){return l((function(t){return t.push(e),[].concat(t)})),{update:function(t){l((function(n){var r=n.find((function(t){return(null==t?void 0:t.key)===e.key}));return r?(r.props=t,[].concat(n)):n}))},remove:function(){l((function(t){var n=t.findIndex((function(t){return(null==t?void 0:t.key)===e.key}));return-1===n?t:(t[n]=void 0,[].concat(t))}))}}}}),[]),S.createElement(e,Object.assign({},n),a.map((function(e){if(!e)return null;var t=e.key,n=e.node,r=e.component,a=e.props;return(0,C.createPortal)(S.createElement(r,Object.assign({key:t},a)),n)})))},use:function(e){return function(n){var r=(0,S.useRef)(I()),a=(0,S.useRef)(null),l=(0,S.useRef)();return(0,S.useEffect)((function(){l.current&&l.current.update(n)}),[n]),(0,S.useEffect)((function(){if(a.current&&a.current.parentElement)return l.current=t({key:r.current,node:a.current.parentElement,component:e,props:n}),l.current.remove}),[]),S.createElement("div",{ref:a,style:{display:"none"}})}}}},M=n(80564);n(88233),n(21850);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===R(l)?l:String(l)),r)}var a,l}var N=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t}var t,n,r;return t=e,(n=[{key:"get",value:function(e){return y().get(this.$scope,e)}},{key:"set",value:function(e,t){var n=this;this.$scope.$applyAsync((function(){return y().set(n.$scope,e,t)}))}},{key:"watch",value:function(e,t,n){return this.$scope.$watch(e,(function(e){return t(n?y().cloneDeep(e):e)}),n)}}])&&A(t.prototype,n),r&&A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==L(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===L(l)?l:String(l)),r)}var a,l}var F=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t}var t,n,r;return t=e,n=[{key:"emit",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var l,d;t?(l=this.$scope).$broadcast.apply(l,[e].concat(r)):(d=this.$scope).$emit.apply(d,[e].concat(r))}},{key:"on",value:function(e,t){return this.$scope.$on(e,t)}}],n&&H(t.prototype,n),r&&H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),U=n(96931),W=n(29954),B=n(52322);function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,d,p=[],f=!0,h=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=l.call(n)).done)&&(p.push(r.value),p.length!==t);f=!0);}catch(e){h=!0,a=e}finally{try{if(!f&&null!=n.return&&(d=n.return(),Object(d)!==d))return}finally{if(h)throw a}}return p}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Z=function(e){var t=e.ide,n=e.children,r=V((0,S.useState)((function(){return t||(0,W.L)()})),1)[0],a=V((0,S.useState)((function(){return new N(r.$scope)})),1)[0],l=V((0,S.useState)((function(){return new F(r.$scope)})),1)[0];return(0,B.jsx)(U.P,{ide:r,scopeStore:a,scopeEventEmitter:l,children:n})},G=n(22866),Y=n(29248),X=n(36915),J=n(39493),K=n(2976),Q=n(76591),ee=n(13364),te=n(89825),ne=n(91354),oe=n(50641),re=n(97502),se=n(72309),ae=n(19816);function ce(e){var t=e.children,n=e.ide;return(0,B.jsx)(te._8,{children:(0,B.jsx)(Z,{ide:n,children:(0,B.jsx)(M.dr,{children:(0,B.jsx)(se.B9,{children:(0,B.jsx)(ee.jI,{children:(0,B.jsx)(ne.T,{children:(0,B.jsx)(re.Ek,{children:(0,B.jsx)(K.dn,{children:(0,B.jsx)(G.KU,{children:(0,B.jsx)(oe.ou,{children:(0,B.jsx)(J.aM,{children:(0,B.jsx)(Y.gy,{children:(0,B.jsx)(X.in,{children:(0,B.jsx)(Q.aM,{children:(0,B.jsx)(ae.H,{children:t})})})})})})})})})})})})})})})}ce.propTypes={children:k().any,ide:k().object};var le=D(ce);function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ue(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ue(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}d.Z.controller("ReactFileTreeController",["$scope","$timeout","ide",function(e,t,n){function r(){if(e.connection){var t="ready"===e.connection.state,n="waitingCountdown"===e.connection.state&&null===e.connection.reconnection_countdown;e.isConnected=t||n}else e.isConnected=!1}e.isConnected=!0,e.$on("project:joined",(function(){e.$emit("file-tree:initialized")})),e.$watch("editor.open_doc_id",(function(e){window.dispatchEvent(new CustomEvent("editor.openDoc",{detail:e}))})),e.$on("file-tree.reselectDoc",(function(e,t){window.dispatchEvent(new CustomEvent("editor.openDoc",{detail:t}))})),e.$watch("connection.state",r),e.$watch("connection.reconnection_countdown",r),e.onInit=function(){t((function(){e.$emit("left-pane-resize-all")}))},e.onSelect=function(t){if(1===t.length){var n=t[0],r="fileRef"===n.type?"file":n.type;e.$emit("entity:selected",pe(pe({},n.entity),{},{id:n.entity._id,type:r})),e.$emit("entities:multiSelected",{count:0})}else t.length>1?e.$emit("entities:multiSelected",{count:t.length}):e.$emit("entity:no-selection")},e.refProviders=n.$scope.user.refProviders||{},n.$scope.$watch("user.refProviders",(function(t){e.refProviders=(0,h.cloneDeep)(t)}),!0),e.setRefProviderEnabled=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.$scope.$applyAsync((function(){n.$scope.user.refProviders[e]=t}))},e.setStartedFreeTrial=function(t){e.$applyAsync((function(){e.startedFreeTrial=t}))},e.reindexReferences=function(){n.$scope.$emit("references:should-reindex",{})}}]),d.Z.component("fileTreeRoot",(0,f.react2angular)(le.use(_.Z),Object.keys(_.Z.propTypes)));var he=n(45177);function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==me(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===me(l)?l:String(l)),r)}var a,l}var ge=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$on("project:joined",(function(){return r.loadRootFolder(),r.loadDeletedDocs(),r.$scope.$emit("file-tree:initialized")})),this.$scope.$on("entities:multiSelected",(function(e,t){r.$scope.$apply((function(){r.$scope.multiSelectedCount=t.count,r.$scope.editor.multiSelectedCount=t.count}))})),this.$scope.$watch("rootFolder",(function(e){if(null!=e)return r.recalculateDocList()})),this._bindToSocketEvents(),this.$scope.multiSelectedCount=0,$(document).on("click",(function(){r.clearMultiSelectedEntities(),setTimeout((function(){return r.$scope.$digest()}),0)}))}var t,n,r;return t=e,n=[{key:"_bindToSocketEvents",value:function(){var e=this;return this.ide.socket.on("reciveNewDoc",(function(t,n){var r=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return r.children.push({name:n.name,id:n._id,type:"doc"}),e.recalculateDocList()}))})),this.ide.socket.on("reciveNewFile",(function(t,n,r,a){var l=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return l.children.push({name:n.name,id:n._id,type:"file",linkedFileData:a,created:n.created}),e.recalculateDocList()}))})),this.ide.socket.on("reciveNewFolder",(function(t,n){var r=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return r.children.push({name:n.name,id:n._id,type:"folder",children:[]}),e.recalculateDocList()}))})),this.ide.socket.on("reciveEntityRename",(function(t,n){var r=e.findEntityById(t);if(null!=r)return e.$scope.$apply((function(){return r.name=n,e.recalculateDocList()}))})),this.ide.socket.on("removeEntity",(function(t){var n=e.findEntityById(t);if(null!=n)return e.$scope.$apply((function(){return e._deleteEntityFromScope(n),e.recalculateDocList()})),e.$scope.$broadcast("entity:deleted",n)})),this.ide.socket.on("reciveEntityMove",(function(t,n){var r=e.findEntityById(t),a=e.findEntityById(n);return e.$scope.$apply((function(){return e._moveEntityInScope(r,a),e.recalculateDocList()}))}))}},{key:"selectEntity",value:function(e){return this.selected_entity_id=e.id,this.ide.fileTreeManager.forEachEntity((function(e){return e.selected=!1})),e.selected=!0}},{key:"getMultiSelectedEntities",value:function(){var e=[];return this.forEachEntity((function(t){if(t.multiSelected)return e.push(t)})),e}},{key:"getFullCount",value:function(){var e=[];return this.forEachEntity((function(t){t.deleted||e.push(t)})),e.length}},{key:"getMultiSelectedEntityChildNodes",value:function(){for(var e=this.getMultiSelectedEntities(),t={},n=0,r=Array.from(e);n<r.length;n++){var a=r[n];t["/"+this.getEntityPath(a)]=a}var l={};for(var d in t){t[d];var p=d.split("/");if(!(p.length<=2))for(var f=1,h=p.length-1,y=h>=1;y?f<=h:f>=h;y?f++:f--)l["/"+p.slice(0,f).join("/")]=!0}var _=[];for(var w in t){var k=t[w];null==l[w]&&_.push(k)}return _}},{key:"clearMultiSelectedEntities",value:function(){if(0!==this.$scope.multiSelectedCount)return this.forEachEntity((function(e){return e.multiSelected=!1})),this.$scope.multiSelectedCount=0}},{key:"existsInFolder",value:function(e,t){var n=this.findEntityById(e);return null!=n&&null!=this._findEntityByPathInFolder(n,t)}},{key:"findSelectedEntity",value:function(){var e=null;return this.forEachEntity((function(t){if(t.selected)return e=t})),e}},{key:"findEntityById",value:function(e,t){if(null==t&&(t={}),this.$scope.rootFolder.id===e)return this.$scope.rootFolder;var n=this._findEntityByIdInFolder(this.$scope.rootFolder,e);if(null!=n)return n;if(t.includeDeleted)for(var r=0,a=Array.from(this.$scope.deletedDocs);r<a.length;r++)if((n=a[r]).id===e)return n;return null}},{key:"_findEntityByIdInFolder",value:function(e,t){for(var n=0,r=Array.from(e.children||[]);n<r.length;n++){var a=r[n];if(a.id===t)return a;if(null!=a.children){var l=this._findEntityByIdInFolder(a,t);if(null!=l)return l}}return null}},{key:"findEntityByPath",value:function(e){return this._findEntityByPathInFolder(this.$scope.rootFolder,e)}},{key:"getPreviewByPath",value:function(e){for(var t=0,n=["",".png",".jpg",".jpeg",".pdf",".PNG",".JPG",".JPEG",".PDF"];t<n.length;t++){var r=n[t],a=this.findEntityByPath(e+r);if(a)return{url:"/project/".concat(this.$scope.project._id,"/file/").concat(a.id),extension:a.name.split(".").pop()}}return null}},{key:"_findEntityByPathInFolder",value:function(e,t){if(null==t||null==e)return null;if(""===t)return e;var n=t.split("/"),r=n.shift(),a=n.join("/");if("."===r)return this._findEntityByPathInFolder(e,a);for(var l=0,d=Array.from(e.children);l<d.length;l++){var p=d[l];if(p.name===r){if(""===a)return p;if("folder"===p.type)return this._findEntityByPathInFolder(p,a)}}return null}},{key:"forEachEntity",value:function(e){var t=this;return null==e&&(e=function(){}),this._forEachEntityInFolder(this.$scope.rootFolder,null,e),function(){for(var n=[],r=0,a=Array.from(t.$scope.deletedDocs||[]);r<a.length;r++){var l=a[r];n.push(e(l))}return n}()}},{key:"_forEachEntityInFolder",value:function(e,t,n){var r=this;return function(){for(var a=[],l=0,d=Array.from(e.children||[]);l<d.length;l++){var p=d[l],f=void 0;f=null!=t?t+"/"+p.name:p.name,n(p,e,f),null!=p.children?a.push(r._forEachEntityInFolder(p,f,n)):a.push(void 0)}return a}()}},{key:"getEntityPath",value:function(e){return this._getEntityPathInFolder(this.$scope.rootFolder,e)}},{key:"_getEntityPathInFolder",value:function(e,t){for(var n=0,r=Array.from(e.children||[]);n<r.length;n++){var a=r[n];if(a===t)return t.name;if("folder"===a.type){var l=this._getEntityPathInFolder(a,t);if(null!=l)return a.name+"/"+l}}return null}},{key:"getRootDocDirname",value:function(){var e=this.findEntityById(this.$scope.project.rootDoc_id);if(null!=e)return this._getEntityDirname(e)}},{key:"_getEntityDirname",value:function(e){var t=this.getEntityPath(e);if(null!=t)return t.split("/").slice(0,-1).join("/")}},{key:"_findParentFolder",value:function(e){var t=this._getEntityDirname(e);if(null!=t)return this.findEntityByPath(t)}},{key:"loadRootFolder",value:function(){return this.$scope.rootFolder=this._parseFolder((e=null!=this.$scope?this.$scope.project:void 0,t=function(e){return e.rootFolder[0]},null!=e?t(e):void 0));var e,t}},{key:"_parseFolder",value:function(e){for(var t={name:e.name,id:e._id,type:"folder",children:[],selected:e._id===this.selected_entity_id},n=0,r=Array.from(e.docs||[]);n<r.length;n++){var a=r[n];t.children.push({name:a.name,id:a._id,type:"doc",selected:a._id===this.selected_entity_id})}for(var l=0,d=Array.from(e.fileRefs||[]);l<d.length;l++){var p=d[l];t.children.push({name:p.name,id:p._id,type:"file",selected:p._id===this.selected_entity_id,linkedFileData:p.linkedFileData,created:p.created})}for(var f=0,h=Array.from(e.folders||[]);f<h.length;f++){var y=h[f];t.children.push(this._parseFolder(y))}return t}},{key:"loadDeletedDocs",value:function(){var e=this;return this.$scope.deletedDocs=[],Array.from(this.$scope.project.deletedDocs||[]).map((function(t){return e.$scope.deletedDocs.push({name:t.name,id:t._id,type:"doc",deleted:!0})}))}},{key:"recalculateDocList",value:function(){var e=this;return this.$scope.docs=[],this.forEachEntity((function(t,n,r){if("doc"===t.type&&!t.deleted)return e.$scope.docs.push({doc:t,path:r})})),this.$scope.docs.sort((function(e,t){var n=(e.path.match(/\//g)||[]).length,r=(t.path.match(/\//g)||[]).length;return n-r!=0?-(n-r):e.path<t.path?-1:e.path>t.path?1:0}))}},{key:"getCurrentFolder",value:function(){return this._getCurrentFolder(this.$scope.rootFolder)||this.$scope.rootFolder}},{key:"_getCurrentFolder",value:function(e){null==e&&(e=this.$scope.rootFolder);for(var t=0,n=Array.from(e.children||[]);t<n.length;t++){var r=n[t];if(r.selected)return"folder"===r.type?r:e;if("folder"===r.type){var a=this._getCurrentFolder(r);if(null!=a)return a}}return null}},{key:"projectContainsFolder",value:function(){for(var e=0,t=Array.from(this.$scope.rootFolder.children);e<t.length;e++)if("folder"===t[e].type)return!0;return!1}},{key:"existsInThisFolder",value:function(e,t){for(var n=0,r=Array.from((null!=e?e.children:void 0)||[]);n<r.length;n++)if(r[n].name===t)return!0;return!1}},{key:"nameExistsError",value:function nameExistsError(e){null==e&&(e="already exists");var t=this.ide.$q.defer();return t.reject({data:e}),t.promise}},{key:"createDoc",value:function(e,t){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/doc"),{name:e,parent_folder_id:null!=t?t.id:void 0,_csrf:window.csrfToken})}},{key:"createFolder",value:function(e,t){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/folder"),{name:e,parent_folder_id:null!=t?t.id:void 0,_csrf:window.csrfToken})}},{key:"createLinkedFile",value:function(e,t,n,r){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/linked_file"),{name:e,parent_folder_id:null!=t?t.id:void 0,provider:n,data:r,_csrf:window.csrfToken},{disableAutoLoginRedirect:!0})}},{key:"refreshLinkedFile",value:function(e){if(this._findParentFolder(e),null!=(null!=e.linkedFileData?e.linkedFileData.provider:void 0))return this.ide.$http.post("/project/".concat(this.ide.project_id,"/linked_file/").concat(e.id,"/refresh"),{_csrf:window.csrfToken},{disableAutoLoginRedirect:!0});he.c.warn(">> no provider for ".concat(e.name),e)}},{key:"renameEntity",value:function(e,t,n){if(null==n&&(n=function(){}),e.name!==t&&!(t.length>=150)){var r=this.getCurrentFolder();return this.existsInThisFolder(r,t)?this.nameExistsError():(e.renamingToName=t,this.ide.$http.post("/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id,"/rename"),{name:t,_csrf:window.csrfToken}).then((function(){return e.name=t})).finally((function(){return e.renamingToName=null})))}}},{key:"deleteEntity",value:function(e,t){return null==t&&(t=function(){}),this.ide.queuedHttp({method:"DELETE",url:"/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id),headers:{"X-Csrf-Token":window.csrfToken}})}},{key:"moveEntity",value:function(e,t){var n=this;if(!this._isChildFolder(e,t)){if(this.existsInThisFolder(t,e.name))throw new Error("file exists in this location");this.ide.queuedHttp.post("/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id,"/move"),{folder_id:t.id,_csrf:window.csrfToken}).then((function(){n._moveEntityInScope(e,t)}))}}},{key:"_isChildFolder",value:function(e,t){var n=this.getEntityPath(e)||"";return(this.getEntityPath(t)||"").slice(0,n.length)===n}},{key:"_deleteEntityFromScope",value:function(e,t){if(null==t&&(t={moveToDeleted:!0}),null!=e){var n=null;if(this.forEachEntity((function(t,r){if(t===e)return n=r})),null!=n){var r=n.children.indexOf(e);r>-1&&n.children.splice(r,1)}return"folder"!==e.type&&e.selected&&(this.$scope.ui.view=null),"doc"===e.type&&t.moveToDeleted?(e.deleted=!0,this.$scope.deletedDocs.push(e)):void 0}}},{key:"_moveEntityInScope",value:function(e,t){if(!Array.from(t.children).includes(e))return this._deleteEntityFromScope(e,{moveToDeleted:!1}),t.children.push(e)}}],n&&ve(t.prototype,n),r&&ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();var ye=n(73545);function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==be(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===be(l)?l:String(l)),r)}var a,l}var we,$e=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t;var r=new Promise((function(e){n.resolveSocketPromise=e}));Promise.all([r,ye.Z]).then((function(){n.$scope.$apply((function(){n.$scope.state.load_progress=100,n.$scope.state.loading=!1,n.$scope.$emit("editor:loaded")}))})).catch((function(){n.$scope.$apply((function(){n.$scope.state.error="Could not load translations."}))}))}var t,n,r;return t=e,(n=[{key:"socketLoaded",value:function(){this.resolveSocketPromise()}}])&&_e(t.prototype,n),r&&_e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ke=(n(14121),n(60523),n(28399),n(92462)),Se=n(99618);function Ce(e){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ce(e)}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return(t=ze(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ze(r.key),r)}}function ze(e){var t=function(e,t){if("object"!==Ce(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ce(t)?t:String(t)}var xe=36e5,Te=(we=function(){function e(t,n){var r,a=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.wsUrl=t.wsUrl||null,"undefined"==typeof io||null===io)return this.wsUrl&&!window.location.href.match(/ws=fallback/)&&(window.location=window.location.href+"?ws=fallback"),he.c.error("Socket.io javascript not loaded. Please check that the real-time service is running and accessible."),this.ide.socket=ke.Z.stub(),void this.$scope.$apply((function(){return a.$scope.state.error="Could not connect to websocket server :("}));setInterval((function(){return a.disconnectIfInactive()}),xe),window.addEventListener("online",(function(){if(he.c.log("[online] browser notified online"),!a.connected)return a.tryReconnectWithRateLimit({force:!0})})),this.userIsLeavingPage=!1,window.addEventListener("beforeunload",(function(){a.userIsLeavingPage=!0})),this.connected=!1,this.userIsInactive=!1,this.gracefullyReconnecting=!1,this.shuttingDown=!1,this.$scope.connection={debug:he.j,reconnecting:!1,stillReconnecting:!1,forced_disconnect:!1,inactive_disconnect:!1,jobId:0},this.$scope.tryReconnectNow=function(){return a.tryReconnectWithRateLimit({force:!0})},this.$scope.$on("cursor:editor:update",(function(){if(a.lastUserAction=new Date,!a.connected)return a.tryReconnectWithRateLimit()})),document.querySelector("body").addEventListener("click",(function(e){if(!a.shuttingDown&&!a.connected&&"try-reconnect-now-button"!==e.target.id)return a.tryReconnectWithRateLimit()})),this.updateConnectionManagerState("connecting");try{r=new URL(this.wsUrl||"/socket.io",window.location)}catch(e){this.wsUrl&&0!==this.wsUrl.indexOf("/")&&!window.location.href.match(/ws=fallback/)&&(window.location=window.location.href+"?ws=fallback"),r={origin:null,pathname:this.wsUrl||"/socket.io"}}var l=new URLSearchParams({projectId:(0,Se.Z)("ol-project_id")}).toString();this.ide.socket=ke.Z.connect(r.origin,{resource:r.pathname.slice(1),reconnect:!1,"connect timeout":3e4,"force new connection":!0,query:l});var d=1,p=function(e){return window.wsRetryHandshake&&d++<window.wsRetryHandshake?setTimeout((function(){return a.ide.socket.socket.connect()}),d*(1+Math.random())*1e3):(a.updateConnectionManagerState("error"),he.c.log("socket.io error",e),!a.wsUrl||window.location.href.match(/ws=fallback/)?(a.connected=!1,a.$scope.$apply((function(){return a.$scope.state.error="Unable to connect, please view the <u><a href='/learn/Kb/Connection_problems'>connection problems guide</a></u> to fix the issue."}))):void(window.location=window.location.href+"?ws=fallback"))};this.ide.socket.on("error",p),this.ide.socket.on("connect",(function(){a.ide.socket.removeListener("error",p),he.c.log("[socket.io connect] Connected"),a.updateConnectionManagerState("authenticating")})),this.ide.socket.on("joinProjectResponse",(function(e){var t=e.publicId,n=e.project,r=e.permissionsLevel,l=e.protocolVersion;a.ide.socket.publicId=t,he.c.log("[socket.io bootstrap] ready for joinDoc"),a.connected=!0,a.gracefullyReconnecting=!1,a.ide.pushEvent("connected"),a.ide.pushEvent("joinProjectResponse"),a.updateConnectionManagerState("joining"),a.$scope.$apply((function(){a.$scope.state.loading&&(a.$scope.state.load_progress=70)})),a.handleJoinProjectResponse({project:n,permissionsLevel:r,protocolVersion:l})})),this.ide.socket.on("connectionRejected",(function(e){return he.c.log("[socket.io connectionRejected] session not valid or other connection error"),"retry"===(null==e?void 0:e.message)||"TooManyRequests"===(null==e?void 0:e.code)?a.tryReconnectWithRateLimit():"ProjectNotFound"!==(null==e?void 0:e.code)?a.reportConnectionError(e):void a.ide.showGenericMessageModal("Project has been deleted","This project has been deleted by the owner.").result.then((function(){return location.reload(!0)}))})),this.ide.socket.on("connect_failed",(function(){return a.updateConnectionManagerState("error"),a.connected=!1,a.$scope.$apply((function(){return a.$scope.state.error="Unable to connect, please view the <u><a href='/learn/Kb/Connection_problems'>connection problems guide</a></u> to fix the issue."}))})),this.ide.socket.on("disconnect",(function(){he.c.log("[socket.io disconnect] Disconnected"),a.connected=!1,a.ide.pushEvent("disconnected"),a.$scope.connection.state.match(/^waiting/)||(a.$scope.connection.forced_disconnect||a.userIsInactive||a.shuttingDown?a.updateConnectionManagerState("inactive"):a.startAutoReconnectCountdown())})),this.ide.socket.on("forceDisconnect",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return a.updateConnectionManagerState("inactive"),a.shuttingDown=!0,a.$scope.$apply((function(){return a.$scope.permissions.write=!1,a.$scope.connection.forced_disconnect=!0})),a.ide.$scope.$broadcast("flush-changes"),setTimeout((function(){return a.ide.socket.disconnect()}),1e3),a.ide.showLockEditorMessageModal("Please wait","We're performing maintenance on Overleaf and you need to wait a moment.\nSorry for any inconvenience.\nThe editor will refresh automatically in ".concat(t," seconds.")),setTimeout((function(){return location.reload()}),1e3*t)})),this.ide.socket.on("reconnectGracefully",(function(){he.c.log("Reconnect gracefully"),a.reconnectGracefully()}))}var t,n,r;return t=e,r=[{key:"initClass",value:function(){this.prototype.disconnectAfterMs=864e5,this.prototype.lastUserAction=new Date,this.prototype.MIN_RETRY_INTERVAL=1e3,this.prototype.BACKGROUND_RETRY_INTERVAL=5e3,this.prototype.RECONNECT_GRACEFULLY_RETRY_INTERVAL=5e3,this.prototype.MAX_RECONNECT_GRACEFULLY_INTERVAL=45e3}}],(n=[{key:"updateConnectionManagerState",value:function(e){var t=this;this.$scope.$apply((function(){t.$scope.connection.jobId+=1;var n=t.$scope.connection.jobId;he.c.log("[updateConnectionManagerState ".concat(n,"] from ").concat(t.$scope.connection.state," to ").concat(e)),t.$scope.connection.state=e,t.$scope.connection.reconnecting=!1,t.$scope.connection.stillReconnecting=!1,t.$scope.connection.inactive_disconnect=!1,t.$scope.connection.joining=!1,t.$scope.connection.reconnection_countdown=null,"connecting"===e||("reconnecting"===e?(t.stopReconnectCountdownTimer(),t.$scope.connection.reconnecting=!0,setTimeout((function(){t.$scope.connection.reconnecting&&t.$scope.connection.jobId===n&&(t.$scope.connection.stillReconnecting=!0)}),1e3)):"reconnectFailed"===e||"authenticating"===e||("joining"===e?t.$scope.connection.joining=!0:"ready"===e||("waitingCountdown"===e||"waitingGracefully"===e?t.stopReconnectCountdownTimer():"inactive"===e||"error"===e||he.c.log("[WARN] [updateConnectionManagerState ".concat(n,"] got unrecognised state ").concat(e)))))}))}},{key:"expectConnectionManagerState",value:function(e,t){return!(this.$scope.connection.state!==e||t&&t!==this.$scope.connection.jobId)||(he.c.log("[WARN] [state mismatch] expected state ".concat(e).concat(t?"/"+t:""," when in ").concat(this.$scope.connection.state,"/").concat(this.$scope.connection.jobId)),!1)}},{key:"reportConnectionError",value:function reportConnectionError(e){return he.c.log("[socket.io] reporting connection error"),this.updateConnectionManagerState("error"),"not authorized"===(null!=e?e.message:void 0)||"invalid session"===(null!=e?e.message:void 0)?window.location="/login?redir=".concat(encodeURI(window.location.pathname)):(this.ide.socket.disconnect(),this.ide.showGenericMessageModal("Something went wrong connecting","Something went wrong connecting to your project. Please refresh if this continues to happen."))}},{key:"handleJoinProjectResponse",value:function(e){var t=this,n=e.project,r=e.permissionsLevel,a=e.protocolVersion;null!=this.$scope.protocolVersion&&this.$scope.protocolVersion!==a&&location.reload(!0),this.$scope.$apply((function(){t.updateConnectionManagerState("ready"),t.$scope.protocolVersion=a,t.$scope.project=Ee(Ee({},{rootDoc_id:null}),n),t.$scope.permissionsLevel=r,t.ide.loadingManager.socketLoaded(),window.dispatchEvent(new CustomEvent("project:joined",{detail:t.$scope.project})),t.$scope.$broadcast("project:joined")}))}},{key:"reconnectImmediately",value:function(){return this.disconnect(),this.tryReconnect()}},{key:"disconnect",value:function(e){if(e&&e.permanent)he.c.log("[disconnect] shutting down ConnectionManager"),this.updateConnectionManagerState("inactive"),this.shuttingDown=!0;else if(this.ide.socket.socket&&!this.ide.socket.socket.connected)return void he.c.log("[socket.io] skipping disconnect because socket.io has not connected");return he.c.log("[socket.io] disconnecting client"),this.ide.socket.disconnect()}},{key:"startAutoReconnectCountdown",value:function(){var e=this;this.updateConnectionManagerState("waitingCountdown");var t,n=this.$scope.connection.jobId;he.c.log("[ConnectionManager] starting autoreconnect countdown"),t=null!=this.lastUserAction&&new Date-this.lastUserAction>12e4?60+Math.floor(120*Math.random()):3+Math.floor(7*Math.random()),this.userIsLeavingPage||(this.$scope.$apply((function(){e.$scope.connection.reconnecting=!1,e.$scope.connection.stillReconnecting=!1,e.$scope.connection.joining=!1,e.$scope.connection.reconnection_countdown=t})),setTimeout((function(){e.connected||e.countdownTimeoutId||(e.countdownTimeoutId=setTimeout((function(){return e.decreaseCountdown(n)}),1e3))}),200))}},{key:"stopReconnectCountdownTimer",value:function(){null!=this.countdownTimeoutId&&(he.c.log("[ConnectionManager] cancelling existing reconnect timer"),clearTimeout(this.countdownTimeoutId),this.countdownTimeoutId=null)}},{key:"decreaseCountdown",value:function(e){var t=this;this.countdownTimeoutId=null,null!=this.$scope.connection.reconnection_countdown&&(this.expectConnectionManagerState("waitingCountdown",e)?(he.c.log("[ConnectionManager] decreasing countdown",this.$scope.connection.reconnection_countdown),this.$scope.$apply((function(){t.$scope.connection.reconnection_countdown--})),this.$scope.connection.reconnection_countdown<=0?(this.$scope.connection.reconnecting=!1,this.$scope.$apply((function(){t.tryReconnect()}))):this.countdownTimeoutId=setTimeout((function(){return t.decreaseCountdown(e)}),1e3)):he.c.log("[ConnectionManager] Aborting stale countdown ".concat(e)))}},{key:"tryReconnect",value:function(){var e=this;if(he.c.log("[ConnectionManager] tryReconnect"),!(this.connected||this.shuttingDown||this.$scope.connection.reconnecting)){this.updateConnectionManagerState("reconnecting"),he.c.log("[ConnectionManager] Starting new connection");var t=function(){e.ide.socket.removeListener("error",n),e.ide.socket.removeListener("connect",r)},n=function(){he.c.log("[ConnectionManager] tryReconnect: failed"),t(),e.updateConnectionManagerState("reconnectFailed"),e.tryReconnectWithRateLimit({force:!0})},r=function(){he.c.log("[ConnectionManager] tryReconnect: success"),t()};this.ide.socket.on("error",n),this.ide.socket.on("connect",r),this.ide.socket.socket.connect(),this.lastConnectionAttempt=new Date}}},{key:"tryReconnectWithRateLimit",value:function(e){if(!this.$scope.connection.reconnecting&&!this.connected){var t=null!=this.$scope.connection.reconnection_countdown&&this.$scope.connection.reconnection_countdown<=5,n=null!=e?e.force:void 0;if(!t||n){var r=n?this.MIN_RETRY_INTERVAL:this.BACKGROUND_RETRY_INTERVAL;null!=this.lastConnectionAttempt&&new Date-this.lastConnectionAttempt<r?"waitingCountdown"!==this.$scope.connection.state&&this.startAutoReconnectCountdown():this.tryReconnect()}}}},{key:"disconnectIfInactive",value:function(){var e=this;if(this.userIsInactive=new Date-this.lastUserAction>this.disconnectAfterMs,this.userIsInactive&&this.connected)return this.disconnect(),this.$scope.$apply((function(){return e.$scope.connection.inactive_disconnect=!0}))}},{key:"reconnectGracefully",value:function(e){var t=this;if(null==this.reconnectGracefullyStarted)this.reconnectGracefullyStarted=new Date;else if(!e)return void he.c.log("[reconnectGracefully] reconnection is already in process, so skipping");var n=new Date-this.lastUserAction>this.RECONNECT_GRACEFULLY_RETRY_INTERVAL,r=new Date-this.reconnectGracefullyStarted>this.MAX_RECONNECT_GRACEFULLY_INTERVAL;n||r?(he.c.log("[reconnectGracefully] User didn't do anything for last 5 seconds, reconnecting"),this._reconnectGracefullyNow()):(he.c.log("[reconnectGracefully] User is working, will try again in 5 seconds"),this.updateConnectionManagerState("waitingGracefully"),setTimeout((function(){t.reconnectGracefully(!0)}),this.RECONNECT_GRACEFULLY_RETRY_INTERVAL))}},{key:"_reconnectGracefullyNow",value:function(){return this.gracefullyReconnecting=!0,this.reconnectGracefullyStarted=null,$.cookie("SERVERID","",{expires:-1,path:"/"}),this.reconnectImmediately()}}])&&je(t.prototype,n),r&&je(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),we.initClass(),we),Ie=(n(96928),n(92215),n(61229),n(54411)),De=n.n(Ie),Me=n(78297),Re=n(58976);function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Ne(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,p=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){p=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(p)throw l}}}}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==Ae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===Ae(l)?l:String(l)),r)}var a,l}function Ue(e,t,n){return t&&Fe(e.prototype,t),n&&Fe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var We,Be="ShareJsDoc",Ve=function(){function e(t){He(this,e),this._onTimeoutHandler=t,this._lastReport=void 0,this._queue=[]}return Ue(e,[{key:"_getMetaPreferLocal",value:function(){var e,t=Ne(this._queue);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.scope===Be)return n}}catch(e){t.e(e)}finally{t.f()}return this._queue.pop()}},{key:"onTimeout",value:function(e){var t=this;this._queue.push(e),setTimeout((function(){if(t._queue.length){var e=t._getMetaPreferLocal();t._queue.length=0;var n=Date.now();n-t._lastReport<6e4||(t._lastReport=n,t._onTimeoutHandler(e))}}))}}]),e}(),qe=function(){function e(t){var n=t.parent,r=t.onTimeoutHandler;He(this,e),this.scope=n?Be:"global",this.timeout=6e4,this.parent=n,this.reporter=n?n.reporter:new Ve(r),this.lastAck=null,this.lastUnackedEdit=null}return Ue(e,[{key:"onAck",value:function(){this.lastAck=performance.now(),this.parent&&this.parent.onAck()}},{key:"onEdit",value:function(){var e=performance.now();this.lastAck>this.lastUnackedEdit&&(this.lastUnackedEdit=null),this.lastUnackedEdit||(this.lastUnackedEdit=e);var t=e-this.lastUnackedEdit;if(t>this.timeout){var n=Date.now()-e,r={scope:this.scope,delay:t,lastAck:new Date(this.lastAck?n+this.lastAck:0),lastUnackedEdit:new Date(n+this.lastUnackedEdit)};this._log("timedOut",r),this.reporter.onTimeout(r)}}},{key:"attachToEditor",value:function(e,t){var n,r=this;if("CM6"===e){this._log("attach to editor",e),n=function(e,t){"remote"!==t.origin&&(t.removed||t.inserted)&&r.onEdit()},t.on("change",n);return function(){r._log("detach from editor",e),t.off("change",n)}}n="CM"===e?function(e,t){"remote"!==t.origin&&(t.removed||t.text)&&r.onEdit()}:function(e){"remote"!==e.origin&&("remove"!==e.action&&"insert"!==e.action||r.onEdit())},this._log("attach to editor",e),t.on("change",n);return function(){r._log("detach from editor",e),t.off("change",n)}}},{key:"_log",value:function(){he.c.log.apply(he.c,["[EditorWatchdogManager] ".concat(this.scope,":")].concat(Array.prototype.slice.call(arguments)))}}]),e}(),Ze=n(20696);function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function Ye(e){return function(e){if(Array.isArray(e))return Xe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==Ge(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ge(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===Ge(l)?l:String(l)),r)}var a,l}function Ke(e,t){return Ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ke(e,t)}function Qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=et(e);if(t){var a=et(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function et(e){return et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},et(e)}var tt,nt=(We=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ke(e,t)}(l,e);var t,n,r,a=Qe(l);function l(e,t,n,r,d){var p;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(p=a.call(this)).doc_id=e,p.socket=r,p.type="text";var f=(t=Array.from(t).map((function(e){return decodeURIComponent(escape(e))}))).join("\n");return p.track_changes=!1,p.connection={send:function(e){if(p._startInflightOpTimeout(e),null!=window.disconnectOnUpdate&&Math.random()<window.disconnectOnUpdate&&(he.c.log("Disconnecting on update",e),window._ide.socket.socket.disconnect()),!(null!=window.dropUpdates&&Math.random()<window.dropUpdates))return p.track_changes&&(null==e.meta&&(e.meta={}),e.meta.tc=p.track_changes_id_seeds.inflight),p.socket.emit("applyOtUpdate",p.doc_id,e,(function(e){if(null!=e)return p._handleError(e)}));he.c.log("Simulating a lost update",e)},state:"ok",id:p.socket.publicId},p._doc=new Re.Z.Doc(p.connection,p.doc_id,{type:p.type}),p._doc.setFlushDelay(2e3),p._doc.on("change",(function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=p).trigger.apply(e,["change"].concat(Ye(Array.from(n))))})),p.EditorWatchdogManager=new qe({parent:d}),p._doc.on("acknowledge",(function(){return p.lastAcked=new Date,p.EditorWatchdogManager.onAck(),p.trigger("acknowledge")})),p._doc.on("remoteop",(function(){var e;p._doc.setFlushDelay(500);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=p).trigger.apply(e,["remoteop"].concat(Ye(Array.from(n))))})),p._doc.on("flipped_pending_to_inflight",(function(){return p.trigger("flipped_pending_to_inflight")})),p._doc.on("saved",(function(){return p.trigger("saved")})),p._doc.on("error",(function(e){return p._handleError(e)})),p._bindToDocChanges(p._doc),p.processUpdateFromServer({open:!0,v:n,snapshot:f}),p._removeCarriageReturnCharFromShareJsDoc(),p}return t=l,n=[{key:"_removeCarriageReturnCharFromShareJsDoc",value:function(){var e,t=this._doc;if(-1!==t.snapshot.indexOf("\r"))for(window._ide.pushEvent("remove-carriage-return-char",{doc_id:this.doc_id});-1!==(e=t.snapshot.indexOf("\r"));)he.c.log("[ShareJsDoc] remove-carriage-return-char",e),t.del(e,1)}},{key:"submitOp",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this._doc).submitOp.apply(e,Ye(Array.from(n||[])))}},{key:"_isAheadOfExpectedVersion",value:function(e){return this._doc.version>0&&e.v>this._doc.version}},{key:"_pushOntoQueue",value:function(e){var t=this;he.c.log("[processUpdate] push onto queue ".concat(e.v)),this.queuedMessageTimer||(this.queuedMessageTimer=setTimeout((function(){he.c.log("[processUpdate] queue timeout fired for ".concat(e.v)),t.processUpdateFromServer(e)}),this.INFLIGHT_OP_TIMEOUT)),this.queuedMessages.push(e),this.queuedMessages.sort((function(e,t){return e.v-t.v}))}},{key:"_clearQueue",value:function(){this.queuedMessages=[]}},{key:"_processQueue",value:function(){if(this.queuedMessages.length>0){var e=this.queuedMessages[0].v;e>this._doc.version||(he.c.log("[processUpdate] taken from queue ".concat(e)),this.processUpdateFromServerInOrder(this.queuedMessages.shift()),0===this.queuedMessages.length&&this.queuedMessageTimer&&(he.c.log("[processUpdate] queue is empty, cleared timeout"),clearTimeout(this.queuedMessageTimer),this.queuedMessageTimer=null))}}},{key:"processUpdateFromServerInOrder",value:function(e){if(this.queuedMessages||(this.queuedMessages=[]),this._isAheadOfExpectedVersion(e))this._pushOntoQueue(e);else{var t=this.processUpdateFromServer(e);t instanceof Error&&"Invalid version from server"===t.message?this._clearQueue():this._processQueue()}}},{key:"processUpdateFromServer",value:function(e){try{this._doc._onMessage(e)}catch(e){return he.c.error(e),this._handleError(e),e}if("external"===(t=null!=e?e.meta:void 0,n=function(e){return e.type},null!=t?n(t):void 0))return this.trigger("externalUpdate",e);var t,n}},{key:"catchUp",value:function(e){var t=this;return function(){for(var n=[],r=0;r<e.length;r++){var a=e[r];a.v=t._doc.version,a.doc=t.doc_id,n.push(t.processUpdateFromServer(a))}return n}()}},{key:"getSnapshot",value:function(){return this._doc.snapshot}},{key:"getVersion",value:function(){return this._doc.version}},{key:"getType",value:function(){return this.type}},{key:"clearInflightAndPendingOps",value:function(){return this._clearFatalTimeoutTimer(),this._doc.inflightOp=null,this._doc.inflightCallbacks=[],this._doc.pendingOp=null,this._doc.pendingCallbacks=[]}},{key:"flushPendingOps",value:function(){return this._doc.flush()}},{key:"updateConnectionState",value:function(e){return he.c.log("[updateConnectionState] Setting state to ".concat(e)),this.connection.state=e,this.connection.id=this.socket.publicId,this._doc.autoOpen=!1,this._doc._connectionStateChanged(e),this.lastAcked=null}},{key:"hasBufferedOps",value:function(){return null!=this._doc.inflightOp||null!=this._doc.pendingOp}},{key:"getInflightOp",value:function(){return this._doc.inflightOp}},{key:"getPendingOp",value:function(){return this._doc.pendingOp}},{key:"getRecentAck",value:function(){return null!=this.lastAcked&&new Date-this.lastAcked<4e3}},{key:"getOpSize",value:function(e){for(var t=0,n=0,r=Array.from(e||[]);n<r.length;n++){var a=r[n];null!=(null!=a?a.i:void 0)&&(t+=a.i.length),null!=(null!=a?a.d:void 0)&&(t+=a.d.length)}return t}},{key:"_attachEditorWatchdogManager",value:function(e,t){this._detachEditorWatchdogManager=this.EditorWatchdogManager.attachToEditor(e,t)}},{key:"_attachToEditor",value:function(e,t,n){this._attachEditorWatchdogManager(e,t),n()}},{key:"_maybeDetachEditorWatchdogManager",value:function(){this._detachEditorWatchdogManager&&(this._detachEditorWatchdogManager(),delete this._detachEditorWatchdogManager)}},{key:"attachToCM6",value:function(e){var t=this;this._attachToEditor("CM6",e,(function(){e.attachShareJs(t._doc,window.maxDocLength)}))}},{key:"detachFromCM6",value:function(){this._maybeDetachEditorWatchdogManager(),this._doc.detach_cm6&&this._doc.detach_cm6()}},{key:"_startInflightOpTimeout",value:function(e){var t=this;this._startFatalTimeoutTimer(e);var n=setTimeout((function n(){if(he.c.log("[inflightOpTimeout] Trying op again"),null!=t._doc.inflightOp)return e.dupIfSource=[t.connection.id].concat(Ye(Array.from(t._doc.inflightSubmittedIds))),"ok"!==t.connection.state?(he.c.log("[inflightOpTimeout] Not connected, retrying in 0.5s"),setTimeout(n,t.WAIT_FOR_CONNECTION_TIMEOUT)):(he.c.log("[inflightOpTimeout] Sending"),t.connection.send(e))}),this.INFLIGHT_OP_TIMEOUT);return this._doc.inflightCallbacks.push((function(){return t._clearFatalTimeoutTimer(),clearTimeout(n)}))}},{key:"_startFatalTimeoutTimer",value:function(e){var t=this;if(null==this._timeoutTimer)return this._timeoutTimer=setTimeout((function(){return t._clearFatalTimeoutTimer(),t.trigger("op:timeout",e)}),this.FATAL_OP_TIMEOUT)}},{key:"_clearFatalTimeoutTimer",value:function(){if(null!=this._timeoutTimer)return clearTimeout(this._timeoutTimer),this._timeoutTimer=null}},{key:"_handleError",value:function _handleError(e,t){return null==t&&(t={}),this.trigger("error",e,t)}},{key:"_bindToDocChanges",value:function(e){var t=this,n=e.submitOp;e.submitOp=function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return(0,Ze.i)(),t.trigger.apply(t,["op:sent"].concat(Ye(Array.from(a)))),e.pendingCallbacks.push((function(){return t.trigger.apply(t,["op:acknowledged"].concat(Ye(Array.from(a))))})),n.apply(e,a)};var r=e.flush;return e.flush=function(){t.trigger("flush",e.inflightOp,e.pendingOp,e.version);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r.apply(e,a)}}}],r=[{key:"initClass",value:function(){this.prototype.INFLIGHT_OP_TIMEOUT=5e3,this.prototype.WAIT_FOR_CONNECTION_TIMEOUT=500,this.prototype.FATAL_OP_TIMEOUT=3e4}}],n&&Je(t.prototype,n),r&&Je(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Me.Z),We.initClass(),We);function ot(e){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(e)}function it(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=st(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,p=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){p=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(p)throw l}}}}function rt(e){return function(e){if(Array.isArray(e))return at(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||st(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e,t){if(e){if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?at(e,t):void 0}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==ot(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===ot(l)?l:String(l)),r)}var a,l}function lt(e,t){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lt(e,t)}function ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dt(e);if(t){var a=dt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}var pt=(tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lt(e,t)}(l,e);var t,n,r,a=ut(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=a.call(this)).ide=e,n.doc_id=t,n.connected=n.ide.socket.socket.connected,n.joined=!1,n.wantToBeJoined=!1,n._checkCM6Consistency=function(){return n._checkConsistency(n.cm6)},n._bindToEditorEvents(),n._bindToSocketEvents(),n}return t=l,n=[{key:"editorType",value:function(){return this.cm6?"cm6":null}},{key:"attachToCM6",value:function(e){return this.cm6=e,null!=this.doc&&this.doc.attachToCM6(this.cm6),null!=this.cm6&&this.cm6.on("change",this._checkCM6Consistency),this.ide.$scope.$emit("document:opened",this.doc)}},{key:"detachFromCM6",value:function(){return null!=this.doc&&this.doc.detachFromCM6(),null!=this.cm6&&this.cm6.off("change",this._checkCM6Consistency),delete this.cm6,this.clearChaosMonkey(),this.ide.$scope.$emit("document:closed",this.doc)}},{key:"submitOp",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null!=this.doc?(e=this.doc).submitOp.apply(e,rt(Array.from(n||[]))):void 0}},{key:"_checkConsistency",value:function(e){var t=this;return setTimeout((function(){var n=null!=e?e.getValue():void 0;if(n!==(null!=t.doc?t.doc.getSnapshot():void 0))return t._onError(new Error("Editor text does not match server text"),{},n)}),0)}},{key:"getSnapshot",value:function(){return null!=this.doc?this.doc.getSnapshot():void 0}},{key:"getType",value:function(){return null!=this.doc?this.doc.getType():void 0}},{key:"getInflightOp",value:function(){return null!=this.doc?this.doc.getInflightOp():void 0}},{key:"getPendingOp",value:function(){return null!=this.doc?this.doc.getPendingOp():void 0}},{key:"getRecentAck",value:function(){return null!=this.doc?this.doc.getRecentAck():void 0}},{key:"getOpSize",value:function(e){return null!=this.doc?this.doc.getOpSize(e):void 0}},{key:"hasBufferedOps",value:function(){return null!=this.doc?this.doc.hasBufferedOps():void 0}},{key:"setTrackingChanges",value:function(e){return this.doc.track_changes=e}},{key:"getTrackingChanges",value:function(){return!!this.doc.track_changes}},{key:"setTrackChangesIdSeeds",value:function(e){return this.doc.track_changes_id_seeds=e}},{key:"_bindToSocketEvents",value:function(){var e=this;return this._onUpdateAppliedHandler=function(t){return e._onUpdateApplied(t)},this.ide.socket.on("otUpdateApplied",this._onUpdateAppliedHandler),this._onErrorHandler=function(t,n){n.doc_id===e.doc_id&&e._onError(t,n)},this.ide.socket.on("otUpdateError",this._onErrorHandler),this._onDisconnectHandler=function(t){return e._onDisconnect(t)},this.ide.socket.on("disconnect",this._onDisconnectHandler)}},{key:"_bindToEditorEvents",value:function(){var e=this;return this._unsubscribeReconnectHandler=this.ide.$scope.$on("project:joined",(function(t){return e._onReconnect(t)}))}},{key:"_unBindFromEditorEvents",value:function(){return this._unsubscribeReconnectHandler()}},{key:"_unBindFromSocketEvents",value:function(){return this.ide.socket.removeListener("otUpdateApplied",this._onUpdateAppliedHandler),this.ide.socket.removeListener("otUpdateError",this._onErrorHandler),this.ide.socket.removeListener("disconnect",this._onDisconnectHandler)}},{key:"leaveAndCleanUp",value:function(e){var t=this;return this.leave((function(n){t._cleanUp(),e&&e(n)}))}},{key:"join",value:function(e){return null==e&&(e=function(){}),this.wantToBeJoined=!0,this._cancelLeave(),this.connected?this._joinDoc(e):(this._joinCallbacks||(this._joinCallbacks=[]),this._joinCallbacks.push(e))}},{key:"leave",value:function(e){return null==e&&(e=function(){}),this.flush(),this.wantToBeJoined=!1,this._cancelJoin(),null!=this.doc&&this.doc.hasBufferedOps()?(he.c.log("[leave] Doc has buffered ops, pushing callback for later"),this._leaveCallbacks||(this._leaveCallbacks=[]),this._leaveCallbacks.push(e)):this.connected?(he.c.log("[leave] Leaving now"),this._leaveDoc(e)):(he.c.log("[leave] Not connected, returning now"),e())}},{key:"flush",value:function(){return null!=this.doc?this.doc.flushPendingOps():void 0}},{key:"chaosMonkey",value:function(e,t){var n=this;null==e&&(e=0),null==t&&(t="a");var r=t,a=null,l=0;return this._cm=function d(){return null!=a&&a.length||(a=r.slice()+" "+new Date+"\n",(e+=Math.random()>.1?1:-2)<0&&(e=0),l=0),t=a[0],a=a.slice(1),n.cm6&&n.cm6.view.dispatch({changes:{from:Math.min(l,n.cm6.view.state.doc.length),insert:t}}),l+=1,n._cm=setTimeout(d,100+(Math.random()<.1?1e3:0))}()}},{key:"clearChaosMonkey",value:function(){var e=this._cm;if(e)return delete this._cm,clearTimeout(e)}},{key:"pollSavedStatus",value:function(){var e,t=this.getInflightOp(),n=this.getPendingOp(),r=this.getRecentAck(),a=null!=n&&this.getOpSize(n);return null==t&&null==n?(e=!0,he.c.log("[pollSavedStatus] no inflight or pending ops")):null!=t&&t===this.oldInflightOp?(e=!1,he.c.log("[pollSavedStatus] inflight op is same as before")):null!=n&&r&&a<this.MAX_PENDING_OP_SIZE?(e=!0,he.c.log("[pollSavedStatus] pending op (small with recent ack) assume ok",n,a)):(e=!1,he.c.log("[pollSavedStatus] assuming not saved (inflightOp?: ".concat(null!=t,", pendingOp?: ").concat(null!=n,")"))),this.oldInflightOp=t,e}},{key:"_cancelLeave",value:function(){if(null!=this._leaveCallbacks)return delete this._leaveCallbacks}},{key:"_cancelJoin",value:function(){if(null!=this._joinCallbacks)return delete this._joinCallbacks}},{key:"_onUpdateApplied",value:function(e){return this.ide.pushEvent("received-update",{doc_id:this.doc_id,remote_doc_id:null!=e?e.doc:void 0,wantToBeJoined:this.wantToBeJoined,update:e,hasDoc:null!=this.doc}),null!=window.disconnectOnAck&&Math.random()<window.disconnectOnAck?(he.c.log("Disconnecting on ack",e),void window._ide.socket.socket.disconnect()):null!=window.dropAcks&&Math.random()<window.dropAcks&&null==e.op?void he.c.log("Simulating a lost ack",e):(null!=e?e.doc:void 0)!==this.doc_id||null==this.doc||(this.ide.pushEvent("received-update:processing",{update:e}),this.doc.processUpdateFromServerInOrder(e),this.wantToBeJoined)?void 0:this.leave()}},{key:"_onDisconnect",value:function(){return he.c.log("[onDisconnect] disconnecting"),this.connected=!1,this.joined=!1,null!=this.doc?this.doc.updateConnectionState("disconnected"):void 0}},{key:"_onReconnect",value:function(){var e=this;if(he.c.log("[onReconnect] reconnected (joined project)"),this.ide.pushEvent("reconnected:afterJoinProject"),this.connected=!0,this.wantToBeJoined||(null!=this.doc?this.doc.hasBufferedOps():void 0))return he.c.log("[onReconnect] Rejoining (wantToBeJoined: ".concat(this.wantToBeJoined," OR hasBufferedOps: ").concat(null!=this.doc?this.doc.hasBufferedOps():void 0,")")),this._joinDoc((function(t){return null!=t?e._onError(t):(e.doc.updateConnectionState("ok"),e.doc.flushPendingOps(),e._callJoinCallbacks())}))}},{key:"_callJoinCallbacks",value:function(){for(var e=0,t=Array.from(this._joinCallbacks||[]);e<t.length;e++)(0,t[e])();return delete this._joinCallbacks}},{key:"_joinDoc",value:function(e){var t=this;return null==e&&(e=function(){}),null!=this.doc?(this.ide.pushEvent("joinDoc:existing",{doc_id:this.doc_id,version:this.doc.getVersion()}),this.ide.socket.emit("joinDoc",this.doc_id,this.doc.getVersion(),{encodeRanges:!0},(function(n,r,a,l,d){return null!=n?e(n):(t.joined=!0,t.doc.catchUp(l),t._decodeRanges(d),t._catchUpRanges(null!=d?d.changes:void 0,null!=d?d.comments:void 0),e())}))):(this.ide.pushEvent("joinDoc:new",{doc_id:this.doc_id}),this.ide.socket.emit("joinDoc",this.doc_id,{encodeRanges:!0},(function(n,r,a,l,d){return null!=n?e(n):(t.joined=!0,t.ide.pushEvent("joinDoc:inited",{doc_id:t.doc_id,version:a}),t.doc=new nt(t.doc_id,r,a,t.ide.socket,t.ide.globalEditorWatchdogManager),t._decodeRanges(d),t.ranges=new(De())(null!=d?d.changes:void 0,null!=d?d.comments:void 0),t._bindToShareJsDocEvents(),e())})))}},{key:"_decodeRanges",value:function(e){var t=function(e){return decodeURIComponent(escape(e))};try{for(var n=0,r=Array.from(e.changes||[]);n<r.length;n++){var a=r[n];null!=a.op.i&&(a.op.i=t(a.op.i)),null!=a.op.d&&(a.op.d=t(a.op.d))}return function(){for(var n=[],r=0,a=Array.from(e.comments||[]);r<a.length;r++){var l=a[r];null!=l.op.c?n.push(l.op.c=t(l.op.c)):n.push(void 0)}return n}()}catch(e){he.c.error(e)}}},{key:"_leaveDoc",value:function(e){var t=this;return null==e&&(e=function(){}),this.ide.pushEvent("leaveDoc",{doc_id:this.doc_id}),he.c.log("[_leaveDoc] Sending leaveDoc request"),this.ide.socket.emit("leaveDoc",this.doc_id,(function(n){if(null!=n)return e(n);t.joined=!1;for(var r=0,a=Array.from(t._leaveCallbacks||[]);r<a.length;r++)e=a[r],he.c.log("[_leaveDoc] Calling buffered callback",e),e(n);return delete t._leaveCallbacks,e(n)}))}},{key:"_cleanUp",value:function(){if(!this.hasBufferedOps())return l.openDocs[this.doc_id]===this?(he.c.log("[_cleanUp] Removing self (".concat(this.doc_id,") from in openDocs")),delete l.openDocs[this.doc_id]):he.c.log("[_cleanUp] New instance of (".concat(this.doc_id,") created. Not removing")),this._unBindFromEditorEvents(),this._unBindFromSocketEvents();he.c.log("[_cleanUp] Document (".concat(this.doc_id,") has buffered ops, refusing to remove from openDocs"))}},{key:"_bindToShareJsDocEvents",value:function(){var e,t,n=this;this.doc.on("error",(function(e,t){return n._onError(e,t)})),this.doc.on("externalUpdate",(function(e){return n.ide.pushEvent("externalUpdate",{doc_id:n.doc_id}),n.trigger("externalUpdate",e)})),this.doc.on("remoteop",(function(){n.ide.pushEvent("remoteop",{doc_id:n.doc_id});for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.trigger.apply(n,["remoteop"].concat(rt(Array.from(t))))})),this.doc.on("op:sent",(function(e){return n.ide.pushEvent("op:sent",{doc_id:n.doc_id,op:e}),n.trigger("op:sent")})),this.doc.on("op:acknowledged",(function(e){return n.ide.pushEvent("op:acknowledged",{doc_id:n.doc_id,op:e}),n.ide.$scope.$emit("ide:opAcknowledged",{doc_id:n.doc_id,op:e}),n.trigger("op:acknowledged")})),this.doc.on("op:timeout",(function(e){return n.ide.pushEvent("op:timeout",{doc_id:n.doc_id,op:e}),n.trigger("op:timeout"),n._onError(new Error("op timed out"))})),this.doc.on("flush",(function(e,t,r){return n.ide.pushEvent("flush",{doc_id:n.doc_id,inflightOp:e,pendingOp:t,v:r})})),this.doc.on("change",(function(t,r,a){n._applyOpsToRanges(t,r,a),e&&window.clearTimeout(e),e=window.setTimeout((function(){window.dispatchEvent(new CustomEvent("doc:changed",{detail:{id:n.doc_id}})),n.ide.$scope.$emit("doc:changed",{doc_id:n.doc_id})}),50)})),this.doc.on("flipped_pending_to_inflight",(function(){return n.trigger("flipped_pending_to_inflight")})),this.doc.on("saved",(function(){t&&window.clearTimeout(t),t=window.setTimeout((function(){window.dispatchEvent(new CustomEvent("doc:saved",{detail:{id:n.doc_id}})),n.ide.$scope.$emit("doc:saved",{doc_id:n.doc_id})}),50)}))}},{key:"_onError",value:function _onError(e,t,n){if(null==t&&(t={}),t.doc_id=this.doc_id,he.c.log("ShareJS error",e,t),"no project_id found on client"!==e.message)return null!=this.doc&&this.doc.clearInflightAndPendingOps(),this.trigger("error",e,t,n),this._cleanUp();he.c.log("ignoring error, will wait to join project")}},{key:"_applyOpsToRanges",value:function(e,t,n){var r,a=this;null==e&&(e=[]);var l,d,p=null,f=null!=n;null!=(l=null!=n?n.meta:void 0,d=function(e){return e.tc},null!=l?d(l):void 0)&&(r=this.ranges.getIdSeed(),this.ranges.setIdSeed(n.meta.tc)),f&&(null!=n.meta?n.meta.tc:void 0)?p=n.meta.user_id:f||null==this.track_changes_as||(p=this.track_changes_as),this.ranges.track_changes=null!=p;var h,y=it(this._filterOps(e));try{for(y.s();!(h=y.n()).done;){var _=h.value;this.ranges.applyOp(_,{user_id:p})}}catch(e){y.e(e)}finally{y.f()}return null!=r&&this.ranges.setIdSeed(r),f?setTimeout((function(){return a.emit("ranges:dirty")})):this.emit("ranges:dirty")}},{key:"_catchUpRanges",value:function(e,t){null==e&&(e=[]),null==t&&(t=[]),this.emit("ranges:clear"),this.ranges.changes=e,this.ranges.comments=t,this.ranges.track_changes=this.doc.track_changes;var n,r=it(this._filterOps(this.doc.getInflightOp()||[]));try{for(r.s();!(n=r.n()).done;){var a=n.value;this.ranges.setIdSeed(this.doc.track_changes_id_seeds.inflight),this.ranges.applyOp(a,{user_id:this.track_changes_as})}}catch(e){r.e(e)}finally{r.f()}var l,d=it(this._filterOps(this.doc.getPendingOp()||[]));try{for(d.s();!(l=d.n()).done;){var p=l.value;this.ranges.setIdSeed(this.doc.track_changes_id_seeds.pending),this.ranges.applyOp(p,{user_id:this.track_changes_as})}}catch(e){d.e(e)}finally{d.f()}return this.emit("ranges:redraw")}},{key:"_filterOps",value:function(e){return window.isRestrictedTokenMember?e.filter((function(e){return null==e.c})):e}}],r=[{key:"initClass",value:function(){this.prototype.MAX_PENDING_OP_SIZE=64}},{key:"getDocument",value:function(e,t){return this.openDocs||(this.openDocs={}),this.openDocs[t]&&(he.c.log("[getDocument] Cleaning up existing document instance for ".concat(t)),this.openDocs[t]._cleanUp()),null==this.openDocs[t]?(he.c.log("[getDocument] Creating new document instance for ".concat(t)),this.openDocs[t]=new l(e,t)):he.c.log("[getDocument] Returning existing document instance for ".concat(t)),this.openDocs[t]}},{key:"hasUnsavedChanges",value:function(){var e=this.openDocs||{};for(var t in e)if(e[t].hasBufferedOps())return!0;return!1}},{key:"flushAll",value:function(){var e=this;return function(){var t=[];for(var n in e.openDocs){var r=e.openDocs[n];t.push(r.flush())}return t}()}}],n&&ct(t.prototype,n),r&&ct(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Me.Z),tt.initClass(),tt);d.Z.directive("formattingButtons",(function(){return{scope:{buttons:"=",opening:"=",isFullscreenEditor:"="},link:function(e,t,n){e.showMore=!1,e.shownButtons=e.buttons,e.overflowedButtons=[]},templateUrl:"formattingButtonsTpl"}})),d.Z.directive("toggleSwitch",(function(){return{restrict:"E",scope:{description:"@",labelFalse:"@",labelTrue:"@",ngModel:"="},template:'<fieldset class="toggle-switch">\n  <legend class="sr-only">{{description}}</legend>\n\n  <input\n    type="radio"\n    name="toggle-switch-{{$id}}"\n    class="toggle-switch-input"\n    id="toggle-switch-false-{{$id}}"\n    ng-value="false"\n    ng-model="ngModel"\n  >\n  <label for="toggle-switch-false-{{$id}}" class="toggle-switch-label"><span>{{labelFalse}}</span></label>\n\n  <input\n    type="radio"\n    class="toggle-switch-input"\n    name="toggle-switch-{{$id}}"\n    id="toggle-switch-true-{{$id}}"\n    ng-value="true"\n    ng-model="ngModel"\n  >\n  <label for="toggle-switch-true-{{$id}}" class="toggle-switch-label"><span>{{labelTrue}}</span></label>\n</fieldset>'}})),d.Z.controller("SavingNotificationController",["$scope","ide",function(e,t){var n;setInterval((function(){return function(){var n,d=e.docSavingStatus,p=e.docSavingStatusCount,f={},h=0,y=0;for(var _ in pt.openDocs){pt.openDocs[_].pollSavedStatus()||(h++,null!=d[_]?(f[_]=d[_],(n=f[_].unsavedSeconds+=1)>y&&(y=n)):f[_]={unsavedSeconds:0,doc:t.fileTreeManager.findEntityById(_)})}h>0&&n>l&&!a&&(a=t.showLockEditorMessageModal("Connection lost","Sorry, the connection to the server is down."),r=t.$scope.permissionsLevel,t.$scope.permissionsLevel="readOnly",a.result.finally((function(){a=null,t.$scope.permissionsLevel=r})));a&&0===h&&(a.dismiss("connection back up"),r&&(t.$scope.permissionsLevel=r));if(h||p)return e.docSavingStatus=f,e.docSavingStatusCount=h,e.$apply()}()}),1e3),$(window).bind("beforeunload",(function(){return n()}));var r,a=null,l=15;return e.docSavingStatus={},n=function(){if(pt.hasUnsavedChanges())return"You have unsaved changes. If you leave now they will not be saved."}}]);var ft=n(97287);d.Z.component("editorCompileButton",(0,f.react2angular)(le.use(ft.Z)));var ht=n(21706);d.Z.component("switchToPdfButton",(0,f.react2angular)(le.use(ht.Z)));d.Z.factory("metadata",["$http","ide",function(e,t){var n={},r={documents:{}},a={state:r,onBroadcastDocMeta:function(e){null!=e.docId&&null!=e.meta&&(r.documents[e.docId]=e.meta,window.dispatchEvent(new CustomEvent("project:metadata",{detail:r.documents})))},onEntityDeleted:function(e,t){if("doc"===t.type)return delete r.documents[t.id]},getAllLabels:function(){return y().flattenDeep(function(){var e=[];for(var t in r.documents){var n=r.documents[t];e.push(n.labels)}return e}())},getAllPackages:function(){var e={};for(var t in r.documents){var n=r.documents[t];for(var a in n.packages){var l=n.packages[a];e[a]=l}}return e},loadProjectMetaFromServer:function(){return e.get("/project/".concat(window.project_id,"/metadata")).then((function(e){var t=e.data;if(t.projectMeta)return function(){var e=[];for(var n in t.projectMeta){var a=t.projectMeta[n];e.push(r.documents[n]=a)}return window.dispatchEvent(new CustomEvent("project:metadata",{detail:r.documents})),e}()}))},loadDocMetaFromServer:function(n){return e.post("/project/".concat(window.project_id,"/doc/").concat(n,"/metadata"),{broadcast:t.$scope.onlineUsersCount>0,_csrf:window.csrfToken}).then((function(e){var t=e.data;a.onBroadcastDocMeta(t)}))},scheduleLoadDocMetaFromServer:function(e){if("readOnly"!==t.$scope.permissionsLevel){var r=n[e];return null!=r&&(clearTimeout(r),delete n[e]),n[e]=setTimeout((function(){return a.loadDocMetaFromServer(e),delete n[e]}),2e3)}}};return window.addEventListener("editor:metadata-outdated",(function(){a.scheduleLoadDocMetaFromServer(t.$scope.editor.sharejs_doc.doc_id)})),a}]);var mt,vt=n(76066),gt=["doc"],yt=["name"];function bt(e){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bt(e)}function _t(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==bt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===bt(l)?l:String(l)),r)}var a,l}var $t,kt=(mt=function(){function e(t,n,r,a){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.editorOpenDocEpoch=0,this.$scope=n,this.localStorage=r,this.$scope.editor={sharejs_doc:null,open_doc_id:null,open_doc_name:null,opening:!0,trackChanges:!1,wantTrackChanges:!1,docTooLongErrorShown:!1,showVisual:this.showVisual(),showSymbolPalette:!1,toggleSymbolPalette:function(){var e=!l.$scope.editor.showSymbolPalette;l.$scope.editor.showSymbolPalette=e,t.$scope.$emit("south-pane-toggled",e),a.sendMB(e?"symbol-palette-show":"symbol-palette-hide")},insertSymbol:function(e){t.$scope.$emit("editor:replace-selection",e.command),a.sendMB("symbol-palette-insert")},multiSelectedCount:0},window.addEventListener("editor:insert-symbol",(function(e){l.$scope.editor.insertSymbol(e.detail)})),this.$scope.$on("entity:selected",(function(e,t){if("history"!==l.$scope.ui.view&&"doc"===t.type)return l.openDoc(t)})),this.$scope.$on("entity:no-selection",(function(){l.$scope.$apply((function(){l.$scope.ui.view=null}))})),this.$scope.$on("entity:deleted",(function(e,t){if(l.$scope.editor.open_doc_id===t.id){if(!l.$scope.project.rootDoc_id)return void(l.$scope.ui.view=null);var n=l.ide.fileTreeManager.findEntityById(l.$scope.project.rootDoc_id);return null==n?void(l.$scope.ui.view=null):l.openDoc(n)}}));var d=!1;this.$scope.$on("file-tree:initialized",(function(){if(!d)return d=!0,l.autoOpenDoc()})),this.$scope.$on("flush-changes",(function(){return pt.flushAll()})),window.addEventListener("flush-changes",(function(){pt.flushAll()})),window.addEventListener("blur",(function(){he.c.log("[EditorManager] forcing flush onblur"),pt.flushAll()})),this.$scope.$watch("editor.wantTrackChanges",(function(e){if(null!=e)return l._syncTrackChangesState(l.$scope.editor.sharejs_doc)})),window.addEventListener("editor:open-doc",(function(e){var t=e.detail,n=t.doc,r=_t(t,gt);l.openDoc(n,r)})),window.addEventListener("editor:open-file",(function(e){for(var n=e.detail,r=n.name,a=_t(n,yt),d=0,p=["",".tex"];d<p.length;d++){var f=p[d],h="".concat(r).concat(f),y=t.fileTreeManager.findEntityByPath(h);if(y){l.openDoc(y,a);break}}}))}var t,n,r;return t=e,n=[{key:"getEditorType",value:function(){if(!this.$scope.editor.sharejs_doc)return null;var e=this.$scope.editor.sharejs_doc.editorType();return"cm6"===e&&this.$scope.editor.showVisual&&(e="cm6-rich-text"),e}},{key:"showVisual",value:function(){var e="editor.mode.".concat(this.$scope.project_id),t=this.localStorage(e);t&&vt.Z.removeItem(e);var n=this.localStorage("editor.lastUsedMode");return n?"visual"===n:"rich-text"===t}},{key:"autoOpenDoc",value:function(){var e=this.ide.localStorage("doc.open_id.".concat(this.$scope.project_id))||this.$scope.project.rootDoc_id;if(null!=e){var t=this.ide.fileTreeManager.findEntityById(e);if(null!=t)return this.openDoc(t)}}},{key:"openDocId",value:function(e,t){null==t&&(t={});var n=this.ide.fileTreeManager.findEntityById(e);if(null!=n)return this.openDoc(n,t)}},{key:"jumpToLine",value:function(e){return this.$scope.$broadcast("editor:gotoLine",e.gotoLine,e.gotoColumn,e.syncToPdf)}},{key:"openDoc",value:function(e,t){var n=this;null==t&&(t={}),he.c.log("[openDoc] Opening ".concat(e.id)),"editor"===this.$scope.ui.view&&this.$scope.$broadcast("store-doc-position"),this.$scope.ui.view="editor";var r=function(e){var r="doc:after-opened";n.$scope.$broadcast(r,{isNewDoc:e}),window.dispatchEvent(new CustomEvent(r,{detail:e})),null!=t.gotoLine?(setTimeout((function(){return n.jumpToLine(t)})),e&&window.addEventListener("editor:scroll-position-restored",(function(){return n.jumpToLine(t)}),{once:!0})):null!=t.gotoOffset&&setTimeout((function(){n.$scope.$broadcast("editor:gotoOffset",t.gotoOffset)}))};if(e.id===this.$scope.editor.open_doc_id&&!t.forceReopen)return this.ide.fileTreeManager.selectEntity(e),this.$scope.$broadcast("file-tree.reselectDoc",e.id),void this.$scope.$apply((function(){return r(!1)}));this.$scope.$applyAsync((function(){return n.$scope.editor.open_doc_id=e.id,n.$scope.editor.open_doc_name=e.name,n.ide.localStorage("doc.open_id.".concat(n.$scope.project_id),e.id),n.ide.fileTreeManager.selectEntity(e),n.$scope.editor.opening=!0,n._openNewDocument(e,(function(t,a){if(t&&"another document was loaded"===t.message)he.c.log("[openDoc] another document was loaded while ".concat(e.id," was loading"));else{if(null==t)return n._syncTrackChangesState(a),n.$scope.$broadcast("doc:opened"),n.$scope.$applyAsync((function(){return n.$scope.editor.opening=!1,n.$scope.editor.sharejs_doc=a,r(!0)}));n.ide.showGenericMessageModal("Error opening document","Sorry, something went wrong opening this document. Please try again.")}}))}))}},{key:"_openNewDocument",value:function(e,t){var n=this,r=this.$scope.editor.sharejs_doc,a=r&&r.doc_id,l=r&&r.hasBufferedOps();if(r&&a!==e.id||l){he.c.log("[_openNewDocument] Leaving existing open doc..."),this._unbindFromDocumentEvents(r),this._attachErrorHandlerToDocument(e,r);var d=++this.editorOpenDocEpoch;r.leaveAndCleanUp((function(r){return r?(he.c.log("[_openNewDocument] error leaving doc ".concat(a),r),t(r)):n.editorOpenDocEpoch!==d?(he.c.log("[openNewDocument] editorOpenDocEpoch mismatch ".concat(n.editorOpenDocEpoch," vs ").concat(d)),t(new Error("another document was loaded"))):void n._doOpenNewDocument(e,t)}))}else this._doOpenNewDocument(e,t)}},{key:"_doOpenNewDocument",value:function(e,t){var n=this;null==t&&(t=function(){}),he.c.log("[_doOpenNewDocument] Opening...");var r=pt.getDocument(this.ide,e.id),a=++this.editorOpenDocEpoch;return r.join((function(l){return null!=l?(he.c.log("[_doOpenNewDocument] error joining doc ".concat(e.id),l),t(l)):n.editorOpenDocEpoch!==a?(he.c.log("[openNewDocument] editorOpenDocEpoch mismatch ".concat(n.editorOpenDocEpoch," vs ").concat(a)),r.leaveAndCleanUp(),t(new Error("another document was loaded"))):(n._bindToDocumentEvents(e,r),t(null,r))}))}},{key:"_attachErrorHandlerToDocument",value:function(e,t){var n=this;t.on("error",(function(r,a,l){var d;if(d=null!=(null!=r?r.message:void 0)?r.message:"string"==typeof r?r:"",/maxDocLength/.test(d))n.$scope.docTooLongErrorShown=!0,n.openDoc(e,{forceReopen:!0}),n.ide.showGenericMessageModal("Document Too Long","Sorry, this file is too long to be edited manually. Please upload it directly.").result.finally((function(){n.$scope.docTooLongErrorShown=!1}));else if(/too many comments or tracked changes/.test(d))n.ide.showGenericMessageModal("Too many comments or tracked changes","Sorry, this file has too many comments or tracked changes. Please try accepting or rejecting some existing changes, or resolving and deleting some comments.");else if(!n.$scope.docTooLongErrorShown)return t.off("error"),l="string"==typeof l?l:t.doc._doc.snapshot,t.doc&&t.doc.clearInflightAndPendingOps(),t.leaveAndCleanUp(),n.ide.connectionManager.disconnect({permanent:!0}),n.ide.reportError(r,a),n.$scope.editor.error_state=!0,void n.ide.showOutOfSyncModal("Out of sync","Sorry, this file has gone out of sync and we need to do a full refresh. <br> <a target='_blank' rel='noopener noreferrer' href='/learn/Kb/Editor_out_of_sync_problems'>Please see this help guide for more information</a>",l);var p=n.$scope.$on("project:joined",(function(){n.openDoc(e,{forceReopen:!0}),p()}))}))}},{key:"_bindToDocumentEvents",value:function(e,t){var n=this;return this._attachErrorHandlerToDocument(e,t),t.on("externalUpdate",(function(e){if(!n._ignoreExternalUpdates&&("external"!==y().property(["meta","type"])(e)||"git-bridge"!==y().property(["meta","source"])(e)))return n.ide.showGenericMessageModal("Document Updated Externally","This document was just updated externally. Any recent changes you have made may have been overwritten. To see previous versions please look in the history.")}))}},{key:"_unbindFromDocumentEvents",value:function(e){return e.off()}},{key:"getCurrentDocValue",value:function(){return null!=this.$scope.editor.sharejs_doc?this.$scope.editor.sharejs_doc.getSnapshot():void 0}},{key:"getCurrentDocId",value:function(){return this.$scope.editor.open_doc_id}},{key:"startIgnoringExternalUpdates",value:function(){return this._ignoreExternalUpdates=!0}},{key:"stopIgnoringExternalUpdates",value:function(){return this._ignoreExternalUpdates=!1}},{key:"_syncTrackChangesState",value:function(e){var t,n=this;if(null!=e){null!=this._syncTimeout&&(clearTimeout(this._syncTimeout),this._syncTimeout=null);var r=this.$scope.editor.wantTrackChanges,a=e.getTrackingChanges();if(r!==a)return(t=function(){return null==e.getInflightOp()&&null==e.getPendingOp()?(e.setTrackingChanges(r),n.$scope.$apply((function(){return n.$scope.editor.trackChanges=r}))):n._syncTimeout=setTimeout(t,100)})();this.$scope.editor.trackChanges=r}}}],r=[{key:"initClass",value:function(){this.prototype._syncTimeout=null}}],n&&wt(t.prototype,n),r&&wt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),mt.initClass(),mt),St=(n(45794),n(14642));n(79174);function Ct(e){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ct(e)}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==Ct(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===Ct(l)?l:String(l)),r)}var a,l}var Et=($t=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.onlineUsers={},this.$scope.onlineUserCursorHighlights={},this.$scope.onlineUsersArray=[],this.$scope.onlineUsersCount=0,this.$scope.$on("cursor:editor:update",(function(e,t){return r.sendCursorPositionUpdate(t)})),this.$scope.$on("project:joined",(function(){return r.ide.socket.emit("clientTracking.getConnectedUsers",(function(e,t){r.$scope.onlineUsers={};for(var n=0,a=Array.from(t||[]);n<a.length;n++){var l=a[n];l.client_id!==r.ide.socket.publicId&&(r.$scope.onlineUsers[l.client_id]={id:l.client_id,user_id:l.user_id,email:l.email,name:"".concat(l.first_name," ").concat(l.last_name),doc_id:null!=l.cursorData?l.cursorData.doc_id:void 0,row:null!=l.cursorData?l.cursorData.row:void 0,column:null!=l.cursorData?l.cursorData.column:void 0})}return r.refreshOnlineUsers()}))})),this.ide.socket.on("clientTracking.clientUpdated",(function(e){if(e.id!==r.ide.socket.publicId)return r.$scope.$apply((function(){return r.$scope.onlineUsers[e.id]=e,r.refreshOnlineUsers()}))})),this.ide.socket.on("clientTracking.clientDisconnected",(function(e){return r.$scope.$apply((function(){return delete r.$scope.onlineUsers[e],r.refreshOnlineUsers()}))})),this.$scope.getHueForUserId=function(e){return St.Z.getHueForUserId(e)}}var t,n,r;return t=e,n=[{key:"refreshOnlineUsers",value:function(){for(var e in this.$scope.onlineUsersArray=[],this.$scope.onlineUsers){var t=this.$scope.onlineUsers[e];null!=t.doc_id&&(t.doc=this.ide.fileTreeManager.findEntityById(t.doc_id)),null!==t.name&&0!==t.name.trim().length||(t.email?t.name=t.email.trim():"anonymous-user"===t.user_id&&(t.name="Anonymous")),t.initial=null!=t.name?t.name[0]:void 0,t.initial&&" "!==t.initial||(t.initial="?"),this.$scope.onlineUsersArray.push(t)}for(var n in this.$scope.onlineUsersCount=this.$scope.onlineUsersArray.length,this.$scope.onlineUserCursorHighlights={},this.$scope.onlineUsers){var r=this.$scope.onlineUsers[n],a=r.doc_id;null!=a&&null!=r.row&&null!=r.column&&(this.$scope.onlineUserCursorHighlights[a]||(this.$scope.onlineUserCursorHighlights[a]=[]),this.$scope.onlineUserCursorHighlights[a].push({label:r.name,cursor:{row:r.row,column:r.column},hue:St.Z.getHueForUserId(r.user_id)}))}return this.$scope.onlineUsersArray.length>0?(delete this.cursorUpdateTimeout,this.cursorUpdateInterval=500):(delete this.cursorUpdateTimeout,this.cursorUpdateInterval=3e5)}},{key:"sendCursorPositionUpdate",value:function(e){var t=this;if(null!=e&&(this.$scope.currentPosition=e),null==this.cursorUpdateTimeout)return this.cursorUpdateTimeout=setTimeout((function(){var e=t.$scope.editor.open_doc_id;return t.ide.socket.emit("clientTracking.updatePosition",{row:null!=t.$scope.currentPosition?t.$scope.currentPosition.row:void 0,column:null!=t.$scope.currentPosition?t.$scope.currentPosition.column:void 0,doc_id:e}),delete t.cursorUpdateTimeout}),this.cursorUpdateInterval)}}],r=[{key:"initClass",value:function(){this.prototype.cursorUpdateInterval=500}}],n&&Pt(t.prototype,n),r&&Pt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),$t.initClass(),$t);function Ot(e){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(e)}function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==Ot(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===Ot(l)?l:String(l)),r)}var a,l}function zt(e,t,n){return t&&jt(e.prototype,t),n&&jt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var xt=zt((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.permissions={read:!1,write:!1,admin:!1,comment:!1},this.$scope.$watch("permissionsLevel",(function(e){if(null!=e&&("readOnly"===e?(r.$scope.permissions.read=!0,r.$scope.permissions.write=!1,r.$scope.permissions.admin=!1,r.$scope.permissions.comment=!0):"readAndWrite"===e?(r.$scope.permissions.read=!0,r.$scope.permissions.write=!0,r.$scope.permissions.comment=!0):"owner"===e&&(r.$scope.permissions.read=!0,r.$scope.permissions.write=!0,r.$scope.permissions.admin=!0,r.$scope.permissions.comment=!0)),r.$scope.anonymous)return r.$scope.permissions.comment=!1}))}));function Tt(e){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(e)}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==Tt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===Tt(l)?l:String(l)),r)}var a,l}var Dt=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$on("entity:selected",(function(e,t){return"track-changes"!==r.$scope.ui.view&&"file"===t.type?r.openFile(t):"doc"===t.type?r.closeFile():void 0}))}var t,n,r;return t=e,(n=[{key:"openFile",value:function(e){var t=this;return"editor"===this.$scope.ui.view&&this.$scope.$broadcast("store-doc-position"),this.ide.fileTreeManager.selectEntity(e),"history"!==this.$scope.ui.view&&(this.$scope.ui.view="file"),this.$scope.openFile=null,this.$scope.$apply(),window.setTimeout((function(){t.$scope.openFile=e,t.$scope.$apply(),t.$scope.$broadcast("file-view:file-opened"),window.dispatchEvent(new Event("file-view:file-opened"))}),0,this)}},{key:"openFileWithId",value:function(e){var t=this.ide.fileTreeManager.findEntityById(e);"file"===(null==t?void 0:t.type)&&this.openFile(t)}},{key:"closeFile",value:function(){var e=this;return window.setTimeout((function(){e.$scope.openFile=null,"history"!==e.$scope.ui.view&&(e.$scope.ui.view="editor"),e.$scope.$apply()}),0,this)}}])&&It(t.prototype,n),r&&It(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Mt=n(81637),Rt=n.n(Mt);function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==At(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===At(l)?l:String(l)),r)}var a,l}var Lt=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$root._references=this.state={keys:[]},this.existingIndexHash={},this.$scope.$on("document:closed",(function(e,t){var n,a,l;if(t.doc_id&&(n=r.ide.fileTreeManager.findEntityById(t.doc_id)),a=null!=n?n.name:void 0,l=function(e){return e.match(/.*\.bib$/)},null!=a?l(a):void 0)return r.indexReferencesIfDocModified(t,!0)})),this.$scope.$on("references:should-reindex",(function(e,t){return r.indexAllReferences(!0)})),this.inited=!1,this.$scope.$on("project:joined",(function(e){r.inited||(r.inited=!0,r.ide.socket.on("references:keys:updated",(function(e,t){return r._storeReferencesKeys(e,t)})),r.indexAllReferences(!1))}))}var t,n,r;return t=e,(n=[{key:"_storeReferencesKeys",value:function(e,t){var n=this.$scope.$root._references.keys,r=t?e:y().union(n,e);return window.dispatchEvent(new CustomEvent("project:references",{detail:r})),this.$scope.$root._references.keys=r}},{key:"indexReferencesIfDocModified",value:function(e,t){var n=e.doc_id,r=e._doc.snapshot,a=Date.now(),l=Rt()("blob "+r.length+"\0"+r).toString(),d=this.existingIndexHash[n];d&&d.timestamp>a-216e5&&d.hash===l||(this.indexAllReferences(t),this.existingIndexHash[n]={hash:l,timestamp:a})}},{key:"indexAllReferences",value:function(e){var t=this,n={shouldBroadcast:e,_csrf:window.csrfToken};return this.ide.$http.post("/project/".concat(this.$scope.project_id,"/references/indexAll"),n).then((function(e){return t._storeReferencesKeys(e.data.keys,!0)}))}}])&&Nt(t.prototype,n),r&&Nt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==Ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===Ht(l)?l:String(l)),r)}var a,l}var Ut=function(){function e(t,n,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.metadata=r,this.ide.socket.on("broadcastDocMeta",(function(e){return a.metadata.onBroadcastDocMeta(e)})),this.$scope.$on("entity:deleted",this.metadata.onEntityDeleted)}var t,n,r;return t=e,(n=[{key:"loadProjectMetaFromServer",value:function(){return this.metadata.loadProjectMetaFromServer()}}])&&Ft(t.prototype,n),r&&Ft(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();n(49228),n(6710);function Wt(e){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(e)}function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Wt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Wt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}d.Z.controller("ReviewPanelController",["$scope","$element","ide","$timeout","$http","$modal","eventTracking","localStorage",function(e,t,n,r,a,l,d,p){t.find("#review-panel");var f,h="member",y="guest",_="anonymous",w=function(){if(null==(null!=n.$scope.user?n.$scope.user.id:void 0))return _;var e=n.$scope.user.id,t=n.$scope.project;if((null!=t.owner?t.owner.id:void 0)===e)return h;for(var r=0,a=Array.from(t.members);r<a.length;r++){if(a[r]._id===e)return h}return y};e.SubViews={CUR_FILE:"cur_file",OVERVIEW:"overview"},e.UserTCSyncState=f={SYNCED:"synced",PENDING:"pending"},n.$scope.reviewPanel={trackChangesState:{},trackChangesOnForEveryone:!1,trackChangesOnForGuests:!1,trackChangesForGuestsAvailable:!1,entries:{},resolvedComments:{},hasEntries:!1,subView:e.SubViews.CUR_FILE,openSubView:e.SubViews.CUR_FILE,overview:{loading:!1,docsCollapsedState:JSON.parse(p("docs_collapsed_state:".concat(e.project_id)))||{}},dropdown:{loading:!1},commentThreads:{},resolvedThreadIds:{},layoutToLeft:!1,rendererData:{},formattedProjectMembers:{},fullTCStateCollapsed:!0,selectedEntryIds:[],nVisibleSelectedChanges:0,entryHover:!1},n.$scope.loadingThreads=!0,window.addEventListener("beforeunload",(function(){var t={};for(var r in n.$scope.reviewPanel.overview.docsCollapsedState){var a=n.$scope.reviewPanel.overview.docsCollapsedState[r];a&&(t[r]=a)}var l=Object.keys(t).length>0?JSON.stringify(t):null;return p("docs_collapsed_state:".concat(e.project_id),l)})),e.$on("layout:pdf:linked",(function(e,t){return n.$scope.$broadcast("review-panel:layout")})),e.$on("layout:pdf:resize",(function(e,t){var r,a;n.$scope.reviewPanel.layoutToLeft=(null===(r=t.east)||void 0===r?void 0:r.size)<220||(null===(a=t.east)||void 0===a?void 0:a.initClosed),n.$scope.$broadcast("review-panel:layout",!1)})),e.$on("review-panel:sizes",(function(t,n){e.$broadcast("editor:set-scroll-size",n),qt("sizes",n)})),e.$watch("project.features.trackChangesVisible",(function(t){if(null!=t)return t?void 0:e.ui.reviewPanelOpen=!1})),e.$watch("project.members",(function(t){if(n.$scope.reviewPanel.formattedProjectMembers={},null!=(null!=e.project?e.project.owner:void 0)&&(n.$scope.reviewPanel.formattedProjectMembers[e.project.owner._id]=Y(e.project.owner)),null!=(null!=e.project?e.project.members:void 0))return function(){for(var e=[],r=0,a=Array.from(t);r<a.length;r++){var l=a[r];"readAndWrite"===l.privileges?(null==n.$scope.reviewPanel.trackChangesState[l._id]&&A(l._id,n.$scope.reviewPanel.trackChangesOnForEveryone,!0),e.push(n.$scope.reviewPanel.formattedProjectMembers[l._id]=Y(l))):e.push(void 0)}return e}()})),e.commentState={adding:!1,content:""},n.$scope.users=e.users={},n.$scope.reviewPanelEventsBridge=new Me.Z,n.socket.on("new-comment",(function(t,a){var l=P(t);return delete l.submitting,l.messages.push(G(a)),e.$apply(),r((function(){return n.$scope.$broadcast("review-panel:layout")}))})),n.socket.on("accept-changes",(function(t,n){return t!==e.editor.open_doc_id?E(t).removeChangeIds(n):(e.$broadcast("changes:accept",n),qt("changes:accept",n)),z(t),e.$apply((function(){}))})),n.socket.on("resolve-thread",(function(e,t){return I(e,t)})),n.socket.on("reopen-thread",(function(e){return D(e)})),n.socket.on("delete-thread",(function(t){return M(t),e.$apply((function(){}))})),n.socket.on("edit-message",(function(t,n,r){return function(e,t,n){var r=P(e);if(null==r)return;for(var a=0,l=Array.from(r.messages);a<l.length;a++){var d=l[a];d.id===t&&(d.content=n)}z()}(t,n,r),e.$apply((function(){}))})),n.socket.on("delete-message",(function(t,n){return R(t,n),e.$apply((function(){}))}));var k={},S=function(e){return null==n.$scope.reviewPanel.entries[e]&&(n.$scope.reviewPanel.entries[e]={}),n.$scope.reviewPanel.entries[e]},C=function(e){return null==n.$scope.reviewPanel.resolvedComments[e]&&(n.$scope.reviewPanel.resolvedComments[e]={}),n.$scope.reviewPanel.resolvedComments[e]};function P(e){return null==n.$scope.reviewPanel.commentThreads[e]&&(n.$scope.reviewPanel.commentThreads[e]={messages:[]}),n.$scope.reviewPanel.commentThreads[e]}function E(e){return null==k[e]&&(k[e]=new(De()),k[e].resolvedThreadIds=n.$scope.reviewPanel.resolvedThreadIds),k[e]}function O(e){var t=E(e.doc_id).getIdSeed(),n=De().generateIdSeed();return E(e.doc_id).setIdSeed(n),e.setTrackChangesIdSeeds({pending:n,inflight:t})}e.$watch("!ui.reviewPanelOpen && reviewPanel.hasEntries",(function(t,n){if(null!=t)return e.ui.miniReviewPanelVisible=t,t!==n?r((function(){return e.$broadcast("review-panel:toggle")})):void 0})),e.$watch("ui.reviewPanelOpen",(function(t){if(null!=t)return t?n.$scope.reviewPanel.subView=n.$scope.reviewPanel.openSubView:(n.$scope.reviewPanel.openSubView=n.$scope.reviewPanel.subView,n.$scope.reviewPanel.subView=e.SubViews.CUR_FILE),r((function(){return e.$broadcast("review-panel:toggle"),n.$scope.$broadcast("review-panel:layout",!1)}))})),e.$watch("reviewPanel.subView",(function(t,r){if(null!=t)return t===e.SubViews.OVERVIEW?(n.$scope.reviewPanel.overview.loading=!0,j().then((function(){return n.$scope.reviewPanel.overview.loading=!1})).catch((function(){return n.$scope.reviewPanel.overview.loading=!1}))):void(r===e.SubViews.OVERVIEW&&qt("overview-closed",t))})),e.$watch("editor.sharejs_doc",(function(e,t){if(null!=e)return k[e.doc_id]=e.ranges,k[e.doc_id].resolvedThreadIds=n.$scope.reviewPanel.resolvedThreadIds,n.$scope.reviewPanel.rangesTracker=k[e.doc_id],null!=t&&t.off("flipped_pending_to_inflight"),e.on("flipped_pending_to_inflight",(function(){return O(e)})),O(e)})),e.$watch((function(){var t=n.$scope.reviewPanel.entries[e.editor.open_doc_id]||{},r={};for(var a in t){var l=t[a];["add-comment","bulk-actions"].includes(a)||(r[a]=l)}return Object.keys(r).length}),(function(t){return n.$scope.reviewPanel.hasEntries=t>0&&e.project.features.trackChangesVisible}));var j=function(){return a.get("/project/".concat(e.project_id,"/ranges")).then((function(t){var r=t.data;return function(){for(var t=[],a=0,l=Array.from(r);a<l.length;a++){var d=l[a];if(null==n.$scope.reviewPanel.overview.docsCollapsedState[d.id]&&(n.$scope.reviewPanel.overview.docsCollapsedState[d.id]=!1),d.id!==e.editor.open_doc_id){var p=E(d.id);p.comments=(null!=d.ranges?d.ranges.comments:void 0)||[],p.changes=(null!=d.ranges?d.ranges.changes:void 0)||[]}t.push(z(d.id))}return t}()}))};function z(t){var l=E(t),d=S(t),p=C(t),f=!1,h={};for(var y in d){var _=d[y];if(!["add-comment","bulk-actions"].includes(y))for(var w=0,k=Array.from(_.entry_ids);w<k.length;w++){h[k[w]]=!0}}for(var P in p)for(var O=p[P],j=0,x=Array.from(O.entry_ids);j<x.length;j++){h[x[j]]=!0}for(var T=!1,I=null,D=0,M=Array.from(l.changes);D<M.length;D++){var R=M[D];if(f=!0,T&&R.op.d&&R.op.p===I.op.p+I.op.i.length&&R.metadata.user_id===I.metadata.user_id)d[I.id].type="aggregate-change",d[I.id].metadata.replaced_content=R.op.d,d[I.id].entry_ids.push(R.id);else{null==d[R.id]&&(d[R.id]={}),delete h[R.id];var A={type:R.op.i?"insert":"delete",entry_ids:[R.id],content:R.op.i||R.op.d,offset:R.op.p,metadata:R.metadata};for(var N in A)d[R.id][N]=A[N]}R.op.i?(T=!0,I=R):(T=!1,I=null),null==e.users[R.metadata.user_id]&&(window.isRestrictedTokenMember||q(R.metadata.user_id))}window.isRestrictedTokenMember||(l.comments.length>0?function(){if(Z)return;Z=!0,n.$scope.loadingThreads=!0,a.get("/project/".concat(e.project_id,"/threads")).then((function(t){var a=t.data;for(var l in n.$scope.loadingThreads=!1,n.$scope.reviewPanel.resolvedThreadIds)delete n.$scope.reviewPanel.resolvedThreadIds[l];for(var d in a){for(var p=a[d],f=0,h=Array.from(p.messages);f<h.length;f++){G(h[f])}null!=p.resolved_by_user&&(p.resolved_by_user=Y(p.resolved_by_user),n.$scope.reviewPanel.resolvedThreadIds[d]=!0,e.$broadcast("comment:resolve_threads",[d]))}return n.$scope.reviewPanel.commentThreads=a,z(e.editor.open_doc_id),qt("loaded_threads"),r((function(){return n.$scope.$broadcast("review-panel:layout")}))}))}():!0===n.$scope.loadingThreads&&(n.$scope.loadingThreads=!1,qt("loaded_threads")));for(var L=0,H=Array.from(l.comments);L<H.length;L++){var F=H[L],U=void 0;f=!0,delete h[F.id],n.$scope.reviewPanel.resolvedThreadIds[F.op.t]?(U=null!=p[F.id]?p[F.id]:p[F.id]={},delete d[F.id]):(U=null!=d[F.id]?d[F.id]:d[F.id]={},delete p[F.id]);var W={type:"comment",thread_id:F.op.t,entry_ids:[F.id],content:F.op.c,offset:F.op.p};for(var B in W)U[B]=W[B]}for(var V in h){h[V];f=!0,delete d[V],delete p[V]}return f&&e.$broadcast("entries:changed"),d}function x(t){a.post("/project/".concat(e.project_id,"/doc/").concat(e.editor.open_doc_id,"/changes/accept"),{change_ids:t,_csrf:window.csrfToken}),e.$broadcast("changes:accept",t),qt("changes:accept",t)}n.$scope.refreshResolvedCommentsDropdown=function(){n.$scope.reviewPanel.dropdown.loading=!0;var e=j();return e.then((function(){return n.$scope.reviewPanel.dropdown.loading=!1})),e.catch((function(){return n.$scope.reviewPanel.dropdown.loading=!1})),e},e.$on("editor:track-changes:changed",(function(){var t=z(e.editor.open_doc_id);return e.$broadcast("review-panel:recalculate-screen-positions"),qt("recalculate-screen-positions",{entries:t,updateType:"trackedChangesChange"}),n.$scope.$apply(),n.$scope.$broadcast("review-panel:layout")})),e.$on("editor:track-changes:visibility_changed",(function(){return r((function(){return n.$scope.$broadcast("review-panel:layout",!1)}))})),e.$on("editor:focus:changed",(function(t,r,a,l){var d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p=e.editor.open_doc_id,f=S(p);n.$scope.reviewPanel.selectedEntryIds=[],n.$scope.reviewPanel.nVisibleSelectedChanges=0;var h=r,y=a-r;if(l){var _=f["add-comment"];_&&_.offset===h&&_.length===y||(f["add-comment"]={type:"add-comment",offset:h,length:y});var w=f["bulk-actions"];w&&w.offset===h&&w.length===y||(f["bulk-actions"]={type:"bulk-actions",offset:h,length:y})}else delete f["add-comment"],delete f["bulk-actions"];for(var k in f){var C=f[k],P=!1;if("comment"!==C.type||n.$scope.reviewPanel.resolvedThreadIds[C.thread_id]?"insert"===C.type?(P=C.offset>=r&&C.offset+C.content.length<=a,C.focused=C.offset<=r&&r<=C.offset+C.content.length):"delete"===C.type?(P=r<=C.offset&&C.offset<=a,C.focused=C.offset===r):"aggregate-change"===C.type?(P=C.offset>=r&&C.offset+C.content.length<=a,C.focused=C.offset<=r&&r<=C.offset+C.content.length):["add-comment","bulk-actions"].includes(C.type)&&l&&(C.focused=!0):C.focused=C.offset<=r&&r<=C.offset+C.content.length,P){for(var E=0,O=Array.from(C.entry_ids);E<O.length;E++){var j=O[E];n.$scope.reviewPanel.selectedEntryIds.push(j)}n.$scope.reviewPanel.nVisibleSelectedChanges++}}return e.$broadcast("review-panel:recalculate-screen-positions"),qt("recalculate-screen-positions",{entries:f,updateType:d}),n.$scope.$apply(),n.$scope.$broadcast("review-panel:layout")})),n.$scope.acceptChanges=function(t){x(t),d.sendMB("rp-changes-accepted",{view:e.ui.reviewPanelOpen?n.$scope.reviewPanel.subView:"mini"})},n.$scope.rejectChanges=function(t){T(t),d.sendMB("rp-changes-rejected",{view:e.ui.reviewPanelOpen?n.$scope.reviewPanel.subView:"mini"})},e.mouseEnterIndicator=function(){n.$scope.reviewPanel.entryHover=!0},e.mouseLeaveIndicator=function(){n.$scope.reviewPanel.entryHover=!1};var T=function(t){e.$broadcast("changes:reject",t),qt("changes:reject",t)};function I(t,r){var a=P(t);null!=a&&(a.resolved=!0,a.resolved_by_user=Y(r),a.resolved_at=(new Date).toISOString(),n.$scope.reviewPanel.resolvedThreadIds[t]=!0,e.$broadcast("comment:resolve_threads",[t]),qt("comment:resolve_threads",[t]))}function D(t){var r=P(t);null!=r&&(delete r.resolved,delete r.resolved_by_user,delete r.resolved_at,delete n.$scope.reviewPanel.resolvedThreadIds[t],e.$broadcast("comment:unresolve_thread",t),qt("comment:unresolve_thread",t))}function M(t){delete n.$scope.reviewPanel.resolvedThreadIds[t],delete n.$scope.reviewPanel.commentThreads[t],e.$broadcast("comment:remove",t),qt("comment:remove",t)}function R(e,t){var n=P(e);if(null!=n)return n.messages=n.messages.filter((function(e){return e.id!==t})),z()}n.$scope.bulkAcceptActions=function(){x(n.$scope.reviewPanel.selectedEntryIds.slice()),d.sendMB("rp-bulk-accept",{view:e.ui.reviewPanelOpen?n.$scope.reviewPanel.subView:"mini",nEntries:n.$scope.reviewPanel.nVisibleSelectedChanges})},n.$scope.bulkRejectActions=function(){T(n.$scope.reviewPanel.selectedEntryIds.slice()),d.sendMB("rp-bulk-reject",{view:e.ui.reviewPanelOpen?n.$scope.reviewPanel.subView:"mini",nEntries:n.$scope.reviewPanel.nVisibleSelectedChanges})},n.$scope.addNewComment=function(t){return t.preventDefault(),n.$scope.$broadcast("comment:start_adding"),e.toggleReviewPanel()},e.addNewCommentFromKbdShortcut=function(){if(e.project.features.trackChangesVisible)return e.$broadcast("comment:select_line"),qt("comment:select_line"),e.ui.reviewPanelOpen||e.toggleReviewPanel(),r((function(){n.$scope.$broadcast("review-panel:layout"),n.$scope.$broadcast("comment:start_adding")}))},e.startNewComment=function(){return e.$broadcast("comment:select_line"),qt("comment:select_line"),r((function(){return n.$scope.$broadcast("review-panel:layout")}))},n.$scope.submitNewComment=function(t){if(null!=t&&""!==t){var l=e.editor.open_doc_id,p=S(l);if(null!=p["add-comment"]){var f=p["add-comment"],h=f.offset,y=f.length,_=De().generateId();P(_).submitting=!0;return a.post("/project/".concat(e.project_id,"/thread/").concat(_,"/messages"),{content:t,_csrf:window.csrfToken}).then((function(){e.$broadcast("comment:add",_,h,y),qt("comment:add",{threadId:_,offset:h,length:y}),e.$broadcast("editor:clearSelection"),r((function(){return n.$scope.$broadcast("review-panel:layout")})),d.sendMB("rp-new-comment",{size:t.length})})).catch((function(){throw n.showGenericMessageModal("Error submitting comment","Sorry, there was a problem submitting your comment"),Error("Error submitting comment")}))}}},e.cancelNewComment=function(e){return r((function(){return n.$scope.$broadcast("review-panel:layout")}))},e.startReply=function(e){return e.replying=!0,r((function(){return n.$scope.$broadcast("review-panel:layout")}))},n.$scope.submitReply=function(t,l){var p=t.thread_id,f=t.replyContent;a.post("/project/".concat(e.project_id,"/thread/").concat(p,"/messages"),{content:f,_csrf:window.csrfToken}).catch((function(){return n.showGenericMessageModal("Error submitting comment","Sorry, there was a problem submitting your comment")}));var h={view:e.ui.reviewPanelOpen?n.$scope.reviewPanel.subView:"mini",size:t.replyContent.length,thread:p};P(p).submitting=!0,t.replyContent="",t.replying=!1,r((function(){return n.$scope.$broadcast("review-panel:layout")})),d.sendMB("rp-comment-reply",h)},e.cancelReply=function(e){return e.replying=!1,e.replyContent="",n.$scope.$broadcast("review-panel:layout")},n.$scope.resolveComment=function(t,r){var l=S(t)[r];l.focused=!1,a.post("/project/".concat(e.project_id,"/thread/").concat(l.thread_id,"/resolve"),{_csrf:window.csrfToken}),I(l.thread_id,n.$scope.user),d.sendMB("rp-comment-resolve",{view:e.ui.reviewPanelOpen?n.$scope.reviewPanel.subView:"mini"})},n.$scope.unresolveComment=function(t){D(t),a.post("/project/".concat(e.project_id,"/thread/").concat(t,"/reopen"),{_csrf:window.csrfToken}),d.sendMB("rp-comment-reopen")},n.$scope.deleteThread=function(t,n,r){M(r),a({method:"DELETE",url:"/project/".concat(e.project_id,"/doc/").concat(n,"/thread/").concat(r),headers:{"X-CSRF-Token":window.csrfToken}}),d.sendMB("rp-comment-delete")},n.$scope.saveEdit=function(t,l,d){return a.post("/project/".concat(e.project_id,"/thread/").concat(t,"/messages/").concat(l,"/edit"),{content:d,_csrf:window.csrfToken}),r((function(){return n.$scope.$broadcast("review-panel:layout")}))},n.$scope.deleteComment=function(t,l){return R(t,l),a({method:"DELETE",url:"/project/".concat(e.project_id,"/thread/").concat(t,"/messages/").concat(l),headers:{"X-CSRF-Token":window.csrfToken}}),r((function(){return n.$scope.$broadcast("review-panel:layout")}))},e.setSubView=function(e){n.$scope.reviewPanel.subView=e,d.sendMB("rp-subview-change",{subView:e})},n.$scope.gotoEntry=function(e,t){return n.editorManager.openDocId(e,{gotoOffset:t})};var A=function(t,r,a){null==a&&(a=!1),null==n.$scope.reviewPanel.trackChangesState[t]&&(n.$scope.reviewPanel.trackChangesState[t]={});var l=n.$scope.reviewPanel.trackChangesState[t];if(null==l.syncState||l.syncState===f.SYNCED?(l.value=r,l.syncState=f.SYNCED):l.syncState===f.PENDING&&l.value===r?l.syncState=f.SYNCED:a&&(l.value=r,l.syncState=f.PENDING),t===n.$scope.user.id)return e.editor.wantTrackChanges=r},N=function(t,r){null==r&&(r=!1),n.$scope.reviewPanel.trackChangesOnForEveryone=t;for(var a=e.project,l=0,d=Array.from(a.members);l<d.length;l++){var p=d[l];A(p._id,t,r)}return L(t,r),A(a.owner._id,t,r)};function L(t,r){if(null==r&&(r=!1),n.$scope.reviewPanel.trackChangesOnForGuests=t,w()===y||w()===_)return e.editor.wantTrackChanges=t}var H=function(){n.$scope.reviewPanel.trackChangesState=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(n),!0).forEach((function(t){Vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n.$scope.reviewPanel.trackChangesState);var t={};if(n.$scope.reviewPanel.trackChangesOnForEveryone)t.on=!0;else{for(var r in t.on_for={},n.$scope.reviewPanel.trackChangesState){var l=n.$scope.reviewPanel.trackChangesState[r];t.on_for[r]=l.value}n.$scope.reviewPanel.trackChangesOnForGuests&&(t.on_for_guests=!0)}return t._csrf=window.csrfToken,a.post("/project/".concat(e.project_id,"/track_changes"),t)},F=function(t){if("boolean"==typeof t)return N(t),L(t);var r=e.project;n.$scope.reviewPanel.trackChangesOnForEveryone=!1,L(!0===t.__guests__);for(var a=0,l=Array.from(r.members);a<l.length;a++){var d=l[a];A(d._id,null!=t[d._id]&&t[d._id])}return A(e.project.owner._id,null!=t[e.project.owner._id]&&t[e.project.owner._id])};n.$scope.toggleTrackChangesForEveryone=function(e){return N(e,!0),L(e,!0),H()},n.$scope.toggleTrackChangesForGuests=function(e){return L(e,!0),H()},n.$scope.toggleTrackChangesForUser=function(e,t){return A(t,e,!0),H()},n.socket.on("toggle-track-changes",(function(t){return e.$apply((function(){return F(t)}))})),e.toggleTrackChangesFromKbdShortcut=function(){if(e.project.features.trackChangesVisible&&e.project.features.trackChanges)return e.toggleTrackChangesForUser(!n.$scope.reviewPanel.trackChangesState[n.$scope.user.id].value,n.$scope.user.id)};var U=function(e){return n.$scope.reviewPanel.trackChangesForGuestsAvailable="tokenBased"===e};e.$watch("project.publicAccesLevel",U),e.$watch("reviewPanel.trackChangesForGuestsAvailable",(function(t){if(null!=t)return function(t){if(!t&&n.$scope.reviewPanel.trackChangesOnForGuests&&!n.$scope.reviewPanel.trackChangesOnForEveryone)return e.toggleTrackChangesForGuests(!1)}(t)}));var W=!1;n.$scope.$on("project:joined",(function(){if(!W){var e=n.$scope.project;return e.features.trackChanges?F(e.trackChangesState):F(!1),U(e.publicAccesLevel),W=!0}}));var B=!1,V={};function q(t){if(null!=t){if(null!=V[t])return;V[t]=!0}if(!B)return B=!0,a.get("/project/".concat(e.project_id,"/changes/users")).then((function(t){var r=t.data;return B=!1,n.$scope.users=e.users={},null!=(null!=n.$scope.user?n.$scope.user.id:void 0)&&(e.users[n.$scope.user.id]=Y(n.$scope.user)),function(){for(var t=[],n=0,a=Array.from(r);n<a.length;n++){var l=a[n];null!=l.id?t.push(e.users[l.id]=Y(l)):t.push(void 0)}return t}()})).catch((function(){return B=!1}))}var Z=!1;function G(e){return e.user=Y(e.user),e.timestamp=new Date(e.timestamp),e}function Y(e){var t,n,r=(null!=e?e._id:void 0)||(null!=e?e.id:void 0);return null==r?{email:null,name:"Anonymous",isSelf:!1,hue:St.Z.ANONYMOUS_HUE,avatar_text:"A"}:(r===window.user_id?(n="You",t=!0):(""===(n=[e.first_name,e.last_name].filter((function(e){return null!=e&&""!==e})).join(" "))&&(n=(null!=e.email?e.email.split("@")[0]:void 0)||"Unknown"),t=!1),{id:r,email:e.email,name:n,isSelf:t,hue:St.Z.getHueForUserId(r),avatar_text:[e.first_name,e.last_name].filter((function(e){return null!=e})).map((function(e){return e[0]})).join("")})}window.addEventListener("editor:event",(function(t){var r=t.detail,a=r.type,l=r.payload;switch(a){case"line-height":n.$scope.reviewPanel.rendererData.lineHeight=l,n.$scope.$broadcast("review-panel:layout");break;case"track-changes:changed":e.$broadcast("editor:track-changes:changed");break;case"track-changes:visibility_changed":e.$broadcast("editor:track-changes:visibility_changed");break;case"focus:changed":var d=l.from,p=l.to,f=l.empty,h=l.updateType;e.$broadcast("editor:focus:changed",d,p,!f,h);break;case"add-new-comment":e.addNewCommentFromKbdShortcut();break;case"toggle-track-changes":e.toggleTrackChangesFromKbdShortcut();break;case"toggle-review-panel":e.toggleReviewPanel()}})),e.reviewPanel.saveEdit=e.saveEdit}]);var qt=function(e,t){window.dispatchEvent(new CustomEvent("review-panel:event",{detail:{type:e,payload:t}}))},Zt=window.brandVariation,Gt=(d.Z.factory("CobrandingDataService",(function(){return{isProjectCobranded:function(){return null!=Zt},getLogoImgUrl:function(){return null!=Zt?Zt.logo_url:void 0},getSubmitBtnHtml:function(){return null!=Zt?Zt.submit_button_html:void 0},getBrandVariationName:function(){return null!=Zt?Zt.name:void 0},getBrandVariationHomeUrl:function(){return null!=Zt?Zt.home_url:void 0},getPublishGuideHtml:function(){return null!=Zt?Zt.publish_guide_html:void 0},getPartner:function(){return null!=Zt?Zt.partner:void 0},hasBrandedMenu:function(){return null!=Zt?Zt.branded_menu:void 0},getBrandId:function(){return null!=Zt?Zt.brand_id:void 0},getBrandVariationId:function(){return null!=Zt?Zt.id:void 0}}})),n(23438));d.Z.component("chat",(0,f.react2angular)(le.use(Gt.Z)));var Yt=n(45686);d.Z.controller("FileViewController",["$scope","$rootScope",function(e,t){e.file=e.openFile,e.storeReferencesKeys=function(e){var n=t._references.keys;return t._references.keys=y().union(n,e)}}]);d.Z.component("fileView",(0,f.react2angular)(le.use(Yt.Z),["storeReferencesKeys","file"])),d.Z.controller("EditorLoaderController",["$scope","localStorage",function(e,t){e.$watch("editor.showVisual",(function(e){t("editor.lastUsedMode",!0===e?"visual":"code")}))}]);n(88009),n(20789),d.Z.directive("layout",["$parse","$compile","ide",function(e,t,n){return{compile:function(){return{pre:function(r,a,l){var d,p,f=l.layout,h=l.customTogglerPane,_=l.customTogglerMsgWhenOpen,w=l.customTogglerMsgWhenClosed,k=null!=h&&null!=_&&null!=w,S={spacing_open:null!=l.spacingOpen?parseInt(l.spacingOpen,10):7,spacing_closed:null!=l.spacingClosed?parseInt(l.spacingClosed,10):7,slidable:!1,enableCursorHotkey:!1,onopen:function(e){return function(e){if(!k||e!==h)return;return d.scope().$applyAsync((function(){return d.scope().isOpen=!0}))}(e)},onclose:function(e){return function(e){if(!k||e!==h)return;return d.scope().$applyAsync((function(){return d.scope().isOpen=!1}))}(e)},onresize:function(){return E()},maskIframesOnResize:r.$eval(l.maskIframesOnResize||"false"),east:{size:r.$eval(l.initialSizeEast),initClosed:r.$eval(l.initClosedEast)},west:{size:r.$eval(l.initialSizeWest),initClosed:r.$eval(l.initClosedWest)}};function C(){if(null!=d){p=z.readState();var e="east"===h?"right":"left",t=p[h];return null!=t?d.css(e,t.initClosed?0:t.size):void 0}}function P(){if(p=z.readState(),null!=l.openEast&&null!=p.east)return e(l.openEast).assign(r,!p.east.initClosed)}function E(){return p=z.readState(),r.$broadcast("layout:".concat(f,":resize"),p),function(){if(null!=(p=z.readState()).east){var e=a.find("> .ui-layout-resizer-controls");p.east.initClosed?e.hide():(e.show(),e.css({right:p.east.size}))}}(),k&&C(),P()}null!=(p=n.localStorage("layout.".concat(f)))&&(null!=p.east&&((null==l.minimumRestoreSizeEast||p.east.size>=l.minimumRestoreSizeEast&&!p.east.initClosed)&&(S.east=p.east),S.east.initClosed=p.east.initClosed),null!=p.west&&(null==l.minimumRestoreSizeWest||p.west.size>=l.minimumRestoreSizeWest&&!p.west.initClosed)&&(S.west=p.west)),S.east.resizerCursor="ew-resize",S.west.resizerCursor="ew-resize";var O=a.width(),j=function(){if(null!=l.resizeProportionally&&r.$eval(l.resizeProportionally)){var e=z.readState().east;if(null!=e){var t=a.width();if(t>0){var d=e.size/O*t;O=t,z.sizePane("east",d)}return}}n.$timeout((function(){z.resizeAll()}))},z=a.layout(S);if(z.resizeAll(),null!=l.resizeOn)for(var x=0,T=Array.from(l.resizeOn.split(","));x<T.length;x++){var I=T[x];r.$on(I,(function(){return j()}))}if(k){p=z.readState();var D=r.$new();D.isOpen=!0,D.isVisible=!0,!0===(null!=p[h]?p[h].initClosed:void 0)&&(D.isOpen=!1),D.tooltipMsgWhenOpen=_,D.tooltipMsgWhenClosed=w,D.tooltipPlacement="east"===h?"left":"right",D.handleClick=function(){return z.toggle(h),C()},d=t('<a href ng-show="isVisible" class="custom-toggler '.concat("custom-toggler-".concat(h),'" ng-class="isOpen ? \'custom-toggler-open\' : \'custom-toggler-closed\'" tooltip="{{ isOpen ? tooltipMsgWhenOpen : tooltipMsgWhenClosed }}" tooltip-placement="{{ tooltipPlacement }}" ng-click="handleClick()" aria-label="{{ isOpen ? tooltipMsgWhenOpen : tooltipMsgWhenClosed }}">'))(D),a.append(d)}if(r.$on("editor:loaded",(function(){n.$timeout((function(){return z.resizeAll()}))})),$(window).unload((function(){var e=y().mapValues(z.readState(),(function(e){return y().omit(e,"children")}));n.localStorage("layout.".concat(f),e)})),null!=l.openEast&&r.$watch(l.openEast,(function(e,t){return null!=e&&e!==t&&(e?z.open("east"):z.close("east"),k&&"east"===h&&(C(),d.scope().$applyAsync((function(){d.scope().isOpen=e})))),setTimeout((function(){return r.$digest()}),0)})),null!=l.allowOverflowOn){var M=r.$eval(l.allowOverflowOn),R=z.panes[M];z.allowOverflow(M);var A=R.zIndex();R.css("z-index",A+1)}if(P(),E(),null!=l.layoutDisabled)return r.$watch(l.layoutDisabled,(function(e){if(e?z.hide("east"):z.show("east"),k)return d.scope().$applyAsync((function(){return d.scope().isOpen=!e,d.scope().isVisible=!e}))}))},post:function(e,t,n){var r=n.layout,a=t.layout().readState();return e.$broadcast("layout:".concat(r,":linked"),a)}}}}}]),d.Z.directive("verticalResizablePanes",["localStorage","ide",function(e,t){return{restrict:"A",link:function(n,r,a){var l=a.verticalResizablePanes,d=n.$eval(a.verticalResizablePanesMinSize),p=n.$eval(a.verticalResizablePanesMaxSize),f=n.$eval(a.verticalResizablePanesDefaultSize),h=null,y=!1;if(l){var _="vertical-resizable:".concat(l,":south-size");h=e(_),$(window).unload((function(){h&&e(_,h)}))}var w={center:{paneSelector:"[vertical-resizable-top]",paneClass:"vertical-resizable-top",size:"auto"},south:{paneSelector:"[vertical-resizable-bottom]",paneClass:"vertical-resizable-bottom",resizerClass:"vertical-resizable-resizer",resizerCursor:"ns-resize",size:"auto",resizable:!0,closable:!1,slidable:!1,spacing_open:6,spacing_closed:6,maxSize:"75%"}},k=a.verticalResizablePanesToggledExternallyOn,S=a.verticalResizablePanesHiddenExternallyOn,C=a.verticalResizablePanesHiddenInitially,P=a.verticalResizablePanesResizeOn,E="".concat(w.south.resizerClass,"-disabled");k&&n.$on(k,(function(e,t){var n,r;t?(O.resizers&&O.resizers.south&&O.resizers.south.removeClass(E),O.sizePane("south",null!==(n=null!==(r=h)&&void 0!==r?r:f)&&void 0!==n?n:"auto")):(O.resizers&&O.resizers.south&&O.resizers.south.addClass(E),O.sizePane("south","auto"))})),S&&t.$scope.$on(S,(function(e,t){t?O.show("south"):O.hide("south")})),P&&t.$scope.$on(P,(function(){t.$timeout((function(){O.resizeAll()}))})),p&&(w.south.maxSize=p),d&&(w.south.minSize=d),f&&(w.south.size=f),w.south.ondrag_end=function(){y=!0},w.south.onresize=function(e,t,n){y&&(h=n.size),y=!1};var O=r.layout(w);"true"===C&&O.hide("south")}}}]),n(43105),n(24905);function Xt(e){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xt(e)}function Jt(e,t){return null!=e?t(e):void 0}function Kt(e){return function(e){if(Array.isArray(e))return Qt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}d.Z.factory("ide",["$http","queuedHttp","$modal","$q","$filter","$timeout","eventTracking",function(e,t,n,r,a,l,d){var p=this,f={};return f.$http=e,f.queuedHttp=t,f.$q=r,f.$filter=a,f.$timeout=l,f.globalEditorWatchdogManager=new qe({onTimeoutHandler:function(e){d.sendMB("losing-edits",e),f.reportError("losing-edits",Object.assign({},e))}}),this.recentEvents=[],f.pushEvent=function(e,t){if(null==t&&(t={}),he.c.log("event",e,t),p.recentEvents.push({type:e,meta:t,date:new Date}),p.recentEvents.length>100)return p.recentEvents.shift()},f.reportError=function(t,n){null==n&&(n={}),n.user_id=window.user_id,n.project_id=window.project_id,n.client_id=Jt(null!=f.socket?f.socket.socket:void 0,(function(e){return e.sessionid})),n.transport=Jt(Jt(null!=f.socket?f.socket.socket:void 0,(function(e){return e.transport})),(function(e){return e.name})),n.client_now=new Date;var r={};if("object"===Xt(t))for(var a=0,l=Array.from(Object.getOwnPropertyNames(t));a<l.length;a++){var d=l[a];r[d]=t[d]}else"string"==typeof t&&(r.message=t);return e.post("/error/client",{error:r,meta:n,_csrf:window.csrfToken})},f.showGenericMessageModal=function(e,t){return n.open({templateUrl:"genericMessageModalTemplate",controller:"GenericMessageModalController",resolve:{title:function(){return e},message:function(){return t}}})},f.showOutOfSyncModal=function(e,t,r){return n.open({templateUrl:"outOfSyncModalTemplate",controller:"OutOfSyncModalController",backdrop:!1,keyboard:!1,resolve:{title:function(){return e},message:function(){return t},editorContent:function(){return r}},windowClass:"out-of-sync-modal"})},f.showLockEditorMessageModal=function(e,t){return n.open({templateUrl:"lockEditorModalTemplate",controller:"GenericMessageModalController",backdrop:!1,keyboard:!1,resolve:{title:function(){return e},message:function(){return t}},windowClass:"lock-editor-modal"})},f}]),d.Z.controller("GenericMessageModalController",["$scope","$modalInstance","title","message",function(e,t,n,r){return e.title=n,e.message=r,e.done=function(){return t.close()}}]),d.Z.controller("OutOfSyncModalController",["$scope","$window","title","message","editorContent",function(e,t,n,r,a){e.title=n,e.message=r,e.editorContent=a,e.editorContentRows=a.split("\n").length,e.done=function(){t.location.reload()}}]);d.Z.factory("queuedHttp",["$http",function(e){var t=[],n=!1;function r(){if(!n){var e=t.shift();return null!=e?(n=!0,e().then((function(){return n=!1,r()})).catch((function(){return n=!1,r()}))):void 0}}var a=function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];var d={},p=[],f=[];d.then=function(e,t){return p.push(e),null!=t&&f.push(t),d},d.catch=function(e){return f.push(e),d};return t.push((function(){return e.apply(void 0,Kt(Array.from(a||[]))).then((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(p).map((function(e){return e.apply(void 0,Kt(Array.from(t||[])))}))})).catch((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(f).map((function(e){return e.apply(void 0,Kt(Array.from(t||[])))}))}))})),r(),d};return a.post=function(e,t){return a({method:"POST",url:e,data:t})},a}]),n(35903),n(98966),n(2985);var en=n(28500),tn=(0,S.lazy)((function(){return Promise.all([n.e(5063),n.e(3621)]).then(n.bind(n,52307))}));d.Z.component("symbolPalette",(0,f.react2angular)(le.use((function(){return(0,G._i)().showSymbolPalette?(0,B.jsx)(S.Suspense,{fallback:(0,B.jsx)(en.w,{delay:500}),children:(0,B.jsx)(tn,{})}):null}))));var nn,on=n(51004),rn=n(21629),sn=(0,Se.Z)("ol-user");(0,on.Z0)("writefull-integration")&&(null===(nn=sn.writefull)||void 0===nn?void 0:nn.enabled)&&!window.writefull&&(0,rn.m)();var an=n(64292);d.Z.component("sourceEditor",(0,f.react2angular)(le.use(an.Z),[])),d.Z.component("sharedContextReact",(0,f.react2angular)(le.component,[],["ide"]));var cn=n(81721);d.Z.controller("EditorNavigationToolbarController",["$scope","ide",function(e,t){e.openDoc=function(e,n){return t.editorManager.openDoc(e,n)}}]),d.Z.component("editorNavigationToolbarRoot",(0,f.react2angular)(le.use(cn.Z),["openDoc","onlineUsersArray","openShareProjectModal"]));var ln=n(7436),un=n(14185);d.Z.component("pdfPreview",(0,f.react2angular)(le.use(ln.Z),[])),d.Z.component("pdfSynctexControls",(0,f.react2angular)(le.use(un.bx),[])),d.Z.component("detacherSynctexControl",(0,f.react2angular)(le.use(un.XA),[]));var dn=n(72891),pn=n(66123);d.Z.component("shareProjectModal",(0,f.react2angular)(le.use(dn.Z),["animation","handleHide","show"]));d.Z.controller("ReactShareProjectModalController",["$scope","eventTracking","ide",function(e,t,n){e.show=!1,e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))},e.openShareProjectModal=function(){t.sendMBOnce("ide-open-share-modal-once"),e.$applyAsync((function(){e.show=!0}))},n.socket.on("project:membership:changed",(function(t){t.members&&(0,pn.eH)(e.project._id).then((function(t){var n=t.members;n&&e.$applyAsync((function(){e.project.members=n}))})).catch((function(e){he.c.error("Error fetching members for project",e)})),t.invites&&(0,pn.bh)(e.project._id).then((function(t){var n=t.invites;n&&e.$applyAsync((function(){e.project.invites=n}))})).catch((function(e){he.c.error("Error fetching invites for project",e)}))}))}]);var hn=n(34557),mn=n(96227),vn=n(48171);function gn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,d,p=[],f=!0,h=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=l.call(n)).done)&&(p.push(r.value),p.length!==t);f=!0);}catch(e){h=!0,a=e}finally{try{if(!f&&null!=n.return&&(d=n.return(),Object(d)!==d))return}finally{if(h)throw a}}return p}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}d.Z.component("grammarlyAdvert",(0,f.react2angular)(le.use((function(){var e=gn((0,S.useState)(!1),2),t=e[0],n=e[1],r=(0,vn.Z)({initialState:!1});(0,S.useEffect)((function(){var e=vt.Z.getItem("editor.has_dismissed_grammarly_advert");r&&!e&&(mn.BZ("grammarly-advert-shown"),n(!0))}),[r,n]);var a=(0,S.useCallback)((function(){n(!1),vt.Z.setItem("editor.has_dismissed_grammarly_advert",!0),mn.BZ("grammarly-advert-dismissed")}),[]);if(!t)return null;var l=new Date>new Date(Date.UTC(2023,11,16,0,0,0)),d=(0,B.jsx)("div",{className:"alert alert-info grammarly-advert",role:"alert",children:(0,B.jsxs)("div",{className:"grammarly-advert-container",children:[(0,B.jsxs)("div",{className:"advert-content",children:[(0,B.jsx)("p",{children:"Love Grammarly? Then you're in luck! Get 25% off Grammarly Premium with this exclusive offer for Overleaf users."}),(0,B.jsx)("a",{className:"advert-link",onClick:function(){return mn.BZ("grammarly-advert-clicked")},href:"https://grammarly.go2cloud.org/aff_c?offer_id=373&aff_id=142242",target:"_blank",rel:"noopener",children:"Claim my discount"})]}),(0,B.jsx)("div",{className:"grammarly-notification-close-btn",children:(0,B.jsx)("button",{"aria-label":"Close",onClick:a,children:(0,B.jsx)(hn.Z,{type:"close"})})})]})}),p=(0,B.jsx)("div",{className:"alert alert-info grammarly-advert",role:"alert",children:(0,B.jsxs)("div",{className:"grammarly-advert-container",children:[(0,B.jsxs)("div",{className:"advert-content",children:[(0,B.jsx)("p",{children:"Overleafers get a limited-time 30% discount on Grammarly Premium. (Hurry! Offer ends December 15.)"}),(0,B.jsx)("a",{className:"advert-link",onClick:function(){return mn.BZ("grammarly-advert-clicked")},href:"https://grammarly.go2cloud.org/aff_c?offer_id=372&aff_id=142242",target:"_blank",rel:"noopener",children:"Claim my discount"})]}),(0,B.jsx)("div",{className:"grammarly-notification-close-btn",children:(0,B.jsx)("button",{"aria-label":"Close",onClick:a,children:(0,B.jsx)(hn.Z,{type:"close"})})})]})});return l?d:p}))));var bn=n(57597),_n=n(48755),wn=n(23357),$n=(0,S.lazy)((function(){return Promise.all([n.e(3539),n.e(1623),n.e(3546),n.e(7536),n.e(5085),n.e(7029),n.e(88),n.e(483),n.e(7681),n.e(3699)]).then(n.bind(n,67041))}));function kn(){return"history"!==(0,J.l5)().view?null:(0,B.jsx)(S.Suspense,{fallback:(0,B.jsx)(en.w,{delay:500}),children:(0,B.jsx)($n,{})})}var Sn=(0,wn.Z)((function(){return(0,B.jsx)(bn.f6,{children:(0,B.jsx)(kn,{})})}),_n.l);d.Z.component("historyRoot",(0,f.react2angular)(le.use(Sn)));var Cn=n(10649);d.Z.component("editorLeftMenu",(0,f.react2angular)(le.use(Cn.Z)));var Pn=n(87443);d.Z.component("outlineContainer",(0,f.react2angular)(le.use(Pn.c)));var En=n(43363);d.Z.controller("IdeController",["$scope","$timeout","ide","localStorage","eventTracking","metadata","CobrandingDataService","$window",function(e,t,n,r,a,l,d,p){var f;e.$originalApply=e.$apply,e.$apply=function(e){null==e&&(e=function(){});var t=this.$root.$$phase;return"$apply"===t||"$digest"===t?e():this.$originalApply(e)},e.state={loading:!0,load_progress:40,error:null},e.ui={leftMenuShown:!1,view:"editor",chatOpen:!1,pdfLayout:"sideBySide",pdfHidden:!1,pdfWidth:0,reviewPanelOpen:r("ui.reviewPanelOpen.".concat(window.project_id)),miniReviewPanelVisible:!1,chatResizerSizeOpen:7,chatResizerSizeClosed:0},e.user=window.user,e.settings=window.userSettings,e.anonymous=window.anonymous,e.isTokenMember=window.isTokenMember,e.isRestrictedTokenMember=window.isRestrictedTokenMember,e.cobranding={isProjectCobranded:d.isProjectCobranded(),logoImgUrl:d.getLogoImgUrl(),submitBtnHtml:d.getSubmitBtnHtml(),brandVariationName:d.getBrandVariationName(),brandVariationHomeUrl:d.getBrandVariationHomeUrl()},e.chat={},n.toggleReviewPanel=e.toggleReviewPanel=function(){e.$applyAsync((function(){e.project.features.trackChangesVisible&&(e.ui.reviewPanelOpen=!e.ui.reviewPanelOpen,a.sendMB("rp-toggle-panel",{value:e.ui.reviewPanelOpen}))}))},e.$watch("ui.reviewPanelOpen",(function(e){if(null!=e)return r("ui.reviewPanelOpen.".concat(window.project_id),e)})),e.$on("layout:pdf:resize",(function(t,n){return e.ui.pdfHidden=n.east.initClosed,e.ui.pdfWidth=n.east.size})),e.$watch("ui.view",(function(t,n){t!==n&&e.$broadcast("layout:flat-screen:toggle"),null!=t&&"editor"!==t&&"pdf"!==t&&a.sendMBOnce("ide-open-view-".concat(t,"-once"))})),e.$watch("ui.chatOpen",(function(e){e&&a.sendMBOnce("ide-open-chat-once")})),e.$watch("ui.leftMenuShown",(function(e){e&&a.sendMBOnce("ide-open-left-menu-once")})),e.trackHover=function(e){a.sendMBOnce("ide-hover-".concat(e,"-once"))},window._ide=n,n.validFileRegex="^[^*/]*$";var h=window.location&&window.location.search&&window.location.search.match(/ws=fallback/);n.wsUrl=h?null:window.sharelatex.wsUrl||null,n.project_id=e.project_id=window.project_id,n.$scope=e,n.referencesSearchManager=new Lt(n,e),n.loadingManager=new $e(e),n.connectionManager=new Te(n,e),n.fileTreeManager=new ge(n,e),n.editorManager=new kt(n,e,r,a),n.onlineUsersManager=new Et(n,e),n.permissionsManager=new xt(n,e),n.binaryFilesManager=new Dt(n,e),n.metadataManager=new Ut(n,e,l);var y=!1;e.$on("project:joined",(function(){if(!y)return y=!0,jn(null!=e?e.project:void 0,(function(e){return e.deletedByExternalDataSource}))&&n.showGenericMessageModal("Project Renamed or Deleted","This project has either been renamed or deleted by an external data source such as Dropbox.\nWe don't want to delete your data on Overleaf, so this project still contains your history and collaborators.\nIf the project has been renamed please look in your project list for a new project under the new name."),t((function(){if(e.permissions.write)return n.metadataManager.loadProjectMetaFromServer(),!0}),200)}));var _=!1;e.$on("doc:opened",(function(){if(!_)return e.$broadcast("ide:loaded"),_=!0})),n.editingSessionHeartbeat=function(){a.editingSessionHeartbeat((function(){var e=n.editorManager.getEditorType(),t={editorType:e};if("cm6"===e||"cm6-rich-text"===e){var r=(0,En.N)();if(r.numberOfEntries>0)for(var a=0,l=["Max","Mean","Median","NinetyFifthPercentile","DocLength","NumberOfEntries","MaxUserEventsBetweenDomUpdates","Grammarly","SessionLength","Memory","Lags","NonLags","LongestLag","MeanLagsPerMeasure","MeanKeypressesPerMeasure","MeanKeypressPaint","LongTasks","Release"];a<l.length;a++){var d=l[a],p=r[d.charAt(0).toLowerCase()+d.slice(1)];null!==p&&(t["cm6Perf"+d]=p)}}return t}))},e.$on("cursor:editor:update",(function(){n.editingSessionHeartbeat()})),e.$on("scroll:editor:update",(function(){n.editingSessionHeartbeat()})),angular.element(p).on("click",n.editingSessionHeartbeat),e.$on("$destroy",(function(){return angular.element(p).off("click",n.editingSessionHeartbeat)}));var w=["ambiance","chaos","clouds_midnight","cobalt","idle_fingers","merbivore","merbivore_soft","mono_industrial","monokai","pastel_on_dark","solarized_dark","terminal","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink"];return e.darkTheme=!1,window.addEventListener("settings:change",(function(t){e.darkTheme=w.includes(t.detail.editorTheme)})),n.localStorage=r,e.switchToFlatLayout=function(t){return e.ui.pdfLayout="flat",e.ui.view=t,n.localStorage("pdf.layout","flat")},e.switchToSideBySideLayout=function(t){return e.ui.pdfLayout="sideBySide",e.ui.view=t,r("pdf.layout","split")},(f=r("pdf.layout"))?("split"===f&&e.switchToSideBySideLayout(),"flat"===f&&e.switchToFlatLayout()):e.switchToSideBySideLayout(),e.$watch("ui.pdfLayout",(function(t){e.ui.pdfOpen="sideBySide"===t})),e.$watch("ui.pdfOpen",(function(t){e.ui.pdfLayout=t?"sideBySide":"flat",t&&window.dispatchEvent(new CustomEvent("ui:pdf-open"))})),e.handleKeyDown=function(){},n.featureToggle=jn(jn("undefined"!=typeof location&&null!==location?location.search:void 0,(function(e){return e.match(/^\?ft=(\w+)$/)})),(function(e){return e[1]})),window.addEventListener("editor:lint",(function(t){e.hasLintingError=t.detail.hasLintingError})),n.socket.on("project:access:revoked",(function(){n.showGenericMessageModal("Removed From Project","You have been removed from this project, and will no longer have access to it. You will be redirected to your project dashboard momentarily.")})),n.socket.on("project:publicAccessLevel:changed",(function(t){if(null!=t.newAccessLevel)return n.$scope.project.publicAccesLevel=t.newAccessLevel,e.$digest()}))}]),function(){try{navigator.serviceWorker.getRegistrations().catch((function(){return[]})).then((function(e){e.forEach((function(e){e.unregister()}))}))}catch(e){}}(),angular.module("SharelatexApp").config(["$provide",function(e){e.decorator("$browser",["$delegate",function(e){return e.onUrlChange=function(){},e.url=function(){return""},e}])}]);var On=angular.bootstrap(document.body,["SharelatexApp"]);function jn(e,t){return null!=e?t(e):void 0}},92462:function(e,t,n){"use strict";n(9575),n(96264),n(34115),n(634),n(58188),n(71372),n(71245),n(15735),n(79321),n(28673),n(6886),n(99805),n(1939),n(32501),n(20796),n(96928),n(92215),n(61229),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(45177);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,p=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return p=e.done,e},e:function(e){f=!0,d=e},f:function(){try{p||null==n.return||n.return()}finally{if(f)throw d}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var a=y(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}(this,n)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,l=void 0,l=function(e,t){if("object"!==_(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===_(l)?l:String(l)),r)}var a,l}function S(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}for(var C=function(){function e(t){w(this,e),this._socket=t}return S(e,null,[{key:"connect",value:function(t,n){return new e}}]),e}(),P=function(){var e=O[E];C.prototype[e]=function(){this._socket[e].apply(this._socket,arguments)}},E=0,O=["connect","disconnect","emit","on","removeListener"];E<O.length;E++)P();var j,z=function(e){d(n,e);var t=f(n);function n(e){var r;return w(this,n),(r=t.call(this,e)).socket={get connected(){return!1},get sessionid(){},get transport(){return{}},connect:function(){},disconnect:function(e){}},r}return S(n,[{key:"connect",value:function(){}},{key:"disconnect",value:function(e){}},{key:"emit",value:function(){}},{key:"on",value:function(){}},{key:"removeListener",value:function(){}}],[{key:"connect",value:function(){return new n}}]),n}(C),x=function(e){d(n,e);var t=f(n);function n(e){var r;return w(this,n),(r=t.call(this,e)).socket=r._socket.socket,r}return S(n,null,[{key:"connect",value:function(e,t){return new n(io.connect(e,t))}}]),n}(C),T=function(e){d(n,e);var t=f(n);function n(e,r){var a;w(this,n),(a=t.call(this,n.createNewSocket(e,r)))._url=e,a._options=r,a._events=new Map;var l=h(a);function d(){return l._socket.io&&l._socket.io.engine||{}}return a.socket={get connected(){return l._socket.connected},get sessionid(){return l._socket.id?l._socket.id:d().id},get transport(){return d().transport},connect:function(){l._replaceSocketWithNewInstance()},disconnect:function(e){return l._socket.disconnect(e)}},a}return S(n,[{key:"_on",value:function(e,t){this._events.has(e)?this._events.get(e).push(t):this._events.set(e,[t]),this._socket.on(e,t)}},{key:"on",value:function(e,t){if(n.EVENT_MAP.has(e)){var r,l=a(n.EVENT_MAP.get(e));try{for(l.s();!(r=l.n()).done;){var d=r.value;this._on(d,t)}}catch(e){l.e(e)}finally{l.f()}}else this._on(e,t)}},{key:"_removeListener",value:function(e,t){if(this._events.has(e)){var n=this._events.get(e),r=n.indexOf(t);-1!==r&&n.splice(r,1)}this._socket.removeListener(e,t)}},{key:"removeListener",value:function(e,t){if(n.EVENT_MAP.has(e)){var r,l=a(n.EVENT_MAP.get(e));try{for(l.s();!(r=l.n()).done;){var d=r.value;this._removeListener(d,t)}}catch(e){l.e(e)}finally{l.f()}}else this._removeListener(e,t)}},{key:"_replaceSocketWithNewInstance",value:function(){var e=this._socket,t=n.createNewSocket(this._url,this._options);this._events.forEach((function(n,r){var l,d=a(n);try{for(d.s();!(l=d.n()).done;){var p=l.value;e.removeListener(r,p),t.on(r,p)}}catch(e){d.e(e)}finally{d.f()}})),e.connected&&e.disconnect(),this._socket=t}},{key:"connect",value:function(){this._replaceSocketWithNewInstance()}}],[{key:"connect",value:function(e,t){return t.forceNew=t["force new connection"],t.path="/"+t.resource,t.reconnection=t.reconnect,t.timeout=t["connect timeout"],new n(e,t)}},{key:"EVENT_MAP",get:function(){var e=["connect_error","connect_timeout","error"];return new Map([["connect_failed",e],["error",e]])}},{key:"createNewSocket",value:function(e,t){return io.Manager(e,t).socket("/",t)}}]),n}(C);"undefined"!=typeof io&&io?"string"==typeof io.version&&"0"===io.version.slice(0,1)?(r.c.log("[socket.io] Shim: detected v0"),j=x):(r.c.log("[socket.io] Shim: detected v2"),j=T):(r.c.log("[socket.io] Shim: socket.io is not loaded, returning noop"),j=z),t.Z={SocketShimNoop:z,SocketShimV0:x,SocketShimV2:T,current:j,connect:j.connect,stub:function(){return new z}}},76066:function(e,t,n){"use strict";n(34769),n(6710);var r=n(45177),a=function(e,t,n){try{return e(t,n)}catch(e){return r.c.error("localStorage exception",e),null}},l=function(e){return JSON.parse(localStorage.getItem(e))},d=function(e,t){localStorage.setItem(e,JSON.stringify(t))},p=function(){localStorage.clear()},f=function(e){return localStorage.removeItem(e)},h={getItem:function(e){return a(l,e)},setItem:function(e,t){return a(d,e,t)},clear:function(){return a(p)},removeItem:function(e){return a(f,e)}};t.Z=h},93782:function(e,t,n){"use strict";n(34769),n(6710);var r=n(45177),a=function(e,t,n){try{return e(t,n)}catch(e){return r.c.error("sessionStorage exception",e),null}},l=function(e){return JSON.parse(sessionStorage.getItem(e))},d=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},p=function(){sessionStorage.clear()},f=function(e){return sessionStorage.removeItem(e)},h={getItem:function(e){return a(l,e)},setItem:function(e,t){return a(d,e,t)},clear:function(){return a(p)},removeItem:function(e){return a(f,e)}};t.Z=h},11685:function(e,t,n){"use strict";n(9575),n(96264),n(34115),n(634),n(58188),n(71372),n(71245),n(34769),n(95342),n(68625),n(1939),n(62775),n(20796),n(15735),n(28673),n(6886);var r=n(2784),a=n(17631),l=n(52322);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.Z=function(e){var t=(0,r.useCallback)((function(t){var n,r=null==t||null===(n=t._modal)||void 0===n?void 0:n.modalNode;r&&(e.show?(r.removeAttribute("role"),r.removeAttribute("aria-hidden")):r.setAttribute("aria-hidden","true"))}),[e.show]);return(0,l.jsx)(a.Z,f(f({},e),{},{ref:t}))}},96931:function(e,t,n){"use strict";n.d(t,{I:function(){return k},P:function(){return w}});n(71372),n(9575),n(96264),n(34115),n(634),n(58188),n(71245),n(34769),n(95342),n(68625),n(1939),n(62775),n(20796),n(15735),n(28673),n(6886);var r=n(2784),a=n(99618),l=n(52322);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=(0,r.createContext)(void 0),_=(0,a.Z)("ol-idePageReact"),w=function(e){var t=e.ide,n=e.scopeStore,a=e.scopeEventEmitter,d=e.children,p=(0,r.useMemo)((function(){return f(f({},t),{},{isReactIde:_,scopeStore:n,scopeEventEmitter:a})}),[t,n,a]);return(0,l.jsx)(y.Provider,{value:p,children:d})};function k(){var e=(0,r.useContext)(y);if(!e)throw new Error("useIdeContext is only available inside IdeProvider");return e}},29954:function(e,t,n){"use strict";n.d(t,{L:function(){return a}});var r=n(99618),a=function(){return{_id:(0,r.Z)("ol-project_id"),$scope:{$on:function(){},$watch:function(){},$applyAsync:function(){},user:{},project:{_id:(0,r.Z)("ol-project_id"),name:(0,r.Z)("ol-projectName"),rootDocId:"",members:[],invites:[],features:{collaborators:0,compileGroup:"standard",trackChangesVisible:!1,references:!1,mendeley:!1,zotero:!1},publicAccessLevel:"",owner:{_id:"",email:""}},state:{loading:!1},permissionsLevel:"readOnly",editor:{sharejs_doc:null,showSymbolPalette:!1,toggleSymbolPalette:function(){}},ui:{view:"pdf",chatOpen:!1,reviewPanelOpen:!1,leftMenuShown:!1,pdfLayout:"flat"},pdf:{uncompiled:!0,logEntryAnnotations:{}},settings:{syntaxValidation:!1,pdfViewer:"pdfjs"},hasLintingError:!1},editorManager:{openDoc:function(){},getCurrentDocId:function(){}}}}},32687:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(2784);function a(e,t){(0,r.useEffect)((function(){return window.addEventListener(e,t),function(){window.removeEventListener(e,t)}}),[e,t])}},46267:function(e,t,n){"use strict";n.d(t,{T:function(){return l}});var r=n(2784),a=n(49169),l=function(){var e=(0,a.Z)(),t=(0,r.useCallback)((function(t){e.current&&window.location.assign(t)}),[e]),n=(0,r.useCallback)((function(){e.current&&window.location.reload()}),[e]);return(0,r.useMemo)((function(){return{assign:t,reload:n}}),[t,n])}},44466:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});n(18178);var r=n(2784),a=n(96931);function l(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,a.I)().scopeEventEmitter;return(0,r.useCallback)((function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];n.emit.apply(n,[e,t].concat(a))}),[n,e,t])}},37246:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),a=n(76635),l=n.n(a),d=n(96931);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,d,p=[],f=!0,h=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=l.call(n)).done)&&(p.push(r.value),p.length!==t);f=!0);}catch(e){h=!0,a=e}finally{try{if(!f&&null!=n.return&&(d=n.return(),Object(d)!==d))return}finally{if(h)throw a}}return p}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,d.I)().scopeStore,a=p((0,r.useState)((function(){return n.get(e)})),2),f=a[0],h=a[1];return(0,r.useEffect)((function(){return n.watch(e,(function(e){h((function(){return e}))}),t)}),[e,n,t]),[f,(0,r.useCallback)((function(t){h((function(r){var a=l().isFunction(t)?t(r):t;return n.set(e,a),a}))}),[e,n])]}},78297:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});n(27233),n(28673),n(43450),n(9575),n(96264),n(34115),n(634),n(58188),n(71372),n(71245),n(20796),n(15735),n(6886),n(32501),n(88233),n(26936),n(77950),n(21850);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,d,p=[],f=!0,h=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=l.call(n)).done)&&(p.push(r.value),p.length!==t);f=!0);}catch(e){h=!0,a=e}finally{try{if(!f&&null!=n.return&&(d=n.return(),Object(d)!==d))return}finally{if(h)throw a}}return p}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(l=a.key,d=void 0,d=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(l,"string"),"symbol"===r(d)?d:String(d)),a)}var l,d}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"on",value:function(e,t){var n;this.events||(this.events={});var r=l(Array.from(e.split(".")),2);return e=r[0],n=r[1],this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,namespace:n})}},{key:"off",value:function(e){if(this.events||(this.events={}),null!=e){var t,n=l(Array.from(e.split(".")),2);if(e=n[0],null==(t=n[1]))return delete this.events[e];for(var r=[],a=0,d=Array.from(this.events[e]||[]);a<d.length;a++){var p=d[a];p.namespace!==t&&r.push(p)}return this.events[e]=r}return this.events={}}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.events||(this.events={}),Array.from(this.events[e]||[]).map((function(e){return e.callback.apply(e,a(Array.from(n||[])))}))}},{key:"emit",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.trigger.apply(this,a(Array.from(t||[])))}}],n&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},79174:function(e,t,n){var r;e.exports=(r=n(57359),function(e){var t=r,n=t.lib,a=n.WordArray,l=n.Hasher,d=t.algo,p=[];!function(){for(var t=0;t<64;t++)p[t]=4294967296*e.abs(e.sin(t+1))|0}();var f=d.MD5=l.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,a=e[r];e[r]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var l=this._hash.words,d=e[t+0],f=e[t+1],k=e[t+2],S=e[t+3],C=e[t+4],P=e[t+5],E=e[t+6],O=e[t+7],j=e[t+8],z=e[t+9],x=e[t+10],T=e[t+11],I=e[t+12],D=e[t+13],M=e[t+14],R=e[t+15],A=l[0],N=l[1],L=l[2],H=l[3];A=h(A,N,L,H,d,7,p[0]),H=h(H,A,N,L,f,12,p[1]),L=h(L,H,A,N,k,17,p[2]),N=h(N,L,H,A,S,22,p[3]),A=h(A,N,L,H,C,7,p[4]),H=h(H,A,N,L,P,12,p[5]),L=h(L,H,A,N,E,17,p[6]),N=h(N,L,H,A,O,22,p[7]),A=h(A,N,L,H,j,7,p[8]),H=h(H,A,N,L,z,12,p[9]),L=h(L,H,A,N,x,17,p[10]),N=h(N,L,H,A,T,22,p[11]),A=h(A,N,L,H,I,7,p[12]),H=h(H,A,N,L,D,12,p[13]),L=h(L,H,A,N,M,17,p[14]),A=y(A,N=h(N,L,H,A,R,22,p[15]),L,H,f,5,p[16]),H=y(H,A,N,L,E,9,p[17]),L=y(L,H,A,N,T,14,p[18]),N=y(N,L,H,A,d,20,p[19]),A=y(A,N,L,H,P,5,p[20]),H=y(H,A,N,L,x,9,p[21]),L=y(L,H,A,N,R,14,p[22]),N=y(N,L,H,A,C,20,p[23]),A=y(A,N,L,H,z,5,p[24]),H=y(H,A,N,L,M,9,p[25]),L=y(L,H,A,N,S,14,p[26]),N=y(N,L,H,A,j,20,p[27]),A=y(A,N,L,H,D,5,p[28]),H=y(H,A,N,L,k,9,p[29]),L=y(L,H,A,N,O,14,p[30]),A=_(A,N=y(N,L,H,A,I,20,p[31]),L,H,P,4,p[32]),H=_(H,A,N,L,j,11,p[33]),L=_(L,H,A,N,T,16,p[34]),N=_(N,L,H,A,M,23,p[35]),A=_(A,N,L,H,f,4,p[36]),H=_(H,A,N,L,C,11,p[37]),L=_(L,H,A,N,O,16,p[38]),N=_(N,L,H,A,x,23,p[39]),A=_(A,N,L,H,D,4,p[40]),H=_(H,A,N,L,d,11,p[41]),L=_(L,H,A,N,S,16,p[42]),N=_(N,L,H,A,E,23,p[43]),A=_(A,N,L,H,z,4,p[44]),H=_(H,A,N,L,I,11,p[45]),L=_(L,H,A,N,R,16,p[46]),A=w(A,N=_(N,L,H,A,k,23,p[47]),L,H,d,6,p[48]),H=w(H,A,N,L,O,10,p[49]),L=w(L,H,A,N,M,15,p[50]),N=w(N,L,H,A,P,21,p[51]),A=w(A,N,L,H,I,6,p[52]),H=w(H,A,N,L,S,10,p[53]),L=w(L,H,A,N,x,15,p[54]),N=w(N,L,H,A,f,21,p[55]),A=w(A,N,L,H,j,6,p[56]),H=w(H,A,N,L,R,10,p[57]),L=w(L,H,A,N,E,15,p[58]),N=w(N,L,H,A,D,21,p[59]),A=w(A,N,L,H,C,6,p[60]),H=w(H,A,N,L,T,10,p[61]),L=w(L,H,A,N,k,15,p[62]),N=w(N,L,H,A,z,21,p[63]),l[0]=l[0]+A|0,l[1]=l[1]+N|0,l[2]=l[2]+L|0,l[3]=l[3]+H|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;n[a>>>5]|=128<<24-a%32;var l=e.floor(r/4294967296),d=r;n[15+(a+64>>>9<<4)]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),n[14+(a+64>>>9<<4)]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),t.sigBytes=4*(n.length+1),this._process();for(var p=this._hash,f=p.words,h=0;h<4;h++){var y=f[h];f[h]=16711935&(y<<8|y>>>24)|4278255360&(y<<24|y>>>8)}return p},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n,r,a,l,d){var p=e+(t&n|~t&r)+a+d;return(p<<l|p>>>32-l)+t}function y(e,t,n,r,a,l,d){var p=e+(t&r|n&~r)+a+d;return(p<<l|p>>>32-l)+t}function _(e,t,n,r,a,l,d){var p=e+(t^n^r)+a+d;return(p<<l|p>>>32-l)+t}function w(e,t,n,r,a,l,d){var p=e+(n^(t|~r))+a+d;return(p<<l|p>>>32-l)+t}t.MD5=l._createHelper(f),t.HmacMD5=l._createHmacHelper(f)}(Math),r.MD5)},81637:function(e,t,n){var r,a,l,d,p,f,h,y;e.exports=(y=n(57359),a=(r=y).lib,l=a.WordArray,d=a.Hasher,p=r.algo,f=[],h=p.SHA1=d.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],l=n[2],d=n[3],p=n[4],h=0;h<80;h++){if(h<16)f[h]=0|e[t+h];else{var y=f[h-3]^f[h-8]^f[h-14]^f[h-16];f[h]=y<<1|y>>>31}var _=(r<<5|r>>>27)+p+f[h];_+=h<20?1518500249+(a&l|~a&d):h<40?1859775393+(a^l^d):h<60?(a&l|a&d|l&d)-1894007588:(a^l^d)-899497514,p=d,d=l,l=a<<30|a>>>2,a=r,r=_}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+l|0,n[3]=n[3]+d|0,n[4]=n[4]+p|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=d.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=d._createHelper(h),r.HmacSHA1=d._createHmacHelper(h),y.SHA1)},21725:function(e,t,n){"use strict";var r=n(34404),a=n.n(r),l=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function d(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(a()[n[1]]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){var r=e.indexOf("--\x3e");return{type:"comment",comment:-1!==r?e.slice(4,r):""}}for(var d=new RegExp(l),p=null;null!==(p=d.exec(e));)if(p[0].trim())if(p[1]){var f=p[1].trim(),h=[f,""];f.indexOf("=")>-1&&(h=f.split("=")),t.attrs[h[0]]=h[1],d.lastIndex--}else p[2]&&(t.attrs[p[2]]=p[3].trim().substring(1,p[3].length-1));return t}var p=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,f=/^\s*$/,h=Object.create(null);function y(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var n in e)t.push(n+'="'+e[n]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(y,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}var _={parse:function(e,t){t||(t={}),t.components||(t.components=h);var n,r=[],a=[],l=-1,y=!1;if(0!==e.indexOf("<")){var _=e.indexOf("<");r.push({type:"text",content:-1===_?e:e.substring(0,_)})}return e.replace(p,(function(p,h){if(y){if(p!=="</"+n.name+">")return;y=!1}var _,w="/"!==p.charAt(1),k=p.startsWith("\x3c!--"),S=h+p.length,C=e.charAt(S);if(k){var P=d(p);return l<0?(r.push(P),r):((_=a[l]).children.push(P),r)}if(w&&(l++,"tag"===(n=d(p)).type&&t.components[n.name]&&(n.type="component",y=!0),n.voidElement||y||!C||"<"===C||n.children.push({type:"text",content:e.slice(S,e.indexOf("<",S))}),0===l&&r.push(n),(_=a[l-1])&&_.children.push(n),a[l]=n),(!w||n.voidElement)&&(l>-1&&(n.voidElement||n.name===p.slice(2,-1))&&(l--,n=-1===l?r:a[l]),!y&&"<"!==C&&C)){_=-1===l?r:a[l].children;var E=e.indexOf("<",S),O=e.slice(S,-1===E?void 0:E);f.test(O)&&(O=" "),(E>-1&&l+_.length>=0||" "!==O)&&_.push({type:"text",content:O})}})),r},stringify:function(e){return e.reduce((function(e,t){return e+y("",t)}),"")}};t.Z=_},20602:function(e){e.exports=function(e){for(var t=-1,n=e?e.length:0,r={};++t<n;){var a=e[t];r[a[0]]=a[1]}return r}},49432:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},60091:function(e,t,n){var r=n(13940),a=n(41225),l=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var d=e[t];l.call(e,t)&&a(d,n)&&(void 0!==n||t in e)||r(e,t,n)}},24303:function(e,t,n){var r=n(26548),a=n(92019)(r);e.exports=a},36060:function(e,t,n){var r=n(23059),a=n(43114),l=n(75251);e.exports=function(e,t){return l(a(e,t,r),e+"")}},86532:function(e,t,n){var r=n(86874),a=n(83043),l=n(23059),d=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:l;e.exports=d},4751:function(e,t,n){var r=n(24303);e.exports=function(e,t){var n;return r(e,(function(e,r,a){return!(n=t(e,r,a))})),!!n}},752:function(e,t,n){var r=n(60091),a=n(13940);e.exports=function(e,t,n,l){var d=!n;n||(n={});for(var p=-1,f=t.length;++p<f;){var h=t[p],y=l?l(n[h],e[h],h,n,e):void 0;void 0===y&&(y=e[h]),d?a(n,h,y):r(n,h,y)}return n}},97263:function(e,t,n){var r=n(36060),a=n(82406);e.exports=function(e){return r((function(t,n){var r=-1,l=n.length,d=l>1?n[l-1]:void 0,p=l>2?n[2]:void 0;for(d=e.length>3&&"function"==typeof d?(l--,d):void 0,p&&a(n[0],n[1],p)&&(d=l<3?void 0:d,l=1),t=Object(t);++r<l;){var f=n[r];f&&e(t,f,r,d)}return t}))}},92019:function(e,t,n){var r=n(67878);e.exports=function(e,t){return function(n,a){if(null==n)return n;if(!r(n))return e(n,a);for(var l=n.length,d=t?l:-1,p=Object(n);(t?d--:++d<l)&&!1!==a(p[d],d,p););return n}}},82406:function(e,t,n){var r=n(41225),a=n(67878),l=n(39045),d=n(29259);e.exports=function(e,t,n){if(!d(n))return!1;var p=typeof t;return!!("number"==p?a(n)&&l(t,n.length):"string"==p&&t in n)&&r(n[t],e)}},43114:function(e,t,n){var r=n(49432),a=Math.max;e.exports=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var l=arguments,d=-1,p=a(l.length-t,0),f=Array(p);++d<p;)f[d]=l[t+d];d=-1;for(var h=Array(t+1);++d<t;)h[d]=l[d];return h[t]=n(f),r(e,this,h)}}},75251:function(e,t,n){var r=n(86532),a=n(97787)(r);e.exports=a},97787:function(e){var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var a=t(),l=16-(a-r);if(r=a,l>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},60019:function(e,t,n){var r=n(60091),a=n(752),l=n(97263),d=n(67878),p=n(16001),f=n(90249),h=Object.prototype.hasOwnProperty,y=l((function(e,t){if(p(t)||d(t))a(t,f(t),e);else for(var n in t)h.call(t,n)&&r(e,n,t[n])}));e.exports=y},86874:function(e){e.exports=function(e){return function(){return e}}},34519:function(e,t,n){var r=n(13940),a=n(26548),l=n(68286);e.exports=function(e,t){var n={};return t=l(t,3),a(e,(function(e,a,l){r(n,a,t(e,a,l))})),n}},51525:function(e,t,n){var r=n(87064),a=n(68286),l=n(4751),d=n(86152),p=n(82406);e.exports=function(e,t,n){var f=d(e)?r:l;return n&&p(e,t,n)&&(t=void 0),f(e,a(t,3))}},27133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60019),a=n(34519),l=n(51525),d=function(){function e(){this.__isFirstRender=!0,this.state={},this.props={}}return e.prototype.$onChanges=function(e){var t=this.props,n=a(e,"currentValue"),l=r({},this.props,n);if(this.__isFirstRender)r(this,{props:l}),this.componentWillMount(),this.render(),this.__isFirstRender=!1;else{if(!this.didPropsChange(n,t))return;this.componentWillReceiveProps(l);var d=this.shouldComponentUpdate(l,this.state);if(r(this,{props:l}),!d)return;this.componentWillUpdate(this.props,this.state),this.render(),this.componentDidUpdate(this.props,this.state)}},e.prototype.$postLink=function(){this.componentDidMount()},e.prototype.$onDestroy=function(){this.componentWillUnmount()},e.prototype.didPropsChange=function(e,t){return l(e,(function(e,n){return e!==t[n]}))},e.prototype.componentWillMount=function(){},e.prototype.componentDidMount=function(){},e.prototype.componentWillReceiveProps=function(e){},e.prototype.shouldComponentUpdate=function(e,t){return!0},e.prototype.componentWillUpdate=function(e,t){},e.prototype.componentDidUpdate=function(e,t){},e.prototype.componentWillUnmount=function(){},e.prototype.render=function(){},e}();t.default=d},52322:function(e,t,n){"use strict";e.exports=n(11837)},46353:function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=this&&this.__assign||function(){return l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},l.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var d=n(20602),p=n(27133),f=n(2784),h=n(28316);t.react2angular=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=[]);var r=t||e.propTypes&&Object.keys(e.propTypes)||[];return{bindings:d(r.map((function(e){return[e,"<"]}))),controller:["$element"].concat(n,[function(t){function r(e){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];var l=t.call(this)||this;return l.$element=e,l.isDestroyed=!1,l.injectedProps={},n.forEach((function(e,t){l.injectedProps[e]=r[t]})),l}return a(r,t),Object.defineProperty(r,"$$ngIsClass",{get:function(){return!0},enumerable:!0,configurable:!0}),r.prototype.render=function(){this.isDestroyed||h.render(f.createElement(e,l({},this.props,this.injectedProps)),this.$element[0])},r.prototype.componentWillUnmount=function(){this.isDestroyed=!0,h.unmountComponentAtNode(this.$element[0])},r}(p.default)])}}},88009:function(){var uuid,removeData,eventType,orig;function focusable(e,t){var n,r,a,l=e.nodeName.toLowerCase();return"area"===l?(r=(n=e.parentNode).name,!(!e.href||!r||"map"!==n.nodeName.toLowerCase())&&(!!(a=$("img[usemap='#"+r+"']")[0])&&visible(a))):(/^(input|select|textarea|button|object)$/.test(l)?!e.disabled:"a"===l&&e.href||t)&&visible(e)}function visible(e){return $.expr.filters.visible(e)&&!$(e).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.ui=$.ui||{},$.extend($.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({scrollParent:function(e){var t=this.css("position"),n="absolute"===t,r=e?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter((function(){var e=$(this);return(!n||"static"!==e.css("position"))&&r.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))})).eq(0);return"fixed"!==t&&a.length?a:$(this[0].ownerDocument||document)},uniqueId:(uuid=0,function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++uuid)}))}),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")}))}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo((function(e){return function(t){return!!$.data(t,e)}})):function(e,t,n){return!!$.data(e,n[3])},focusable:function(e){return focusable(e,!isNaN($.attr(e,"tabindex")))},tabbable:function(e){var t=$.attr(e,"tabindex"),n=isNaN(t);return(n||t>=0)&&focusable(e,!n)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],(function(e,t){var n="Width"===t?["Left","Right"]:["Top","Bottom"],r=t.toLowerCase(),a={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function l(e,t,r,a){return $.each(n,(function(){t-=parseFloat($.css(e,"padding"+this))||0,r&&(t-=parseFloat($.css(e,"border"+this+"Width"))||0),a&&(t-=parseFloat($.css(e,"margin"+this))||0)})),t}$.fn["inner"+t]=function(e){return void 0===e?a["inner"+t].call(this):this.each((function(){$(this).css(r,l(this,e)+"px")}))},$.fn["outer"+t]=function(e,n){return"number"!=typeof e?a["outer"+t].call(this,e):this.each((function(){$(this).css(r,l(this,e,!0,n)+"px")}))}})),$.fn.addBack||($.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=(removeData=$.fn.removeData,function(e){return arguments.length?removeData.call(this,$.camelCase(e)):removeData.call(this)})),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.fn.extend({focus:(orig=$.fn.focus,function(e,t){return"number"==typeof e?this.each((function(){var n=this;setTimeout((function(){$(n).focus(),t&&t.call(n)}),e)})):orig.apply(this,arguments)}),disableSelection:(eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(eventType+".ui-disableSelection",(function(e){e.preventDefault()}))}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,n,r=$(this[0]);r.length&&r[0]!==document;){if(("absolute"===(t=r.css("position"))||"relative"===t||"fixed"===t)&&(n=parseInt(r.css("zIndex"),10),!isNaN(n)&&0!==n))return n;r=r.parent()}return 0}}),$.ui.plugin={add:function(e,t,n){var r,a=$.ui[e].prototype;for(r in n)a.plugins[r]=a.plugins[r]||[],a.plugins[r].push([t,n[r]])},call:function(e,t,n,r){var a,l=e.plugins[t];if(l&&(r||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(a=0;a<l.length;a++)e.options[l[a][0]]&&l[a][1].apply(e.element,n)}};var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(e){return function(t){var n,r,a;for(a=0;null!=(r=t[a]);a++)try{(n=$._data(r,"events"))&&n.remove&&$(r).triggerHandler("remove")}catch(e){}e(t)}}($.cleanData),$.widget=function(e,t,n){var r,a,l,d,p={},f=e.split(".")[0];return e=e.split(".")[1],r=f+"-"+e,n||(n=t,t=$.Widget),$.expr[":"][r.toLowerCase()]=function(e){return!!$.data(e,r)},$[f]=$[f]||{},a=$[f][e],l=$[f][e]=function(e,t){if(!this._createWidget)return new l(e,t);arguments.length&&this._createWidget(e,t)},$.extend(l,a,{version:n.version,_proto:$.extend({},n),_childConstructors:[]}),(d=new t).options=$.widget.extend({},d.options),$.each(n,(function(e,n){var r,a;$.isFunction(n)?p[e]=(r=function(){return t.prototype[e].apply(this,arguments)},a=function(n){return t.prototype[e].apply(this,n)},function(){var e,t=this._super,l=this._superApply;return this._super=r,this._superApply=a,e=n.apply(this,arguments),this._super=t,this._superApply=l,e}):p[e]=n})),l.prototype=$.widget.extend(d,{widgetEventPrefix:a&&d.widgetEventPrefix||e},p,{constructor:l,namespace:f,widgetName:e,widgetFullName:r}),a?($.each(a._childConstructors,(function(e,t){var n=t.prototype;$.widget(n.namespace+"."+n.widgetName,l,t._proto)})),delete a._childConstructors):t._childConstructors.push(l),$.widget.bridge(e,l),l},$.widget.extend=function(e){for(var t,n,r=widget_slice.call(arguments,1),a=0,l=r.length;a<l;a++)for(t in r[a])n=r[a][t],r[a].hasOwnProperty(t)&&void 0!==n&&($.isPlainObject(n)?e[t]=$.isPlainObject(e[t])?$.widget.extend({},e[t],n):$.widget.extend({},n):e[t]=n);return e},$.widget.bridge=function(e,t){var n=t.prototype.widgetFullName||e;$.fn[e]=function(r){var a="string"==typeof r,l=widget_slice.call(arguments,1),d=this;return a?this.each((function(){var t,a=$.data(this,n);return"instance"===r?(d=a,!1):a?$.isFunction(a[r])&&"_"!==r.charAt(0)?(t=a[r].apply(a,l))!==a&&void 0!==t?(d=t&&t.jquery?d.pushStack(t.get()):t,!1):void 0:$.error("no such method '"+r+"' for "+e+" widget instance"):$.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")})):(l.length&&(r=$.widget.extend.apply(null,[r].concat(l))),this.each((function(){var e=$.data(this,n);e?(e.option(r||{}),e._init&&e._init()):$.data(this,n,new t(r,this))}))),d}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=$(t||this.defaultElement||this)[0],this.element=$(t),this.uuid=widget_uuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),t!==this&&($.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=$(t.style?t.ownerDocument:t.document||t),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(e,t){var n,r,a,l=e;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof e)if(l={},n=e.split("."),e=n.shift(),n.length){for(r=l[e]=$.widget.extend({},this.options[e]),a=0;a<n.length-1;a++)r[n[a]]=r[n[a]]||{},r=r[n[a]];if(e=n.pop(),1===arguments.length)return void 0===r[e]?null:r[e];r[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];l[e]=t}return this._setOptions(l),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,t,n){var r,a=this;"boolean"!=typeof e&&(n=t,t=e,e=!1),n?(t=r=$(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element,r=this.widget()),$.each(n,(function(n,l){function d(){if(e||!0!==a.options.disabled&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof l?a[l]:l).apply(a,arguments)}"string"!=typeof l&&(d.guid=l.guid=l.guid||d.guid||$.guid++);var p=n.match(/^([\w:-]*)\s*(.*)$/),f=p[1]+a.eventNamespace,h=p[2];h?r.delegate(h,f,d):t.bind(f,d)}))},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t),this.bindings=$(this.bindings.not(e).get()),this.focusable=$(this.focusable.not(e).get()),this.hoverable=$(this.hoverable.not(e).get())},_delay:function(e,t){var n=this;return setTimeout((function(){return("string"==typeof e?n[e]:e).apply(n,arguments)}),t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){$(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){$(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){$(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){$(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,n){var r,a,l=this.options[e];if(n=n||{},(t=$.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],a=t.originalEvent)for(r in a)r in t||(t[r]=a[r]);return this.element.trigger(t,n),!($.isFunction(l)&&!1===l.apply(this.element[0],[t].concat(n))||t.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},(function(e,t){$.Widget.prototype["_"+e]=function(n,r,a){"string"==typeof r&&(r={effect:r});var l,d=r?!0===r||"number"==typeof r?t:r.effect||t:e;"number"==typeof(r=r||{})&&(r={duration:r}),l=!$.isEmptyObject(r),r.complete=a,r.delay&&n.delay(r.delay),l&&$.effects&&$.effects.effect[d]?n[e](r):d!==e&&n[d]?n[d](r.duration,r.easing,a):n.queue((function(t){$(this)[e](),a&&a.call(n[0]),t()}))}}));var widget=$.widget,mouseHandled=!1;$(document).mouseup((function(){mouseHandled=!1}));var mouse=$.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).bind("click."+this.widgetName,(function(t){if(!0===$.data(t.target,e.widgetName+".preventClickEvent"))return $.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var t=this,n=1===e.which,r=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&$(e.target).closest(this.options.cancel).length;return!(n&&!r&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){t.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===$.data(e.target,this.widgetName+".preventClickEvent")&&$.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&$.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),mouseHandled=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});$.widget("ui.draggable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(e){var t=this.options;return this._blurActiveElement(e),!(this.helper||t.disabled||$(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map((function(){var e=$(this);return $("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var t=this.document[0];if(this.handleElement.is(e.target))try{t.activeElement&&"body"!==t.activeElement.nodeName.toLowerCase()&&$(t.activeElement).blur()}catch(e){}},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===$(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!t.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,n=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(n=$.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==t._trigger("stop",e)&&t._clear()})):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),$.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!$(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var t=this.options,n=$.isFunction(t.helper),r=n?$(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),n&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),$.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,n,r=this.options,a=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),(n=(t=$(r.containment))[0])&&(e=/(scroll|auto)/.test(t.css("overflow")),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=t)):this.containment=r.containment:this.containment=[0,0,$(a).width()-this.helperProportions.width-this.margins.left,($(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,r,a,l,d=this.options,p=this._isRootNode(this.scrollParent[0]),f=e.pageX,h=e.pageY;return p&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(r=this.relativeContainer.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(f=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(h=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(f=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(h=n[3]+this.offset.click.top)),d.grid&&(a=d.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,h=n?a-this.offset.click.top>=n[1]||a-this.offset.click.top>n[3]?a:a-this.offset.click.top>=n[1]?a-d.grid[1]:a+d.grid[1]:a,l=d.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,f=n?l-this.offset.click.left>=n[0]||l-this.offset.click.left>n[2]?l:l-this.offset.click.left>=n[0]?l-d.grid[0]:l+d.grid[0]:l),"y"===d.axis&&(f=this.originalPageX),"x"===d.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:p?0:this.offset.scroll.top),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:p?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,t,n){return n=n||this._uiHash(),$.ui.plugin.call(this,e,[t,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,e,t,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,n){var r=$.extend({},t,{item:n.element});n.sortables=[],$(n.options.connectToSortable).each((function(){var t=$(this).sortable("instance");t&&!t.options.disabled&&(n.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,r))}))},stop:function(e,t,n){var r=$.extend({},t,{item:n.element});n.cancelHelperRemoval=!1,$.each(n.sortables,(function(){var t=this;t.isOver?(t.isOver=0,n.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,r))}))},drag:function(e,t,n){$.each(n.sortables,(function(){var r=!1,a=this;a.positionAbs=n.positionAbs,a.helperProportions=n.helperProportions,a.offset.click=n.offset.click,a._intersectsWith(a.containerCache)&&(r=!0,$.each(n.sortables,(function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&$.contains(a.element[0],this.element[0])&&(r=!1),r}))),r?(a.isOver||(a.isOver=1,n._parent=t.helper.parent(),a.currentItem=t.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return t.helper[0]},e.target=a.currentItem[0],a._mouseCapture(e,!0),a._mouseStart(e,!0,!0),a.offset.click.top=n.offset.click.top,a.offset.click.left=n.offset.click.left,a.offset.parent.left-=n.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=n.offset.parent.top-a.offset.parent.top,n._trigger("toSortable",e),n.dropped=a.element,$.each(n.sortables,(function(){this.refreshPositions()})),n.currentItem=n.element,a.fromOutside=n),a.currentItem&&(a._mouseDrag(e),t.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",e,a._uiHash(a)),a._mouseStop(e,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),t.helper.appendTo(n._parent),n._refreshOffsets(e),t.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,$.each(n.sortables,(function(){this.refreshPositions()})))}))}}),$.ui.plugin.add("draggable","cursor",{start:function(e,t,n){var r=$("body"),a=n.options;r.css("cursor")&&(a._cursor=r.css("cursor")),r.css("cursor",a.cursor)},stop:function(e,t,n){var r=n.options;r._cursor&&$("body").css("cursor",r._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(e,t,n){var r=$(t.helper),a=n.options;r.css("opacity")&&(a._opacity=r.css("opacity")),r.css("opacity",a.opacity)},stop:function(e,t,n){var r=n.options;r._opacity&&$(t.helper).css("opacity",r._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(e,t,n){var r=n.options,a=!1,l=n.scrollParentNotHidden[0],d=n.document[0];l!==d&&"HTML"!==l.tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+l.offsetHeight-e.pageY<r.scrollSensitivity?l.scrollTop=a=l.scrollTop+r.scrollSpeed:e.pageY-n.overflowOffset.top<r.scrollSensitivity&&(l.scrollTop=a=l.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+l.offsetWidth-e.pageX<r.scrollSensitivity?l.scrollLeft=a=l.scrollLeft+r.scrollSpeed:e.pageX-n.overflowOffset.left<r.scrollSensitivity&&(l.scrollLeft=a=l.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-$(d).scrollTop()<r.scrollSensitivity?a=$(d).scrollTop($(d).scrollTop()-r.scrollSpeed):$(window).height()-(e.pageY-$(d).scrollTop())<r.scrollSensitivity&&(a=$(d).scrollTop($(d).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-$(d).scrollLeft()<r.scrollSensitivity?a=$(d).scrollLeft($(d).scrollLeft()-r.scrollSpeed):$(window).width()-(e.pageX-$(d).scrollLeft())<r.scrollSensitivity&&(a=$(d).scrollLeft($(d).scrollLeft()+r.scrollSpeed)))),!1!==a&&$.ui.ddmanager&&!r.dropBehaviour&&$.ui.ddmanager.prepareOffsets(n,e)}}),$.ui.plugin.add("draggable","snap",{start:function(e,t,n){var r=n.options;n.snapElements=[],$(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each((function(){var e=$(this),t=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})}))},drag:function(e,t,n){var r,a,l,d,p,f,h,y,_,w,k=n.options,S=k.snapTolerance,C=t.offset.left,P=C+n.helperProportions.width,E=t.offset.top,O=E+n.helperProportions.height;for(_=n.snapElements.length-1;_>=0;_--)f=(p=n.snapElements[_].left-n.margins.left)+n.snapElements[_].width,y=(h=n.snapElements[_].top-n.margins.top)+n.snapElements[_].height,P<p-S||C>f+S||O<h-S||E>y+S||!$.contains(n.snapElements[_].item.ownerDocument,n.snapElements[_].item)?(n.snapElements[_].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,$.extend(n._uiHash(),{snapItem:n.snapElements[_].item})),n.snapElements[_].snapping=!1):("inner"!==k.snapMode&&(r=Math.abs(h-O)<=S,a=Math.abs(y-E)<=S,l=Math.abs(p-P)<=S,d=Math.abs(f-C)<=S,r&&(t.position.top=n._convertPositionTo("relative",{top:h-n.helperProportions.height,left:0}).top),a&&(t.position.top=n._convertPositionTo("relative",{top:y,left:0}).top),l&&(t.position.left=n._convertPositionTo("relative",{top:0,left:p-n.helperProportions.width}).left),d&&(t.position.left=n._convertPositionTo("relative",{top:0,left:f}).left)),w=r||a||l||d,"outer"!==k.snapMode&&(r=Math.abs(h-E)<=S,a=Math.abs(y-O)<=S,l=Math.abs(p-C)<=S,d=Math.abs(f-P)<=S,r&&(t.position.top=n._convertPositionTo("relative",{top:h,left:0}).top),a&&(t.position.top=n._convertPositionTo("relative",{top:y-n.helperProportions.height,left:0}).top),l&&(t.position.left=n._convertPositionTo("relative",{top:0,left:p}).left),d&&(t.position.left=n._convertPositionTo("relative",{top:0,left:f-n.helperProportions.width}).left)),!n.snapElements[_].snapping&&(r||a||l||d||w)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,$.extend(n._uiHash(),{snapItem:n.snapElements[_].item})),n.snapElements[_].snapping=r||a||l||d||w)}}),$.ui.plugin.add("draggable","stack",{start:function(e,t,n){var r,a=n.options,l=$.makeArray($(a.stack)).sort((function(e,t){return(parseInt($(e).css("zIndex"),10)||0)-(parseInt($(t).css("zIndex"),10)||0)}));l.length&&(r=parseInt($(l[0]).css("zIndex"),10)||0,$(l).each((function(e){$(this).css("zIndex",r+e)})),this.css("zIndex",r+l.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(e,t,n){var r=$(t.helper),a=n.options;r.css("zIndex")&&(a._zIndex=r.css("zIndex")),r.css("zIndex",a.zIndex)},stop:function(e,t,n){var r=n.options;r._zIndex&&$(t.helper).css("zIndex",r._zIndex)}});var draggable=$.ui.draggable;$.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(t.scope),t.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){$.ui.ddmanager.droppables[e]=$.ui.ddmanager.droppables[e]||[],$.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=$.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){if("accept"===e)this.accept=$.isFunction(t)?t:function(e){return e.is(t)};else if("scope"===e){var n=$.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(e,t){var n=t||$.ui.ddmanager.current,r=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var t=$(this).droppable("instance");if(t.options.greedy&&!t.options.disabled&&t.options.scope===n.options.scope&&t.accept.call(t.element[0],n.currentItem||n.element)&&$.ui.intersect(n,$.extend(t,{offset:t.element.offset()}),t.options.tolerance,e))return r=!0,!1})),!r&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),$.ui.intersect=function(){function e(e,t,n){return e>=t&&e<t+n}return function(t,n,r,a){if(!n.offset)return!1;var l=(t.positionAbs||t.position.absolute).left+t.margins.left,d=(t.positionAbs||t.position.absolute).top+t.margins.top,p=l+t.helperProportions.width,f=d+t.helperProportions.height,h=n.offset.left,y=n.offset.top,_=h+n.proportions().width,w=y+n.proportions().height;switch(r){case"fit":return h<=l&&p<=_&&y<=d&&f<=w;case"intersect":return h<l+t.helperProportions.width/2&&p-t.helperProportions.width/2<_&&y<d+t.helperProportions.height/2&&f-t.helperProportions.height/2<w;case"pointer":return e(a.pageY,y,n.proportions().height)&&e(a.pageX,h,n.proportions().width);case"touch":return(d>=y&&d<=w||f>=y&&f<=w||d<y&&f>w)&&(l>=h&&l<=_||p>=h&&p<=_||l<h&&p>_);default:return!1}}}(),$.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var n,r,a=$.ui.ddmanager.droppables[e.options.scope]||[],l=t?t.type:null,d=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<a.length;n++)if(!(a[n].options.disabled||e&&!a[n].accept.call(a[n].element[0],e.currentItem||e.element))){for(r=0;r<d.length;r++)if(d[r]===a[n].element[0]){a[n].proportions().height=0;continue e}a[n].visible="none"!==a[n].element.css("display"),a[n].visible&&("mousedown"===l&&a[n]._activate.call(a[n],t),a[n].offset=a[n].element.offset(),a[n].proportions({width:a[n].element[0].offsetWidth,height:a[n].element[0].offsetHeight}))}},drop:function(e,t){var n=!1;return $.each(($.ui.ddmanager.droppables[e.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(e,this,this.options.tolerance,t)&&(n=this._drop.call(this,t)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))})),n},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",(function(){e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)}))},drag:function(e,t){e.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(e,t);var n=$.ui.ddmanager.droppables[e.options.scope]||[];$.each(n,(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,r,a,l=$.ui.intersect(e,this,this.options.tolerance,t),d=!l&&this.isover?"isout":l&&!this.isover?"isover":null;d&&(this.options.greedy&&(r=this.options.scope,(a=this.element.parents(":data(ui-droppable)").filter((function(){return $(this).droppable("instance").options.scope===r}))).length&&((n=$(a[0]).droppable("instance")).enteredGreedyChild=n.enteredGreedyChild||"isover"===d,n.leftGreedyChild=n.leftGreedyChild||"isout"===d)),this[d]=!0,this["isout"===d?"isover":"isout"]=!1,this.c=d)}})),$.each(n,(function(){this.enteredGreedyChild&&(this.greedyChild=!0,this.isover=!1,this.isout=!0,this.c="isout"),this.leftGreedyChild&&!this.enteredGreedyChild&&(this.greedyChild=!1,this.isover=!0,this.isout=!1,this.c="isover"),this.c&&(this["isover"===this.c?"_over":"_out"].call(this,t),this.leftGreedyChild=!1,this.enteredGreedyChild=!1,this.c=null)}))},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)}};var droppable=$.ui.droppable;(function($){var min=Math.min,max=Math.max,round=Math.floor,isStr=function(e){return"string"===$.type(e)},runPluginCallbacks=function(Instance,a_fn){if($.isArray(a_fn))for(var i=0,c=a_fn.length;i<c;i++){var fn=a_fn[i];try{isStr(fn)&&(fn=eval(fn)),$.isFunction(fn)&&g(fn)(Instance)}catch(e){}}function g(e){return e}};$.layout={version:"1.3.rc30.79",revision:.033007,browser:{},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects,panes,north,south,west,east,center".split(","),allPanes:"north,south,west,east,center".split(","),borderPanes:"north,south,west,east".split(","),oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(e){var t=$(e),n=t.data("layout")||t.data("parentLayout");if(n){var r=n.container;if(r.data("layoutPane"))return r;var a=r.closest("."+$.layout.defaults.panes.paneClass);if(a.data("layoutPane"))return a}return null},getParentPaneInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("layoutPane"):null},getParentLayoutInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("parentLayout"):null},getEventObject:function(e){return"object"==typeof e&&e.stopPropagation?e:null},parsePaneName:function(e){var t=$.layout.getEventObject(e),n=e;return t&&(t.stopPropagation(),n=$(this).data("layoutEdge")),n&&!/^(west|east|north|south|center)$/.test(n)&&($.layout.msg('LAYOUT ERROR - Invalid pane-name: "'+n+'"'),n="error"),n},plugins:{draggable:!!$.fn.draggable,effects:{core:!!$.effects,slide:$.effects&&($.effects.slide||$.effects.effect&&$.effects.effect.slide)}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],scrollbarWidth:function(){return window.scrollbarWidth||$.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||$.layout.getScrollbarSize("height")},getScrollbarSize:function(e){var t=$('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),n={width:t.css("width")-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),window.scrollbarWidth=n.width,window.scrollbarHeight=n.height,e.match(/^(width|height)$/)?n[e]:n},showInvisibly:function(e,t){if(e&&e.length&&(t||"none"===e.css("display"))){var n=e[0].style,r={display:n.display||"",visibility:n.visibility||""};return e.css({display:"block",visibility:"hidden"}),r}return{}},getElementDimensions:function(e,t){var n,r,a,l={css:{},inset:{}},d=l.css,p={bottom:0},f=$.layout.cssNum,h=e.offset();return l.offsetLeft=h.left,l.offsetTop=h.top,t||(t={}),$.each("Left,Right,Top,Bottom".split(","),(function(f,h){n=d["border"+h]=$.layout.borderWidth(e,h),r=d["padding"+h]=$.layout.cssNum(e,"padding"+h),a=h.toLowerCase(),l.inset[a]=t[a]>=0?t[a]:r,p[a]=l.inset[a]+n})),d.width=e.width(),d.height=e.height(),d.top=f(e,"top",!0),d.bottom=f(e,"bottom",!0),d.left=f(e,"left",!0),d.right=f(e,"right",!0),l.outerWidth=e.outerWidth(),l.outerHeight=e.outerHeight(),l.innerWidth=max(0,l.outerWidth-p.left-p.right),l.innerHeight=max(0,l.outerHeight-p.top-p.bottom),l.layoutWidth=e.innerWidth(),l.layoutHeight=e.innerHeight(),l},getElementStyles:function(e,t){var n,r,a,l,d,p,f={},h=e[0].style,y=t.split(","),_="Top,Bottom,Left,Right".split(","),w="Color,Style,Width".split(",");for(l=0;l<y.length;l++)if((n=y[l]).match(/(border|padding|margin)$/))for(d=0;d<4;d++)if(r=_[d],"border"===n)for(p=0;p<3;p++)f[n+r+(a=w[p])]=h[n+r+a];else f[n+r]=h[n+r];else f[n]=h[n];return f},cssWidth:function(e,t){if(t<=0)return 0;var n=$.layout.browser.boxModel?$.support.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,a=$.layout.cssNum,l=t;return"border-box"!==n&&(l-=r(e,"Left")+r(e,"Right")),"content-box"===n&&(l-=a(e,"paddingLeft")+a(e,"paddingRight")),max(0,l)},cssHeight:function(e,t){if(t<=0)return 0;var n=$.layout.browser.boxModel?$.support.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,a=$.layout.cssNum,l=t;return"border-box"!==n&&(l-=r(e,"Top")+r(e,"Bottom")),"content-box"===n&&(l-=a(e,"paddingTop")+a(e,"paddingBottom")),max(0,l)},cssNum:function(e,t,n){e.jquery||(e=$(e));var r=$.layout.showInvisibly(e),a=$.css(e[0],t,!0),l=n&&"auto"==a?a:Math.round(parseFloat(a)||0);return e.css(r),l},borderWidth:function(e,t){e.jquery&&(e=e[0]);var n="border"+t.substr(0,1).toUpperCase()+t.substr(1);return"none"===$.css(e,n+"Style",!0)?0:Math.round(parseFloat($.css(e,n+"Width",!0))||0)},isMouseOverElem:function(e,t){var n=$(t||this),r=n.offset(),a=r.top,l=r.left,d=l+n.outerWidth(),p=a+n.outerHeight(),f=e.pageX,h=e.pageY;return $.layout.browser.msie&&f<0&&h<0||f>=l&&f<=d&&h>=a&&h<=p},msg:function(e,t,n,r){if($.isPlainObject(e)&&window.debugData){"string"==typeof t?(r=n,n=t):"object"==typeof n&&(r=n,n=null);var a=n||"log( <object> )",l=$.extend({sort:!1,returnHTML:!1,display:!1},r);!0===t||l.display?debugData(e,a,l):window.console&&console.log(debugData(e,a,l))}else if(t)alert(e);else if(window.console)console.log(e);else{var d=$("#layoutLogger");d.length||(d=function(){var e=$.support.fixedPosition?"fixed":"absolute",t=$('<div id="layoutLogger" style="position: '+e+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body");t.css("left",$(window).width()-t.outerWidth()-5),$.ui.draggable&&t.draggable({handle:":first-child"});return t}()),d.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>")}}};var u=navigator.userAgent.toLowerCase(),m=/(chrome)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+)/.exec(u)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||u.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(u)||[],b=m[1]||"",v=m[2]||0,ie="msie"===b;$.layout.browser={version:v,safari:"webkit"===b,webkit:"chrome"===b,msie:ie,isIE6:ie&&6==v,boxModel:!ie||!1!==$.support.boxModel},b&&($.layout.browser[b]=!0),ie&&$((function(){$.layout.browser.boxModel=$.support.boxModel})),$.layout.defaults={name:"",containerClass:"ui-layout-container",inset:null,scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,maskPanesEarly:!1,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1e3,resizer_drag:1e4},errors:{pane:"pane",selector:"selector",addButtonError:"Error Adding Button\nInvalid ",containerMissing:"UI Layout Initialization Error\nThe specified layout-container does not exist.",centerPaneMissing:"UI Layout Initialization Error\nThe center-pane element does not exist.\nThe center-pane is a required element.",noContainerHeight:"UI Layout Initialization Warning\nThe layout-container \"CONTAINER\" has no height.\nTherefore the layout is 0-height and hence 'invisible'!",callbackError:"UI Layout Callback Error\nThe EVENT callback is not a valid function."},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:$.layout.browser.webkit,preventPrematureSlideClose:!1,tips:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpen:"Not enough room to show this panel.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size"},showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,children:null,containerSelector:"",initChildren:!0,destroyChildren:!0,resizeChildren:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}},$.layout.optionsMap={layout:"name,instanceKey,stateManagement,effects,inset,zIndexes,errors,zIndex,scrollToBookmarkOnLoad,showErrorMessages,maskPanesEarly,outset,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onload_start,onload_end,onunload,onunload_start,onunload_end".split(","),center:"paneClass,contentSelector,contentIgnoreSelector,findNestedContent,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,maskContents,maskObjects,liveContentResizing,containerSelector,children,initChildren,resizeChildren,destroyChildren,onresize,onresize_start,onresize_end,onsizecontent,onsizecontent_start,onsizecontent_end".split(","),noDefault:"paneSelector,resizerCursor,customHotkey".split(",")},$.layout.transformData=function(e,t){var n,r,a,l,d,p,f,h=t?{panes:{},center:{}}:{};if("object"!=typeof e)return h;for(r in e)for(n=h,d=e[r],f=(a=r.split("__")).length-1,p=0;p<=f;p++)l=a[p],p===f?$.isPlainObject(d)?n[l]=$.layout.transformData(d):n[l]=d:(n[l]||(n[l]={}),n=n[l]);return h},$.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",childOptions:"children",initChildLayout:"initChildren",destroyChildLayout:"destroyChildren",resizeChildLayout:"resizeChildren",resizeNestedLayout:"resizeChildren",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad","cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure",noRoomToOpenTip:"tips.noRoomToOpen",togglerTip_open:"tips.Close",togglerTip_closed:"tips.Open",resizerTip:"tips.Resize",sliderTip:"tips.Slide"},renameOptions:function(e){var t,n,r,a=$.layout.backwardCompatibility.map;for(var l in a)void 0!==(r=(t=d(l)).branch[t.key])&&((n=d(a[l],!0)).branch[n.key]=r,delete t.branch[t.key]);function d(t,n){for(var r,a=t.split("."),l=a.length-1,d={branch:e,key:a[l]},p=0;p<l;p++)r=a[p],null==d.branch[r]?d.branch=n?d.branch[r]={}:{}:d.branch=d.branch[r];return d}},renameAllOptions:function(e){var t=$.layout.backwardCompatibility.renameOptions;return t(e),e.defaults&&("object"!=typeof e.panes&&(e.panes={}),$.extend(!0,e.panes,e.defaults),delete e.defaults),e.panes&&t(e.panes),$.each($.layout.config.allPanes,(function(n,r){e[r]&&t(e[r])})),e}},$.fn.layout=function(opts){var browser=$.layout.browser,_c=$.layout.config,cssW=$.layout.cssWidth,cssH=$.layout.cssHeight,elDims=$.layout.getElementDimensions,styles=$.layout.getElementStyles,evtObj=$.layout.getEventObject,evtPane=$.layout.parsePaneName,options=$.extend(!0,{},$.layout.defaults),effects=options.effects=$.extend(!0,{},$.layout.effects),state={id:"layout"+$.now(),initialized:!1,paneResizing:!1,panesSliding:{},container:{innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0,layoutWidth:0,layoutHeight:0},north:{childIdx:0},south:{childIdx:0},east:{childIdx:0},west:{childIdx:0},center:{childIdx:0}},children={north:null,south:null,east:null,west:null,center:null},timer={data:{},set:function(e,t,n){timer.clear(e),timer.data[e]=setTimeout(t,n)},clear:function(e){var t=timer.data;t[e]&&(clearTimeout(t[e]),delete t[e])}},_log=function(e,t,n){var r=options;return(r.showErrorMessages&&!n||n&&r.showDebugMessages)&&$.layout.msg(r.name+" / "+e,!1!==t),!1},_runCallbacks=function(evtName,pane,skipBoundEvents){var hasPane=pane&&isStr(pane),s=hasPane?state[pane]:state,o=hasPane?options[pane]:options,lName=options.name,lng=evtName+(evtName.match(/_/)?"":"_end"),shrt=lng.match(/_end$/)?lng.substr(0,lng.length-4):"",fn=o[lng]||o[shrt],retVal="NC",args=[],$P;return hasPane||"boolean"!==$.type(pane)||(skipBoundEvents=pane,pane=""),fn&&(isStr(fn)&&(fn.match(/,/)?(args=fn.split(","),fn=eval(args[0])):fn=eval(fn)),$.isFunction(fn)&&(retVal=args.length?g(fn)(args[1]):hasPane?g(fn)(pane,$Ps[pane],s,o,lName):g(fn)(Instance,s,o,lName))),skipBoundEvents||!1===retVal||(hasPane?($P=$Ps[pane],o=options[pane],s=state[pane],$P.triggerHandler("layoutpane"+lng,[pane,$P,s,o,lName]),shrt&&$P.triggerHandler("layoutpane"+shrt,[pane,$P,s,o,lName])):($N.triggerHandler("layout"+lng,[Instance,s,o,lName]),shrt&&$N.triggerHandler("layout"+shrt,[Instance,s,o,lName]))),hasPane&&"onresize_end"===evtName&&resizeChildren(pane+"",!0),retVal;function g(e){return e}},_fixIframe=function(e){if(!browser.mozilla){var t=$Ps[e];"IFRAME"===state[e].tagName?t.css(_c.hidden).css(_c.visible):t.find("IFRAME").css(_c.hidden).css(_c.visible)}},cssSize=function(e,t){return("horz"==_c[e].dir?cssH:cssW)($Ps[e],t)},cssMinDims=function(e){var t=$Ps[e],n=_c[e].dir,r={minWidth:1001-cssW(t,1e3),minHeight:1001-cssH(t,1e3)};return"horz"===n&&(r.minSize=r.minHeight),"vert"===n&&(r.minSize=r.minWidth),r},setOuterWidth=function(e,t,n){var r,a=e;isStr(e)?a=$Ps[e]:e.jquery||(a=$(e)),r=cssW(a,t),a.css({width:r}),r>0?n&&a.data("autoHidden")&&a.innerHeight()>0&&(a.show().data("autoHidden",!1),browser.mozilla||a.css(_c.hidden).css(_c.visible)):n&&!a.data("autoHidden")&&a.hide().data("autoHidden",!0)},setOuterHeight=function(e,t,n){var r,a=e;isStr(e)?a=$Ps[e]:e.jquery||(a=$(e)),r=cssH(a,t),a.css({height:r,visibility:"visible"}),r>0&&a.innerWidth()>0?n&&a.data("autoHidden")&&(a.show().data("autoHidden",!1),browser.mozilla||a.css(_c.hidden).css(_c.visible)):n&&!a.data("autoHidden")&&a.hide().data("autoHidden",!0)},_parseSize=function(e,t,n){if(n||(n=_c[e].dir),isStr(t)&&t.match(/%/)&&(t="100%"===t?-1:parseInt(t,10)/100),0===t)return 0;if(t>=1)return parseInt(t,10);var r=options,a=0;if("horz"==n?a=sC.innerHeight-($Ps.north?r.north.spacing_open:0)-($Ps.south?r.south.spacing_open:0):"vert"==n&&(a=sC.innerWidth-($Ps.west?r.west.spacing_open:0)-($Ps.east?r.east.spacing_open:0)),-1===t)return a;if(t>0)return round(a*t);if("center"==e)return 0;var l="horz"===n?"height":"width",d=$Ps[e],p="height"===l&&$Cs[e],f=$.layout.showInvisibly(d),h=d.css(l),y=p?p.css(l):0;return d.css(l,"auto"),p&&p.css(l,"auto"),t="height"===l?d.outerHeight():d.outerWidth(),d.css(l,h).css(f),p&&p.css(l,y),t},getPaneSize=function(e,t){var n=$Ps[e],r=options[e],a=state[e],l=t?r.spacing_open:0,d=t?r.spacing_closed:0;return!n||a.isHidden?0:a.isClosed||a.isSliding&&t?d:"horz"===_c[e].dir?n.outerHeight()+l:n.outerWidth()+l},setSizeLimits=function(e,t){if(isInitialized()){var n=options[e],r=state[e],a=_c[e],l=a.dir,d=(a.sizeType.toLowerCase(),null!=t?t:r.isSliding),p=($Ps[e],n.spacing_open),f=_c.oppositeEdge[e],h=state[f],y=$Ps[f],_=!y||!1===h.isVisible||h.isSliding?0:"horz"==l?y.outerHeight():y.outerWidth(),w=(!y||h.isHidden?0:options[f][!1!==h.isClosed?"spacing_closed":"spacing_open"])||0,k="horz"==l?sC.innerHeight:sC.innerWidth,S=cssMinDims("center"),C="horz"==l?max(options.center.minHeight,S.minHeight):max(options.center.minWidth,S.minWidth),P=k-p-(d?0:_parseSize("center",C,l)+_+w),E=r.minSize=max(_parseSize(e,n.minSize),cssMinDims(e).minSize),O=r.maxSize=min(n.maxSize?_parseSize(e,n.maxSize):1e5,P),j=r.resizerPosition={},z=sC.inset.top,x=sC.inset.left,T=sC.innerWidth,I=sC.innerHeight,D=n.spacing_open;switch(e){case"north":j.min=z+E,j.max=z+O;break;case"west":j.min=x+E,j.max=x+O;break;case"south":j.min=z+I-O-D,j.max=z+I-E-D;break;case"east":j.min=x+T-O-D,j.max=x+T-E-D}}},calcNewCenterPaneDims=function(){var e={top:getPaneSize("north",!0),bottom:getPaneSize("south",!0),left:getPaneSize("west",!0),right:getPaneSize("east",!0),width:0,height:0};return e.width=sC.innerWidth-e.left-e.right,e.height=sC.innerHeight-e.bottom-e.top,e.top+=sC.inset.top,e.bottom+=sC.inset.bottom,e.left+=sC.inset.left,e.right+=sC.inset.right,e},getHoverClasses=function(e,t){var n=$(e),r=n.data("layoutRole"),a=n.data("layoutEdge"),l=options[a][r+"Class"],d="-"+a,p="-open",f="-closed",h="-sliding",y="-hover ",_=n.hasClass(l+f)?f:p,w=_===f?p:f,k=l+y+(l+d+y)+(l+_+y)+(l+d+_+y);return t&&(k+=l+w+y+(l+d+w+y)),"resizer"==r&&n.hasClass(l+h)&&(k+=l+h+y+(l+d+h+y)),$.trim(k)},addHover=function(e,t){var n=$(t||this);e&&"toggler"===n.data("layoutRole")&&e.stopPropagation(),n.addClass(getHoverClasses(n))},removeHover=function(e,t){var n=$(t||this);n.removeClass(getHoverClasses(n,!0))},onResizerEnter=function(e){var t=$(this).data("layoutEdge"),n=state[t];n.isClosed||n.isResizing||state.paneResizing||($.fn.disableSelection&&$("body").disableSelection(),options.maskPanesEarly&&showMasks(t,{resizing:!0}))},onResizerLeave=function(e,t){var n=t||this,r=$(n).data("layoutEdge"),a=r+"ResizerLeave";timer.clear(r+"_openSlider"),timer.clear(a),t?state.paneResizing||($.fn.enableSelection&&$("body").enableSelection(),options.maskPanesEarly&&hideMasks()):timer.set(a,(function(){onResizerLeave(e,n)}),200)},_create=function(){initOptions();var e=options,t=state;return t.creatingLayout=!0,runPluginCallbacks(Instance,$.layout.onCreate),!1===_runCallbacks("onload_start")?"cancel":(_initContainer(),initHotkeys(),$(window).bind("unload."+sID,unload),runPluginCallbacks(Instance,$.layout.onLoad),e.initPanes&&_initLayoutElements(),delete t.creatingLayout,state.initialized)},isInitialized=function(){return!(!state.initialized&&!state.creatingLayout)||_initLayoutElements()},_initLayoutElements=function(e){var t=options;if(!$N.is(":visible"))return!e&&browser.webkit&&"BODY"===$N[0].tagName&&setTimeout((function(){_initLayoutElements(!0)}),50),!1;if(!getPane("center").length)return _log(t.errors.centerPaneMissing);if(state.creatingLayout=!0,$.extend(sC,elDims($N,t.inset)),initPanes(),t.scrollToBookmarkOnLoad){var n=self.location;n.hash&&n.replace(n.hash)}return Instance.hasParentLayout?t.resizeWithWindow=!1:t.resizeWithWindow&&$(window).bind("resize."+sID,windowResize),delete state.creatingLayout,state.initialized=!0,runPluginCallbacks(Instance,$.layout.onReady),_runCallbacks("onload_end"),!0},createChildren=function(e,t){var n=evtPane.call(this,e),r=$Ps[n];if(r){var a=$Cs[n],l=state[n],d=options[n],p=options.stateManagement||{},f=t?d.children=t:d.children;if($.isPlainObject(f))f=[f];else if(!f||!$.isArray(f))return;$.each(f,(function(e,t){$.isPlainObject(t)&&(t.containerSelector?r.find(t.containerSelector):a||r).each((function(){var e=$(this),r=e.data("layout");if(!r){if(setInstanceKey({container:e,options:t},l),p.includeChildren&&state.stateData[n]){var a=(state.stateData[n].children||{})[t.instanceKey],d=t.stateManagement||(t.stateManagement={autoLoad:!0});!0===d.autoLoad&&a&&(d.autoSave=!1,d.includeChildren=!0,d.autoLoad=$.extend(!0,{},a))}(r=e.layout(t))&&refreshChildren(n,r)}}))}))}},setInstanceKey=function(e,t){var n=e.container,r=e.options,a=r.stateManagement,l=r.instanceKey||n.data("layoutInstanceKey");return l||(l=(a&&a.cookie?a.cookie.name:"")||r.name),l=l?l.replace(/[^\w-]/gi,"_").replace(/_{2,}/g,"_"):"layout"+ ++t.childIdx,r.instanceKey=l,n.data("layoutInstanceKey",l),l},refreshChildren=function(e,t){var n,r=$Ps[e],a=children[e],l=state[e];$.isPlainObject(a)&&($.each(a,(function(e,t){t.destroyed&&delete a[e]})),$.isEmptyObject(a)&&(a=children[e]=null)),t||a||(t=r.data("layout")),t&&(t.hasParentLayout=!0,n=t.options,setInstanceKey(t,l),a||(a=children[e]={}),a[n.instanceKey]=t.container.data("layout")),Instance[e].children=children[e],t||createChildren(e)},windowResize=function(){var e=options,t=Number(e.resizeWithWindowDelay);t<10&&(t=100),timer.clear("winResize"),timer.set("winResize",(function(){timer.clear("winResize"),timer.clear("winResizeRepeater");var t=elDims($N,e.inset);t.innerWidth===sC.innerWidth&&t.innerHeight===sC.innerHeight||resizeAll()}),t),timer.data.winResizeRepeater||setWindowResizeRepeater()},setWindowResizeRepeater=function(){var e=Number(options.resizeWithWindowMaxDelay);e>0&&timer.set("winResizeRepeater",(function(){setWindowResizeRepeater(),resizeAll()}),e)},unload=function(){_runCallbacks("onunload_start"),runPluginCallbacks(Instance,$.layout.onUnload),_runCallbacks("onunload_end")},_initContainer=function(){var e,t,n=$N[0],r=$("html"),a=sC.tagName=n.tagName,l=sC.id=n.id,d=sC.className=n.className,p=options,f=p.name,h="position,margin,padding,border",y="layoutCSS",_={},w="hidden",k=$N.data("parentLayout"),S=$N.data("layoutEdge"),C=k&&S,P=$.layout.cssNum;sC.selector=$N.selector.split(".slice")[0],sC.ref=(p.name?p.name+" layout / ":"")+a+(l?"#"+l:d?".["+d+"]":""),sC.isBody="BODY"===a,C||sC.isBody||(k=(e=$N.closest("."+$.layout.defaults.panes.paneClass)).data("parentLayout"),S=e.data("layoutEdge"),C=k&&S),$N.data({layout:Instance,layoutContainer:sID}).addClass(p.containerClass);var E={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};for(f in E)$N.bind("layout"+f.toLowerCase()+"."+sID,Instance[E[f]||f]);C&&(Instance.hasParentLayout=!0,k.refreshChildren(S,Instance)),$N.data(y)||(sC.isBody?($N.data(y,$.extend(styles($N,h),{height:$N.css("height"),overflow:$N.css("overflow"),overflowX:$N.css("overflowX"),overflowY:$N.css("overflowY")})),r.data(y,$.extend(styles(r,"padding"),{height:"auto",overflow:r.css("overflow"),overflowX:r.css("overflowX"),overflowY:r.css("overflowY")}))):$N.data(y,styles($N,h+",top,bottom,left,right,width,height,overflow,overflowX,overflowY")));try{if(_={overflow:w,overflowX:w,overflowY:w},$N.css(_),p.inset&&!$.isPlainObject(p.inset)&&(t=parseInt(p.inset,10)||0,p.inset={top:t,bottom:t,left:t,right:t}),sC.isBody)p.outset?$.isPlainObject(p.outset)||(t=parseInt(p.outset,10)||0,p.outset={top:t,bottom:t,left:t,right:t}):p.outset={top:P(r,"paddingTop"),bottom:P(r,"paddingBottom"),left:P(r,"paddingLeft"),right:P(r,"paddingRight")},r.css(_).css({height:"100%",border:"none",padding:0,margin:0}),browser.isIE6?($N.css({width:"100%",height:"100%",border:"none",padding:0,margin:0,position:"relative"}),p.inset||(p.inset=elDims($N).inset)):($N.css({width:"auto",height:"auto",margin:0,position:"absolute"}),$N.css(p.outset)),$.extend(sC,elDims($N,p.inset));else{var O=$N.css("position");O&&O.match(/(fixed|absolute|relative)/)||$N.css("position","relative"),$N.is(":visible")&&($.extend(sC,elDims($N,p.inset)),sC.innerHeight<1&&_log(p.errors.noContainerHeight.replace(/CONTAINER/,sC.ref)))}P($N,"minWidth")&&$N.parent().css("overflowX","auto"),P($N,"minHeight")&&$N.parent().css("overflowY","auto")}catch(e){}},initHotkeys=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=options[t];if(n.enableCursorHotkey||n.customHotkey)return $(document).bind("keydown."+sID,keyDown),!1}))},initOptions=function(){var e,t,n,r,a,l,d;if(opts=$.layout.transformData(opts,!0),opts=$.layout.backwardCompatibility.renameAllOptions(opts),!$.isEmptyObject(opts.panes)){for(e=$.layout.optionsMap.noDefault,a=0,l=e.length;a<l;a++)n=e[a],delete opts.panes[n];for(e=$.layout.optionsMap.layout,a=0,l=e.length;a<l;a++)n=e[a],delete opts.panes[n]}e=$.layout.optionsMap.layout;var p=$.layout.config.optionRootKeys;for(n in opts)r=opts[n],$.inArray(n,p)<0&&$.inArray(n,e)<0&&(opts.panes[n]||(opts.panes[n]=$.isPlainObject(r)?$.extend(!0,{},r):r),delete opts[n]);$.extend(!0,options,opts),$.each(_c.allPanes,(function(r,a){if(_c[a]=$.extend(!0,{},_c.panes,_c[a]),t=options.panes,d=options[a],"center"===a)for(e=$.layout.optionsMap.center,r=0,l=e.length;r<l;r++)n=e[r],opts.center[n]||!opts.panes[n]&&d[n]||(d[n]=t[n]);else d=options[a]=$.extend(!0,{},t,d),function(e){var t=options[e],n=options.panes;t.fxSettings||(t.fxSettings={});n.fxSettings||(n.fxSettings={});$.each(["_open","_close","_size"],(function(r,a){var l="fxName"+a,d="fxSpeed"+a,p="fxSettings"+a,f=t[l]=t[l]||n[l]||t.fxName||n.fxName||"none",h=$.effects&&($.effects[f]||$.effects.effect&&$.effects.effect[f]);"none"!==f&&options.effects[f]&&h||(f=t[l]="none");var y=options.effects[f]||{},_=y.all||null,w=y[e]||null;t[d]=t[d]||n[d]||t.fxSpeed||n.fxSpeed||null,t[p]=$.extend(!0,{},_,w,n.fxSettings,t.fxSettings,n[p],t[p])})),delete t.fxName,delete t.fxSpeed,delete t.fxSettings}(a),d.resizerClass||(d.resizerClass="ui-layout-resizer"),d.togglerClass||(d.togglerClass="ui-layout-toggler");d.paneClass||(d.paneClass="ui-layout-pane")}));var f=opts.zIndex,h=options.zIndexes;f>0&&(h.pane_normal=f,h.content_mask=max(f+1,h.content_mask),h.resizer_normal=max(f+2,h.resizer_normal)),delete options.panes},getPane=function(e){var t=options[e].paneSelector;if("#"===t.substr(0,1))return $N.find(t).eq(0);var n=$N.children(t).eq(0);return n.length?n:$N.children("form:first").children(t).eq(0)},initPanes=function(e){evtPane(e),$.each(_c.allPanes,(function(e,t){addPane(t,!0)})),initHandles(),$.each(_c.borderPanes,(function(e,t){$Ps[t]&&state[t].isVisible&&(setSizeLimits(t),makePaneFit(t))})),sizeMidPanes("center"),$.each(_c.allPanes,(function(e,t){afterInitPane(t)}))},addPane=function(e,t){if(t||isInitialized()){var n,r,a,l=options[e],d=state[e],p=_c[e],f=p.dir,h=(d.fx,l.spacing_open,"center"===e),y={},_=$Ps[e];if(_?removePane(e,!1,!0,!1):$Cs[e]=!1,(_=$Ps[e]=getPane(e)).length){if(!_.data("layoutCSS")){_.data("layoutCSS",styles(_,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"))}Instance[e]={name:e,pane:$Ps[e],content:$Cs[e],options:options[e],state:state[e],children:children[e]},_.data({parentLayout:Instance,layoutPane:Instance[e],layoutEdge:e,layoutRole:"pane"}).css(p.cssReq).css("zIndex",options.zIndexes.pane_normal).css(l.applyDemoStyles?p.cssDemo:{}).addClass(l.paneClass+" "+l.paneClass+"-"+e).bind("mouseenter."+sID,addHover).bind("mouseleave."+sID,removeHover);var w,k={hide:"",show:"",toggle:"",close:"",open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"sizePane",sizePane:"sizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildren:"",resizeChildren:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(w in k)_.bind("layoutpane"+w.toLowerCase()+"."+sID,Instance[k[w]||w]);initContent(e,!1),h||(n=d.size=_parseSize(e,l.size),r=_parseSize(e,l.minSize)||1,a=_parseSize(e,l.maxSize)||1e5,n>0&&(n=max(min(n,a),r)),d.autoResize=l.autoResize,d.isClosed=!1,d.isSliding=!1,d.isResizing=!1,d.isHidden=!1,d.pins||(d.pins=[])),d.tagName=_[0].tagName,d.edge=e,d.noRoom=!1,d.isVisible=!0,setPanePosition(e),"horz"===f?y.height=cssH(_,n):"vert"===f&&(y.width=cssW(_,n)),_.css(y),"horz"!=f&&sizeMidPanes(e,!0),state.initialized&&(initHandles(e),initHotkeys(e)),l.initClosed&&l.closable&&!l.initHidden?close(e,!0,!0):l.initHidden||l.initClosed?hide(e):d.noRoom||_.css("display","block"),_.css("visibility","visible"),l.showOverflowOnHover&&_.hover(allowOverflow,resetOverflow),state.initialized&&afterInitPane(e)}else $Ps[e]=!1}},afterInitPane=function(e){var t=$Ps[e],n=state[e],r=options[e];t&&(t.data("layout")&&refreshChildren(e,t.data("layout")),n.isVisible&&(state.initialized?resizeAll():sizeContent(e),r.triggerEventsOnLoad?_runCallbacks("onresize_end",e):resizeChildren(e,!0)),r.initChildren&&r.children&&createChildren(e))},setPanePosition=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=$Ps[t],r=$Rs[t],a=(options[t],state[t]),l=_c[t].side,d={};if(n){switch(t){case"north":d.top=sC.inset.top,d.left=sC.inset.left,d.right=sC.inset.right;break;case"south":d.bottom=sC.inset.bottom,d.left=sC.inset.left,d.right=sC.inset.right;break;case"west":d.left=sC.inset.left;break;case"east":d.right=sC.inset.right}n.css(d),r&&a.isClosed?r.css(l,sC.inset[l]):r&&!a.isHidden&&r.css(l,sC.inset[l]+getPaneSize(t))}}))},initHandles=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=$Ps[t];if($Rs[t]=!1,$Ts[t]=!1,n){var r=options[t],a=state[t],l=(_c[t],"#"===r.paneSelector.substr(0,1)?r.paneSelector.substr(1):""),d=r.resizerClass,p=r.togglerClass,f=(a.isVisible?r.spacing_open:r.spacing_closed,"-"+t),h=(a.isVisible,Instance[t]),y=h.resizer=$Rs[t]=$("<div></div>"),_=h.toggler=!!r.closable&&($Ts[t]=$("<div></div>"));!a.isVisible&&r.slidable&&y.attr("title",r.tips.Slide).css("cursor",r.sliderCursor),y.attr("id",l?l+"-resizer":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"resizer"}).css(_c.resizers.cssReq).css("zIndex",options.zIndexes.resizer_normal).css(r.applyDemoStyles?_c.resizers.cssDemo:{}).addClass(d+" "+d+f).hover(addHover,removeHover).hover(onResizerEnter,onResizerLeave).appendTo($N),r.resizerDblClickToggle&&y.bind("dblclick."+sID,toggle),_&&(_.attr("id",l?l+"-toggler":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"toggler"}).css(_c.togglers.cssReq).css(r.applyDemoStyles?_c.togglers.cssDemo:{}).addClass(p+" "+p+f).hover(addHover,removeHover).bind("mouseenter",onResizerEnter).appendTo(y),r.togglerContent_open&&$("<span>"+r.togglerContent_open+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",t).addClass("content content-open").css("display","none").appendTo(_),r.togglerContent_closed&&$("<span>"+r.togglerContent_closed+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).addClass("content content-closed").css("display","none").appendTo(_),enableClosable(t)),initResizable(t),a.isVisible?setAsOpen(t):(setAsClosed(t),bindStartSlidingEvents(t,!0))}})),sizeHandles()},initContent=function(e,t){if(isInitialized()){var n,r=options[e],a=r.contentSelector,l=Instance[e],d=$Ps[e];a&&(n=l.content=$Cs[e]=r.findNestedContent?d.find(a).eq(0):d.children(a).eq(0)),n&&n.length?(n.data("layoutRole","content"),n.data("layoutCSS")||n.data("layoutCSS",styles(n,"height")),n.css(_c.content.cssReq),r.applyDemoStyles&&(n.css(_c.content.cssDemo),d.css(_c.content.cssDemoPane)),d.css("overflowX").match(/(scroll|auto)/)&&d.css("overflow","hidden"),state[e].content={},!1!==t&&sizeContent(e)):l.content=$Cs[e]=!1}},initResizable=function(e){var t=$.layout.plugins.draggable;e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,r){var a=options[r];if(!t||!$Ps[r]||!a.resizable)return a.resizable=!1,!0;var l,d,p=state[r],f=options.zIndexes,h=_c[r],y="horz"==h.dir?"top":"left",_=($Ps[r],$Rs[r]),w=a.resizerClass,k=0,S=w+"-drag",C=w+"-"+r+"-drag",P=w+"-dragging",E=w+"-"+r+"-dragging",O=w+"-dragging-limit",j=w+"-"+r+"-dragging-limit",z=!1;p.isClosed||_.attr("title",a.tips.Resize).css("cursor",a.resizerCursor),_.draggable({containment:$N[0],axis:"horz"==h.dir?"y":"x",delay:0,distance:1,grid:a.resizingGrid,helper:"clone",opacity:a.resizerDragOpacity,addClasses:!1,zIndex:f.resizer_drag,start:function(e,t){if(a=options[r],p=state[r],d=a.livePaneResizing,!1===_runCallbacks("ondrag_start",r))return!1;p.isResizing=!0,state.paneResizing=r,timer.clear(r+"_closeSlider"),setSizeLimits(r),l=p.resizerPosition,k=t.position[y],_.addClass(S+" "+C),z=!1,$("body").disableSelection(),showMasks(r,{resizing:!0})},drag:function(e,t){z||(t.helper.addClass(P+" "+E).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),z=!0,p.isSliding&&$Ps[r].css("zIndex",f.pane_sliding));var h=0;t.position[y]<l.min?(t.position[y]=l.min,h=-1):t.position[y]>l.max&&(t.position[y]=l.max,h=1),h?(t.helper.addClass(O+" "+j),window.defaultStatus=h>0&&r.match(/(north|west)/)||h<0&&r.match(/(south|east)/)?a.tips.maxSizeWarning:a.tips.minSizeWarning):(t.helper.removeClass(O+" "+j),window.defaultStatus=""),d&&Math.abs(t.position[y]-k)>=a.liveResizingTolerance&&(k=t.position[y],n(e,t,r))},stop:function(e,t){$("body").enableSelection(),window.defaultStatus="",_.removeClass(S+" "+C),p.isResizing=!1,state.paneResizing=!1,n(e,t,r,!0)}})}));var n=function(e,t,n,r){var a,l=t.position,d=_c[n],p=options[n],f=state[n];switch(n){case"north":a=l.top;break;case"west":a=l.left;break;case"south":a=sC.layoutHeight-l.top-p.spacing_open;break;case"east":a=sC.layoutWidth-l.left-p.spacing_open}var h=a-sC.inset[d.side];if(r)!1!==_runCallbacks("ondrag_end",n)&&manualSizePane(n,h,!1,!0),hideMasks(!0),f.isSliding&&showMasks(n,{resizing:!0});else{if(Math.abs(h-f.size)<p.liveResizingTolerance)return;manualSizePane(n,h,!1,!0),sizeMasks()}}},sizeMask=function(){var e=$(this),t=e.data("layoutMask"),n=state[t];"IFRAME"==n.tagName&&n.isVisible&&e.css({top:n.offsetTop,left:n.offsetLeft,width:n.outerWidth,height:n.outerHeight})},sizeMasks=function(){$Ms.each(sizeMask)},showMasks=function(e,t){var n,r,a=_c[e],l=["center"],d=options.zIndexes,p=$.extend({objectsOnly:!1,animation:!1,resizing:!0,sliding:state[e].isSliding},t);p.resizing&&l.push(e),p.sliding&&l.push(_c.oppositeEdge[e]),"horz"===a.dir&&(l.push("west"),l.push("east")),$.each(l,(function(e,t){r=state[t],n=options[t],r.isVisible&&(n.maskObjects||!p.objectsOnly&&n.maskContents)&&getMasks(t).each((function(){sizeMask.call(this),this.style.zIndex=r.isSliding?d.pane_sliding+1:d.pane_normal+1,this.style.display="block"}))}))},hideMasks=function(e){if(e||!state.paneResizing)$Ms.hide();else if(!e&&!$.isEmptyObject(state.panesSliding))for(var t,n,r=$Ms.length-1;r>=0;r--)t=(n=$Ms.eq(r)).data("layoutMask"),options[t].maskObjects||n.hide()},getMasks=function(e){for(var t,n=$([]),r=0,a=$Ms.length;r<a;r++)(t=$Ms.eq(r)).data("layoutMask")===e&&(n=n.add(t));return n.length?n:createMasks(e)},createMasks=function(e){var t,n,r,a,l,d=$Ps[e],p=state[e],f=options[e],h=options.zIndexes,y=$([]);if(!f.maskContents&&!f.maskObjects)return y;for(l=0;l<(f.maskObjects?2:1);l++)t=f.maskObjects&&0==l,n=document.createElement(t?"iframe":"div"),r=$(n).data("layoutMask",e),n.className="ui-layout-mask ui-layout-mask-"+e,(a=n.style).display="block",a.position="absolute",a.background="#FFF",t&&(n.frameborder=0,n.src="about:blank",a.opacity=0,a.filter="Alpha(Opacity='0')",a.border=0),"IFRAME"==p.tagName?(a.zIndex=h.pane_normal+1,$N.append(n)):(r.addClass("ui-layout-mask-inside-pane"),a.zIndex=f.maskZindex||h.content_mask,a.top=0,a.left=0,a.width="100%",a.height="100%",d.append(n)),y=y.add(n),$Ms=$Ms.add(n);return y},destroy=function(e,t){$(window).unbind("."+sID),$(document).unbind("."+sID),"object"==typeof e?evtPane(e):t=e,$N.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(options.containerClass).unbind("."+sID),$Ms.remove(),$.each(_c.allPanes,(function(e,n){removePane(n,!1,!0,t)}));var n="layoutCSS";for(var r in $N.data(n)&&!$N.data("layoutRole")&&$N.css($N.data(n)).removeData(n),"BODY"===sC.tagName&&($N=$("html")).data(n)&&$N.css($N.data(n)).removeData(n),runPluginCallbacks(Instance,$.layout.onDestroy),unload(),Instance)r.match(/^(container|options)$/)||delete Instance[r];return Instance.destroyed=!0,Instance},removePane=function(e,t,n,r){if(isInitialized()){var a=evtPane.call(this,e),l=$Ps[a],d=$Cs[a],p=$Rs[a],f=$Ts[a];l&&$.isEmptyObject(l.data())&&(l=!1),d&&$.isEmptyObject(d.data())&&(d=!1),p&&$.isEmptyObject(p.data())&&(p=!1),f&&$.isEmptyObject(f.data())&&(f=!1),l&&l.stop(!0,!0);var h=options[a],y=(state[a],"layoutCSS"),_=children[a],w=$.isPlainObject(_)&&!$.isEmptyObject(_),k=void 0!==r?r:h.destroyChildren;if(w&&k&&($.each(_,(function(e,t){t.destroyed||t.destroy(!0),t.destroyed&&delete _[e]})),$.isEmptyObject(_)&&(_=children[a]=null,w=!1)),l&&t&&!w)l.remove();else if(l&&l[0]){var S=h.paneClass,C=S+"-"+a,P="-open",E="-sliding",O="-closed",j=[S,S+P,S+O,S+E,C,C+P,C+O,C+E];$.merge(j,getHoverClasses(l,!0)),l.removeClass(j.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+sID),w&&d?(d.width(d.width()),$.each(_,(function(e,t){t.resizeAll()}))):d&&d.css(d.data(y)).removeData(y).removeData("layoutRole"),l.data("layout")||l.css(l.data(y)).removeData(y)}f&&f.remove(),p&&p.remove(),Instance[a]=$Ps[a]=$Cs[a]=$Rs[a]=$Ts[a]=!1,{removed:!0},n||resizeAll()}},_hidePane=function(e){var t=$Ps[e],n=options[e],r=t[0].style;n.useOffscreenClose?(t.data(_c.offscreenReset)||t.data(_c.offscreenReset,{left:r.left,right:r.right}),t.css(_c.offscreenCSS)):t.hide().removeData(_c.offscreenReset)},_showPane=function(e){var t=$Ps[e],n=options[e],r=_c.offscreenCSS,a=t.data(_c.offscreenReset),l=t[0].style;t.show().removeData(_c.offscreenReset),n.useOffscreenClose&&a&&(l.left==r.left&&(l.left=a.left),l.right==r.right&&(l.right=a.right))},hide=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),r=options[n],a=state[n],l=$Ps[n],d=$Rs[n];l&&!a.isHidden&&(state.initialized&&!1===_runCallbacks("onhide_start",n)||(a.isSliding=!1,delete state.panesSliding[n],d&&d.hide(),!state.initialized||a.isClosed?(a.isClosed=!0,a.isHidden=!0,a.isVisible=!1,state.initialized||_hidePane(n),sizeMidPanes("horz"===_c[n].dir?"":"center"),(state.initialized||r.triggerEventsOnLoad)&&_runCallbacks("onhide_end",n)):(a.isHiding=!0,close(n,!1,t))))}},show=function(e,t,n,r){if(isInitialized()){var a=evtPane.call(this,e),l=(options[a],state[a]),d=$Ps[a];$Rs[a];d&&l.isHidden&&!1!==_runCallbacks("onshow_start",a)&&(l.isShowing=!0,l.isSliding=!1,delete state.panesSliding[a],!1===t?close(a,!0):open(a,!1,n,r))}},toggle=function(e,t){if(isInitialized()){var n=evtObj(e),r=evtPane.call(this,e),a=state[r];n&&n.stopImmediatePropagation(),a.isHidden?show(r):a.isClosed?open(r,!!t):close(r)}},_closePane=function(e,t){$Ps[e];var n=state[e];_hidePane(e),n.isClosed=!0,n.isVisible=!1,t&&setAsClosed(e)},close=function(e,t,n,r){var a=evtPane.call(this,e);if(state.initialized||!$Ps[a]){if(isInitialized()){var l,d,p,f=$Ps[a],h=($Rs[a],$Ts[a],options[a]),y=state[a];_c[a];$N.queue((function(e){if(!f||!h.closable&&!y.isShowing&&!y.isHiding||!t&&y.isClosed&&!y.isShowing)return e();var r=!y.isShowing&&!1===_runCallbacks("onclose_start",a);if(d=y.isShowing,p=y.isHiding,y.isSliding,delete y.isShowing,delete y.isHiding,r)return e();l=!n&&!y.isClosed&&"none"!=h.fxName_close,y.isMoving=!0,y.isClosed=!0,y.isVisible=!1,p?y.isHidden=!0:d&&(y.isHidden=!1),y.isSliding?bindStopSlidingEvents(a,!1):sizeMidPanes("horz"===_c[a].dir?"":"center",!1),setAsClosed(a),l?(lockPaneForFX(a,!0),f.hide(h.fxName_close,h.fxSettings_close,h.fxSpeed_close,(function(){lockPaneForFX(a,!1),y.isClosed&&_(),e()}))):(_hidePane(a),_(),e())}))}}else _closePane(a,!0);function _(){y.isMoving=!1,bindStartSlidingEvents(a,!0);var e=_c.oppositeEdge[a];state[e].noRoom&&(setSizeLimits(e),makePaneFit(e)),r||!state.initialized&&!h.triggerEventsOnLoad||(d||_runCallbacks("onclose_end",a),d&&_runCallbacks("onshow_end",a),p&&_runCallbacks("onhide_end",a))}},setAsClosed=function(e){if($Rs[e]){$Ps[e];var t=$Rs[e],n=$Ts[e],r=options[e],a=(state[e],_c[e].side),l=r.resizerClass,d=r.togglerClass,p="-"+e,f="-open",h="-sliding",y="-closed";t.css(a,sC.inset[a]).removeClass(l+f+" "+l+p+f).removeClass(l+h+" "+l+p+h).addClass(l+y+" "+l+p+y),r.resizable&&$.layout.plugins.draggable&&t.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title",""),n&&(n.removeClass(d+f+" "+d+p+f).addClass(d+y+" "+d+p+y).attr("title",r.tips.Open),n.children(".content-open").hide(),n.children(".content-closed").css("display","block")),syncPinBtns(e,!1),state.initialized&&sizeHandles()}},open=function(e,t,n,r){if(isInitialized()){var a,l,d=evtPane.call(this,e),p=$Ps[d],f=($Rs[d],$Ts[d],options[d]),h=state[d];_c[d];$N.queue((function(e){if(!p||!f.resizable&&!f.closable&&!h.isShowing||h.isVisible&&!h.isSliding)return e();if(h.isHidden&&!h.isShowing)return e(),void show(d,!0);h.autoResize&&h.size!=f.size?sizePane(d,f.size,!0,!0,!0):setSizeLimits(d,t);var _=_runCallbacks("onopen_start",d);return"abort"===_?e():("NC"!==_&&setSizeLimits(d,t),h.minSize>h.maxSize?(syncPinBtns(d,!1),!r&&f.tips.noRoomToOpen&&alert(f.tips.noRoomToOpen),e()):(t?bindStopSlidingEvents(d,!0):h.isSliding?bindStopSlidingEvents(d,!1):f.slidable&&bindStartSlidingEvents(d,!1),h.noRoom=!1,makePaneFit(d),l=h.isShowing,delete h.isShowing,a=!n&&h.isClosed&&"none"!=f.fxName_open,h.isMoving=!0,h.isVisible=!0,h.isClosed=!1,l&&(h.isHidden=!1),void(a?(lockPaneForFX(d,!0),p.show(f.fxName_open,f.fxSettings_open,f.fxSpeed_open,(function(){lockPaneForFX(d,!1),h.isVisible&&y(),e()}))):(_showPane(d),y(),e()))))}))}function y(){h.isMoving=!1,_fixIframe(d),h.isSliding||sizeMidPanes("vert"==_c[d].dir?"center":"",!1),setAsOpen(d)}},setAsOpen=function(e,t){var n=$Ps[e],r=$Rs[e],a=$Ts[e],l=options[e],d=state[e],p=_c[e].side,f=l.resizerClass,h=l.togglerClass,y="-"+e,_="-open",w="-closed",k="-sliding";r.css(p,sC.inset[p]+getPaneSize(e)).removeClass(f+w+" "+f+y+w).addClass(f+_+" "+f+y+_),d.isSliding?r.addClass(f+k+" "+f+y+k):r.removeClass(f+k+" "+f+y+k),removeHover(0,r),l.resizable&&$.layout.plugins.draggable?r.draggable("enable").css("cursor",l.resizerCursor).attr("title",l.tips.Resize):d.isSliding||r.css("cursor","default"),a&&(a.removeClass(h+w+" "+h+y+w).addClass(h+_+" "+h+y+_).attr("title",l.tips.Close),removeHover(0,a),a.children(".content-closed").hide(),a.children(".content-open").css("display","block")),syncPinBtns(e,!d.isSliding),$.extend(d,elDims(n)),state.initialized&&(sizeHandles(),sizeContent(e,!0)),!t&&(state.initialized||l.triggerEventsOnLoad)&&n.is(":visible")&&(_runCallbacks("onopen_end",e),d.isShowing&&_runCallbacks("onshow_end",e),state.initialized&&_runCallbacks("onresize_end",e))},slideOpen=function(e){if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),r=state[n],a=options[n].slideDelay_open;t&&t.stopImmediatePropagation(),r.isClosed&&t&&"mouseenter"===t.type&&a>0?timer.set(n+"_openSlider",l,a):l()}function l(){r.isClosed?r.isMoving||open(n,!0):bindStopSlidingEvents(n,!0)}},slideClose=function(e){if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),r=options[n],a=state[n],l=a.isMoving?1e3:300;if(!a.isClosed&&!a.isResizing)if("click"===r.slideTrigger_close)d();else{if(r.preventQuickSlideClose&&a.isMoving)return;if(r.preventPrematureSlideClose&&t&&$.layout.isMouseOverElem(t,$Ps[n]))return;t?timer.set(n+"_closeSlider",d,max(r.slideDelay_close,l)):d()}}function d(){a.isClosed?bindStopSlidingEvents(n,!1):a.isMoving||close(n)}},slideToggle=function(e){var t=evtPane.call(this,e);toggle(t,!0)},lockPaneForFX=function(e,t){var n=$Ps[e],r=state[e],a=options[e],l=options.zIndexes;t?(showMasks(e,{animation:!0,objectsOnly:!0}),n.css({zIndex:l.pane_animate}),"south"==e?n.css({top:sC.inset.top+sC.innerHeight-n.outerHeight()}):"east"==e&&n.css({left:sC.inset.left+sC.innerWidth-n.outerWidth()})):(hideMasks(),n.css({zIndex:r.isSliding?l.pane_sliding:l.pane_normal}),"south"==e?n.css({top:"auto"}):"east"!=e||n.css("left").match(/\-99999/)||n.css({left:"auto"}),browser.msie&&a.fxOpacityFix&&"slide"!=a.fxName_open&&n.css("filter")&&1==n.css("opacity")&&n[0].style.removeAttribute("filter"))},bindStartSlidingEvents=function(e,t){var n=options[e],r=($Ps[e],$Rs[e]),a=n.slideTrigger_open.toLowerCase();!r||t&&!n.slidable||(a.match(/mouseover/)?a=n.slideTrigger_open="mouseenter":a.match(/(click|dblclick|mouseenter)/)||(a=n.slideTrigger_open="click"),n.resizerDblClickToggle&&a.match(/click/)&&r[t?"unbind":"bind"]("dblclick."+sID,toggle),r[t?"bind":"unbind"](a+"."+sID,slideOpen).css("cursor",t?n.sliderCursor:"default").attr("title",t?n.tips.Slide:""))},bindStopSlidingEvents=function(e,t){var n=options[e],r=state[e],a=(_c[e],options.zIndexes),l=n.slideTrigger_close.toLowerCase(),d=t?"bind":"unbind",p=$Ps[e],f=$Rs[e];function h(t){timer.clear(e+"_closeSlider"),t.stopPropagation()}timer.clear(e+"_closeSlider"),t?(r.isSliding=!0,state.panesSliding[e]=!0,bindStartSlidingEvents(e,!1)):(r.isSliding=!1,delete state.panesSliding[e]),p.css("zIndex",t?a.pane_sliding:a.pane_normal),f.css("zIndex",t?a.pane_sliding+2:a.resizer_normal),l.match(/(click|mouseleave)/)||(l=n.slideTrigger_close="mouseleave"),f[d](l,slideClose),"mouseleave"===l&&(p[d]("mouseleave."+sID,slideClose),f[d]("mouseenter."+sID,h),p[d]("mouseenter."+sID,h)),t?"click"!==l||n.resizable||(f.css("cursor",t?n.sliderCursor:"default"),f.attr("title",t?n.tips.Close:"")):timer.clear(e+"_closeSlider")},makePaneFit=function(e,t,n,r){var a=options[e],l=state[e],d=_c[e],p=$Ps[e],f=$Rs[e],h="vert"===d.dir,y=!1;if(("center"===e||h&&l.noVerticalRoom)&&((y=l.maxHeight>=0)&&l.noRoom?(_showPane(e),f&&f.show(),l.isVisible=!0,l.noRoom=!1,h&&(l.noVerticalRoom=!1),_fixIframe(e)):y||l.noRoom||(_hidePane(e),f&&f.hide(),l.isVisible=!1,l.noRoom=!0)),"center"===e);else if(l.minSize<=l.maxSize){if(y=!0,l.size>l.maxSize)sizePane(e,l.maxSize,n,!0,r);else if(l.size<l.minSize)sizePane(e,l.minSize,n,!0,r);else if(f&&l.isVisible&&p.is(":visible")){var _=l.size+sC.inset[d.side];$.layout.cssNum(f,d.side)!=_&&f.css(d.side,_)}l.noRoom&&(l.wasOpen&&a.closable?a.autoReopen?open(e,!1,!0,!0):l.noRoom=!1:show(e,l.wasOpen,!0,!0))}else l.noRoom||(l.noRoom=!0,l.wasOpen=!l.isClosed&&!l.isSliding,l.isClosed||(a.closable?close(e,!0,!0):hide(e,!0)))},manualSizePane=function(e,t,n,r,a){if(isInitialized()){var l=evtPane.call(this,e),d=options[l],p=state[l],f=a||d.livePaneResizing&&!p.isResizing;p.autoResize=!1,sizePane(l,t,n,r,f)}},sizePane=function(e,t,n,r,a){if(isInitialized()){var l,d,p=evtPane.call(this,e),f=options[p],h=state[p],y=$Ps[p],_=$Rs[p],w=_c[p].side,k=_c[p].sizeType.toLowerCase(),S=h.isResizing&&!f.triggerEventsDuringLiveResize,C=!0!==r&&f.animatePaneSizing;$N.queue((function(e){if(setSizeLimits(p),l=h.size,t=_parseSize(p,t),t=max(t,_parseSize(p,f.minSize)),(t=min(t,h.maxSize))<h.minSize)return e(),void makePaneFit(p,!1,n);if(!a&&t===l)return e();if(h.newSize=t,!n&&state.initialized&&h.isVisible&&_runCallbacks("onresize_start",p),d=cssSize(p,t),C&&y.is(":visible")){var r=$.layout.effects.size[p]||$.layout.effects.size.all,_=f.fxSettings_size.easing||r.easing,w=options.zIndexes,S={};S[k]=d+"px",h.isMoving=!0,y.css({zIndex:w.pane_animate}).show().animate(S,f.fxSpeed_size,_,(function(){y.css({zIndex:h.isSliding?w.pane_sliding:w.pane_normal}),h.isMoving=!1,delete h.newSize,P(),e()}))}else y.css(k,d),delete h.newSize,y.is(":visible")?P():(h.size=t,$.extend(h,elDims(y))),e()}))}function P(){for(var e="width"===k?y.outerWidth():y.outerHeight(),r=[{pane:p,count:1,target:t,actual:e,correct:t===e,attempt:t,cssSize:d}],f=r[0],C={},P="Inaccurate size after resizing the "+p+"-pane.";!(f.correct||(C={pane:p,count:f.count+1,target:t},f.actual>t?C.attempt=max(0,f.attempt-(f.actual-t)):C.attempt=max(0,f.attempt+(t-f.actual)),C.cssSize=cssSize(p,C.attempt),y.css(k,C.cssSize),C.actual="width"==k?y.outerWidth():y.outerHeight(),C.correct=t===C.actual,1===r.length&&(_log(P,!1,!0),_log(f,!1,!0)),_log(C,!1,!0),r.length>3));)r.push(C),f=r[r.length-1];h.size=t,$.extend(h,elDims(y)),h.isVisible&&y.is(":visible")&&(_&&_.css(w,t+sC.inset[w]),sizeContent(p)),!n&&!S&&state.initialized&&h.isVisible&&_runCallbacks("onresize_end",p),n||(h.isSliding||sizeMidPanes("horz"==_c[p].dir?"":"center",S,a),sizeHandles());var E=_c.oppositeEdge[p];t<l&&state[E].noRoom&&(setSizeLimits(E),makePaneFit(E,!1,n)),r.length>1&&_log(P+"\nSee the Error Console for details.",!0,!0)}},sizeMidPanes=function(e,t,n){e=(e||"east,west,center").split(","),$.each(e,(function(e,r){if($Ps[r]){var a=options[r],l=state[r],d=$Ps[r],p=($Rs[r],!0),f={},h=$.layout.showInvisibly(d),y=calcNewCenterPaneDims();if($.extend(l,elDims(d)),"center"===r){if(!n&&l.isVisible&&y.width===l.outerWidth&&y.height===l.outerHeight)return d.css(h),!0;if($.extend(l,cssMinDims(r),{maxWidth:y.width,maxHeight:y.height}),f=y,l.newWidth=f.width,l.newHeight=f.height,f.width=cssW(d,f.width),f.height=cssH(d,f.height),p=f.width>=0&&f.height>=0,!state.initialized&&a.minWidth>y.width){var _=a.minWidth-l.outerWidth,w=options.east.minSize||0,k=options.west.minSize||0,S=state.east.size,C=state.west.size,P=S,E=C;if(_>0&&state.east.isVisible&&S>w&&(_-=S-(P=max(S-w,S-_))),_>0&&state.west.isVisible&&C>k&&(_-=C-(E=max(C-k,C-_))),0===_)return S&&S!=w&&sizePane("east",P,!0,!0,n),C&&C!=k&&sizePane("west",E,!0,!0,n),sizeMidPanes("center",t,n),void d.css(h)}}else{if(l.isVisible&&!l.noVerticalRoom&&$.extend(l,elDims(d),cssMinDims(r)),!n&&!l.noVerticalRoom&&y.height===l.outerHeight)return d.css(h),!0;f.top=y.top,f.bottom=y.bottom,l.newSize=y.height,f.height=cssH(d,y.height),l.maxHeight=f.height,(p=l.maxHeight>=0)||(l.noVerticalRoom=!0)}if(p?(!t&&state.initialized&&_runCallbacks("onresize_start",r),d.css(f),"center"!==r&&sizeHandles(r),!l.noRoom||l.isClosed||l.isHidden||makePaneFit(r),l.isVisible&&($.extend(l,elDims(d)),state.initialized&&sizeContent(r))):!l.noRoom&&l.isVisible&&makePaneFit(r),d.css(h),delete l.newSize,delete l.newWidth,delete l.newHeight,!l.isVisible)return!0;if("center"===r){var O=browser.isIE6||!browser.boxModel;$Ps.north&&(O||"IFRAME"==state.north.tagName)&&$Ps.north.css("width",cssW($Ps.north,sC.innerWidth)),$Ps.south&&(O||"IFRAME"==state.south.tagName)&&$Ps.south.css("width",cssW($Ps.south,sC.innerWidth))}!t&&state.initialized&&_runCallbacks("onresize_end",r)}}))},resizeAll=function(e){var t=sC.innerWidth,n=sC.innerHeight;if(evtPane(e),$N.is(":visible"))if(state.initialized){if(!0===e&&$.isPlainObject(options.outset)&&$N.css(options.outset),$.extend(sC,elDims($N,options.inset)),sC.outerHeight){if(!0===e&&setPanePosition(),!1===_runCallbacks("onresizeall_start"))return!1;var r,a;sC.innerHeight,sC.innerWidth;$.each(["south","north","east","west"],(function(e,t){$Ps[t]&&(r=options[t],(a=state[t]).autoResize&&a.size!=r.size?sizePane(t,r.size,!0,!0,!0):(setSizeLimits(t),makePaneFit(t,!1,!0,!0)))})),sizeMidPanes("",!0,!0),sizeHandles(),$.each(_c.allPanes,(function(e,t){$Ps[t]&&state[t].isVisible&&_runCallbacks("onresize_end",t)})),_runCallbacks("onresizeall_end")}}else _initLayoutElements()},resizeChildren=function(e,t){var n=evtPane.call(this,e);if(options[n].resizeChildren){t||refreshChildren(n);var r=children[n];$.isPlainObject(r)&&$.each(r,(function(e,t){t.destroyed||t.resizeAll()}))}},sizeContent=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);n=n?n.split(","):_c.allPanes,$.each(n,(function(e,n){var r=$Ps[n],a=$Cs[n],l=options[n],d=state[n],p=d.content;if(!r||!a||!r.is(":visible"))return!0;if((a.length||(initContent(n,!1),a))&&!1!==_runCallbacks("onsizecontent_start",n)){(!d.isMoving&&!d.isResizing||l.liveContentResizing||t||null==p.top)&&(y(),p.hiddenFooters>0&&"hidden"===r.css("overflow")&&(r.css("overflow","visible"),y(),r.css("overflow","hidden")));var f=d.innerHeight-(p.spaceAbove-d.css.paddingTop)-(p.spaceBelow-d.css.paddingBottom);a.is(":visible")&&p.height==f||(setOuterHeight(a,f,!0),p.height=f),state.initialized&&_runCallbacks("onsizecontent_end",n)}function h(e){return max(d.css.paddingBottom,parseInt(e.css("marginBottom"),10)||0)}function y(){var e=options[n].contentIgnoreSelector,t=a.nextAll().not(".ui-layout-mask").not(e||":lt(0)"),r=t.filter(":visible"),l=r.filter(":last");(p={top:a[0].offsetTop,height:a.outerHeight(),numFooters:t.length,hiddenFooters:t.length-r.length,spaceBelow:0}).spaceAbove=p.top,p.bottom=p.top+p.height,l.length?p.spaceBelow=l[0].offsetTop+l.outerHeight()-p.bottom+h(l):p.spaceBelow=h(a)}}))}},sizeHandles=function(e){var t=evtPane.call(this,e);t=t?t.split(","):_c.borderPanes,$.each(t,(function(e,t){var n,r=options[t],a=state[t],l=$Ps[t],d=$Rs[t],p=$Ts[t];if(l&&d){var f,h,y,_=_c[t].dir,w=a.isClosed?"_closed":"_open",k=r["spacing"+w],S=r["togglerAlign"+w],C=r["togglerLength"+w];if(0!==k){if(a.noRoom||a.isHidden||d.show(),"horz"===_?(f=sC.innerWidth,a.resizerLength=f,h=$.layout.cssNum(l,"left"),d.css({width:cssW(d,f),height:cssH(d,k),left:h>-9999?h:sC.inset.left})):(f=l.outerHeight(),a.resizerLength=f,d.css({height:cssH(d,f),width:cssW(d,k),top:sC.inset.top+getPaneSize("north",!0)})),removeHover(r,d),p){if(0===C||a.isSliding&&r.hideTogglerOnSlide)return void p.hide();if(p.show(),!(C>0)||"100%"===C||C>f)C=f,y=0;else if(isStr(S))switch(S){case"top":case"left":y=0;break;case"bottom":case"right":y=f-C;break;default:y=round((f-C)/2)}else{var P=parseInt(S,10);y=S>=0?P:f-C+P}if("horz"===_){var E=cssW(p,C);p.css({width:E,height:cssH(p,k),left:y,top:0}),p.children(".content").each((function(){(n=$(this)).css("marginLeft",round((E-n.outerWidth())/2))}))}else{var O=cssH(p,C);p.css({height:O,width:cssW(p,k),top:y,left:0}),p.children(".content").each((function(){(n=$(this)).css("marginTop",round((O-n.outerHeight())/2))}))}removeHover(0,p)}state.initialized||!r.initHidden&&!a.isHidden||(d.hide(),p&&p.hide())}else d.hide()}}))},enableClosable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Ts[t],r=options[t];n&&(r.closable=!0,n.bind("click."+sID,(function(e){e.stopPropagation(),toggle(t)})).css("visibility","visible").css("cursor","pointer").attr("title",state[t].isClosed?r.tips.Open:r.tips.Close).show())}},disableClosable=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),r=$Ts[n];r&&(options[n].closable=!1,state[n].isClosed&&open(n,!1,!0),r.unbind("."+sID).css("visibility",t?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].slidable=!0,state[t].isClosed&&bindStartSlidingEvents(t,!0))}},disableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&(options[t].slidable=!1,state[t].isSliding?close(t,!1,!0):(bindStartSlidingEvents(t,!1),n.css("cursor","default").attr("title",""),removeHover(null,n[0])))}},enableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t],r=options[t];n&&n.data("draggable")&&(r.resizable=!0,n.draggable("enable"),state[t].isClosed||n.css("cursor",r.resizerCursor).attr("title",r.tips.Resize))}},disableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].resizable=!1,n.draggable("disable").css("cursor","default").attr("title",""),removeHover(null,n[0]))}},swapPanes=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);if(state[n].edge=t,state[t].edge=n,!1===_runCallbacks("onswap_start",n)||!1===_runCallbacks("onswap_start",t))return state[n].edge=n,void(state[t].edge=t);var r=d(n),a=d(t),l={};return l[n]=r?r.state.size:0,l[t]=a?a.state.size:0,$Ps[n]=!1,$Ps[t]=!1,state[n]={},state[t]={},$Ts[n]&&$Ts[n].remove(),$Ts[t]&&$Ts[t].remove(),$Rs[n]&&$Rs[n].remove(),$Rs[t]&&$Rs[t].remove(),$Rs[n]=$Rs[t]=$Ts[n]=$Ts[t]=!1,p(r,t),p(a,n),r=a=l=null,$Ps[n]&&$Ps[n].css(_c.visible),$Ps[t]&&$Ps[t].css(_c.visible),resizeAll(),_runCallbacks("onswap_end",n),void _runCallbacks("onswap_end",t)}function d(e){var t=$Ps[e],n=$Cs[e];return!!t&&{pane:e,P:!!t&&t[0],C:!!n&&n[0],state:$.extend(!0,{},state[e]),options:$.extend(!0,{},options[e])}}function p(e,t){if(e){var n,r,a=e.P,d=e.C,p=e.pane,f=_c[t],h=$.extend(!0,{},state[t]),y=options[t],_={resizerCursor:y.resizerCursor};$.each("fxName,fxSpeed,fxSettings".split(","),(function(e,t){_[t+"_open"]=y[t+"_open"],_[t+"_close"]=y[t+"_close"],_[t+"_size"]=y[t+"_size"]})),$Ps[t]=$(a).data({layoutPane:Instance[t],layoutEdge:t}).css(_c.hidden).css(f.cssReq),$Cs[t]=!!d&&$(d),options[t]=$.extend(!0,{},e.options,_),state[t]=$.extend(!0,{},e.state),n=new RegExp(y.paneClass+"-"+p,"g"),a.className=a.className.replace(n,y.paneClass+"-"+t),initHandles(t),f.dir!=_c[p].dir?(r=l[t]||0,setSizeLimits(t),r=max(r,state[t].minSize),manualSizePane(t,r,!0,!0)):$Rs[t].css(f.side,sC.inset[f.side]+(state[t].isVisible?getPaneSize(t):0)),e.state.isVisible&&!h.isVisible?setAsOpen(t,!0):(setAsClosed(t),bindStartSlidingEvents(t,!0)),e=null}}},syncPinBtns=function(e,t){$.layout.plugins.buttons&&$.each(state[e].pins,(function(n,r){$.layout.buttons.setPinState(Instance,$(r),e,t)}))};function keyDown(e){if(!e)return!0;var t=e.keyCode;if(t<33)return!0;var n,r,a,l,d={38:"north",40:"south",37:"west",39:"east"},p=(e.altKey,e.shiftKey),f=e.ctrlKey;return f&&t>=37&&t<=40&&options[d[t]].enableCursorHotkey?l=d[t]:(f||p)&&$.each(_c.borderPanes,(function(e,d){if(n=options[d],r=n.customHotkey,a=n.customHotkeyModifier,(p&&"SHIFT"==a||f&&"CTRL"==a||f&&p)&&r&&t===(isNaN(r)||r<=9?r.toUpperCase().charCodeAt(0):r))return l=d,!1})),!(l&&$Ps[l]&&options[l].closable&&!state[l].isHidden)||(toggle(l),e.stopPropagation(),e.returnValue=!1,!1)}function allowOverflow(e){var t;if(isInitialized()&&(this&&this.tagName&&(e=this),isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each((function(){if($(this).data("layoutRole"))return t=$(this),!1})),t&&t.length)){var n=t.data("layoutEdge"),r=state[n];if(r.cssSaved&&resetOverflow(n),r.isSliding||r.isResizing||r.isClosed)r.cssSaved=!1;else{var a={zIndex:options.zIndexes.resizer_normal+1},l={},d=t.css("overflow"),p=t.css("overflowX"),f=t.css("overflowY");"visible"!=d&&(l.overflow=d,a.overflow="visible"),p&&!p.match(/(visible|auto)/)&&(l.overflowX=p,a.overflowX="visible"),f&&!f.match(/(visible|auto)/)&&(l.overflowY=p,a.overflowY="visible"),r.cssSaved=l,t.css(a),$.each(_c.allPanes,(function(e,t){t!=n&&resetOverflow(t)}))}}}function resetOverflow(e){var t;if(isInitialized()&&(this&&this.tagName&&(e=this),isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each((function(){if($(this).data("layoutRole"))return t=$(this),!1})),t&&t.length)){var n=t.data("layoutEdge"),r=state[n],a=r.cssSaved||{};r.isSliding||r.isResizing||t.css("zIndex",options.zIndexes.pane_normal),t.css(a),r.cssSaved=!1}}try{var $N=$(this).eq(0);if(!$N.length)return _log(options.errors.containerMissing);if($N.data("layoutContainer")&&$N.data("layout"))return $N.data("layout")}catch(e){console.log("eeeee",e)}var $Ps={},$Cs={},$Rs={},$Ts={},$Ms=$([]),sC=state.container,sID=state.id,Instance={options:options,state:state,container:$N,panes:$Ps,contents:$Cs,resizers:$Rs,togglers:$Ts,hide:hide,show:show,toggle:toggle,open:open,close:close,slideOpen:slideOpen,slideClose:slideClose,slideToggle:slideToggle,setSizeLimits:setSizeLimits,_sizePane:sizePane,sizePane:manualSizePane,sizeContent:sizeContent,swapPanes:swapPanes,showMasks:showMasks,hideMasks:hideMasks,initContent:initContent,addPane:addPane,removePane:removePane,createChildren:createChildren,refreshChildren:refreshChildren,enableClosable:enableClosable,disableClosable:disableClosable,enableSlidable:enableSlidable,disableSlidable:disableSlidable,enableResizable:enableResizable,disableResizable:disableResizable,allowOverflow:allowOverflow,resetOverflow:resetOverflow,destroy:destroy,initPanes:isInitialized,resizeAll:resizeAll,runCallbacks:_runCallbacks,hasParentLayout:!1,children:children,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===_create()?null:Instance}})(jQuery),function(e){e.ui||(e.ui={}),e.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(t){for(var n,r=document.cookie,a=r?r.split(";"):[],l=0,d=a.length;l<d;l++)if((n=e.trim(a[l]).split("="))[0]==t)return decodeURIComponent(n[1]);return null},write:function(t,n,r){var a="",l="",d=!1,p=r||{},f=p.expires||null,h=e.type(f);"date"===h?l=f:"string"===h&&f>0&&(f=parseInt(f,10),h="number"),"number"===h&&(l=new Date,f>0?l.setDate(l.getDate()+f):(l.setFullYear(1970),d=!0)),l&&(a+=";expires="+l.toUTCString()),p.path&&(a+=";path="+p.path),p.domain&&(a+=";domain="+p.domain),p.secure&&(a+=";secure"),document.cookie=t+"="+(d?"":encodeURIComponent(n))+a},clear:function(t){e.ui.cookie.write(t,"",{expires:-1})}},e.cookie||(e.cookie=function(t,n,r){var a=e.ui.cookie;if(null===n)a.clear(t);else{if(void 0===n)return a.read(t);a.write(t,n,r)}}),e.layout.plugins.stateManagement=!0,e.layout.config.optionRootKeys.push("stateManagement"),e.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,animateLoad:!0,includeChildren:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}},e.layout.optionsMap.layout.push("stateManagement"),e.layout.state={saveCookie:function(t,n,r){var a=t.options,l=a.stateManagement,d=e.extend(!0,{},l.cookie,r||null),p=t.state.stateData=t.readState(n||l.stateKeys);return e.ui.cookie.write(d.name||a.name||"Layout",e.layout.state.encodeJSON(p),d),e.extend(!0,{},p)},deleteCookie:function(t){var n=t.options;e.ui.cookie.clear(n.stateManagement.cookie.name||n.name||"Layout")},readCookie:function(t){var n=t.options,r=e.ui.cookie.read(n.stateManagement.cookie.name||n.name||"Layout");return r?e.layout.state.decodeJSON(r):{}},loadCookie:function(t){var n=e.layout.state.readCookie(t);return n&&(t.state.stateData=e.extend(!0,{},n),t.loadState(n)),n},loadState:function(t,n,r){if(e.isPlainObject(n)&&!e.isEmptyObject(n)){n=t.state.stateData=e.layout.transformData(n);var a=t.options.stateManagement;if(r=e.extend({animateLoad:!1,includeChildren:a.includeChildren},r),t.state.initialized){var l,d,p,f,h,y,_=!r.animateLoad;if(e.each(e.layout.config.borderPanes,(function(r,a){w=n[a],e.isPlainObject(w)&&(s=w.size,l=w.initClosed,d=w.initHidden,ar=w.autoResize,p=t.state[a],f=p.isVisible,ar&&(p.autoResize=ar),f||t._sizePane(a,s,!1,!1,!1),!0===d?t.hide(a,_):!0===l?t.close(a,!1,_):!1===l?t.open(a,!1,_):!1===d&&t.show(a,!1,_),f&&t._sizePane(a,s,!1,!1,_))})),r.includeChildren)e.each(t.children,(function(t,r){(h=n[t]?n[t].children:0)&&r&&e.each(r,(function(e,t){y=h[e],t&&y&&t.loadState(y)}))}))}else{var w=e.extend(!0,{},n);e.each(e.layout.config.allPanes,(function(e,t){w[t]&&delete w[t].children})),e.extend(!0,t.options,w)}}},readState:function(t,n){"string"===e.type(n)&&(n={keys:n}),n||(n={});var r,a,l,d,p,f,h,y=t.options.stateManagement,_=n.includeChildren,w=void 0!==_?_:y.includeChildren,k=n.stateKeys||y.stateKeys,S={isClosed:"initClosed",isHidden:"initHidden"},C=t.state,P=e.layout.config.allPanes,E={};e.isArray(k)&&(k=k.join(","));for(var O=0,j=(k=k.replace(/__/g,".").split(",")).length;O<j;O++)a=(r=k[O].split("."))[0],l=r[1],e.inArray(a,P)<0||null!=(d=C[a][l])&&("isClosed"==l&&C[a].isSliding&&(d=!0),(E[a]||(E[a]={}))[S[l]?S[l]:l]=d);return w&&e.each(P,(function(n,r){f=t.children[r],p=C.stateData[r],e.isPlainObject(f)&&!e.isEmptyObject(f)&&((h=E[r]||(E[r]={})).children||(h.children={}),e.each(f,(function(t,n){n.state.initialized?h.children[t]=e.layout.state.readState(n):p&&p.children&&p.children[t]&&(h.children[t]=e.extend(!0,{},p.children[t]))})))})),E},encodeJSON:function(t){return function t(n){var r,a,l,d=[],p=0,f=e.isArray(n);for(r in n)"string"==(l=typeof(a=n[r]))?a='"'+a+'"':"object"==l&&(a=t(a)),d[p++]=(f?"":'"'+r+'":')+a;return(f?"[":"{")+d.join(",")+(f?"]":"}")}(t)},decodeJSON:function(t){try{return e.parseJSON?e.parseJSON(t):window.eval("("+t+")")||{}}catch(e){return{}}},_create:function(t){var n=e.layout.state,r=t.options.stateManagement;if(e.extend(t,{readCookie:function(){return n.readCookie(t)},deleteCookie:function(){n.deleteCookie(t)},saveCookie:function(e,r){return n.saveCookie(t,e,r)},loadCookie:function(){return n.loadCookie(t)},loadState:function(e,r){n.loadState(t,e,r)},readState:function(e){return n.readState(t,e)},encodeJSON:n.encodeJSON,decodeJSON:n.decodeJSON}),t.state.stateData={},r.autoLoad)if(e.isPlainObject(r.autoLoad))e.isEmptyObject(r.autoLoad)||t.loadState(r.autoLoad);else if(r.enabled)if(e.isFunction(r.autoLoad)){var a={};try{a=r.autoLoad(t,t.state,t.options,t.options.name||"")}catch(e){}a&&e.isPlainObject(a)&&!e.isEmptyObject(a)&&t.loadState(a)}else t.loadCookie()},_unload:function(t){var n=t.options.stateManagement;if(n.enabled&&n.autoSave)if(e.isFunction(n.autoSave))try{n.autoSave(t,t.state,t.options,t.options.name||"")}catch(e){}else t.saveCookie()}},e.layout.onCreate.push(e.layout.state._create),e.layout.onUnload.push(e.layout.state._unload),e.layout.plugins.buttons=!0,e.layout.defaults.autoBindCustomButtons=!1,e.layout.optionsMap.layout.push("autoBindCustomButtons"),e.layout.buttons={init:function(t){var n,r=t.options.name||"";e.each("toggle,open,close,pin,toggle-slide,open-slide".split(","),(function(a,l){e.each(e.layout.config.borderPanes,(function(a,d){e(".ui-layout-button-"+l+"-"+d).each((function(){null!=(n=e(this).data("layoutName")||e(this).attr("layoutName"))&&n!==r||t.bindButton(this,l,d)}))}))}))},get:function(t,n,r,a){var l=e(n),d=t.options,p=d.errors.addButtonError;if(l.length)if(e.inArray(r,e.layout.config.borderPanes)<0)e.layout.msg(p+" "+d.errors.pane+": "+r,!0),l=e("");else{var f=d[r].buttonClass+"-"+a;l.addClass(f+" "+f+"-"+r).data("layoutName",d.name)}else e.layout.msg(p+" "+d.errors.selector+": "+n,!0);return l},bind:function(t,n,r,a){var l=e.layout.buttons;switch(r.toLowerCase()){case"toggle":l.addToggle(t,n,a);break;case"open":l.addOpen(t,n,a);break;case"close":l.addClose(t,n,a);break;case"pin":l.addPin(t,n,a);break;case"toggle-slide":l.addToggle(t,n,a,!0);break;case"open-slide":l.addOpen(t,n,a,!0)}return t},addToggle:function(t,n,r,a){return e.layout.buttons.get(t,n,r,"toggle").click((function(e){t.toggle(r,!!a),e.stopPropagation()})),t},addOpen:function(t,n,r,a){return e.layout.buttons.get(t,n,r,"open").attr("title",t.options[r].tips.Open).click((function(e){t.open(r,!!a),e.stopPropagation()})),t},addClose:function(t,n,r){return e.layout.buttons.get(t,n,r,"close").attr("title",t.options[r].tips.Close).click((function(e){t.close(r),e.stopPropagation()})),t},addPin:function(t,n,r){var a=e.layout.buttons,l=a.get(t,n,r,"pin");if(l.length){var d=t.state[r];l.click((function(n){a.setPinState(t,e(this),r,d.isSliding||d.isClosed),d.isSliding||d.isClosed?t.open(r):t.close(r),n.stopPropagation()})),a.setPinState(t,l,r,!d.isClosed&&!d.isSliding),d.pins.push(n)}return t},setPinState:function(e,t,n,r){var a=t.attr("pin");if(!a||r!==("down"==a)){var l=e.options[n],d=l.buttonClass+"-pin",p=d+"-"+n,f=d+"-up "+p+"-up",h=d+"-down "+p+"-down";t.attr("pin",r?"down":"up").attr("title",r?l.tips.Unpin:l.tips.Pin).removeClass(r?f:h).addClass(r?h:f)}},syncPinBtns:function(t,n,r){e.each(t.state[n].pins,(function(a,l){e.layout.buttons.setPinState(t,e(l),n,r)}))},_load:function(t){var n=e.layout.buttons;e.extend(t,{bindButton:function(e,r,a){return n.bind(t,e,r,a)},addToggleBtn:function(e,r,a){return n.addToggle(t,e,r,a)},addOpenBtn:function(e,r,a){return n.addOpen(t,e,r,a)},addCloseBtn:function(e,r){return n.addClose(t,e,r)},addPinBtn:function(e,r){return n.addPin(t,e,r)}});for(var r=0;r<4;r++){var a=e.layout.config.borderPanes[r];t.state[a].pins=[]}t.options.autoBindCustomButtons&&n.init(t)},_unload:function(e){}},e.layout.onLoad.push(e.layout.buttons._load),e.layout.plugins.browserZoom=!0,e.layout.defaults.browserZoomCheckInterval=1e3,e.layout.optionsMap.layout.push("browserZoomCheckInterval"),e.layout.browserZoom={_init:function(t){!1!==e.layout.browserZoom.ratio()&&e.layout.browserZoom._setTimer(t)},_setTimer:function(t){if(!t.destroyed){var n=t.options,r=t.state,a=t.hasParentLayout?5e3:Math.max(n.browserZoomCheckInterval,100);setTimeout((function(){if(!t.destroyed&&n.resizeWithWindow){var a=e.layout.browserZoom.ratio();a!==r.browserZoom&&(r.browserZoom=a,t.resizeAll()),e.layout.browserZoom._setTimer(t)}}),a)}},ratio:function(){var t,n,r,a=window,l=screen,d=document,p=d.documentElement||d.body,f=e.layout.browser,h=f.version;return!(f.msie&&h>8||!f.msie)&&(l.deviceXDPI&&l.systemXDPI?y(l.deviceXDPI,l.systemXDPI):f.webkit&&(t=d.body.getBoundingClientRect)?y(t.left-t.right,d.body.offsetWidth):f.webkit&&(n=a.outerWidth)?y(n,a.innerWidth):!(!(n=l.width)||!(r=p.clientWidth))&&y(n,r));function y(e,t){return(parseInt(e,10)/parseInt(t,10)*100).toFixed()}}},e.layout.onReady.push(e.layout.browserZoom._init)}(jQuery)},20789:function(){!function(e){if(e.support.touch="ontouchend"in document,e.support.touch){var t,n=e.ui.mouse.prototype,r=n._mouseInit,a=n._mouseDestroy;n._touchStart=function(e){!t&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(t=!0,this._touchMoved=!1,l(e,"mouseover"),l(e,"mousemove"),l(e,"mousedown"))},n._touchMove=function(e){t&&(this._touchMoved=!0,l(e,"mousemove"))},n._touchEnd=function(e){t&&(l(e,"mouseup"),l(e,"mouseout"),this._touchMoved||l(e,"click"),t=!1)},n._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),r.call(t)},n._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),a.call(t)}}function l(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}}}(jQuery)},58976:function(e,t,n){"use strict";var r=n(81637),a=n.n(r),l=n(45177);e=n.hmd(e);var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,l=void 0;try{for(var d,p=e[Symbol.iterator]();!(r=(d=p.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{!r&&p.return&&p.return()}finally{if(a)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}const{Doc:y}=(()=>{var e,t,n,r=void 0;window.sharejs=r={};var y=r.types={};r._bt=t=function(e,t,n,r){var a=void 0;return e.transformX=e.transformX=a=function(e,l){n(e),n(l);var d,p,h,y=[],_=!0,w=!1,k=void 0;try{for(var S,C=Array.from(l)[Symbol.iterator]();!(_=(S=C.next()).done);_=!0){for(var P=S.value,E=[],O=0;O<e.length;){var j,z=[];if(d=e[O],h=z,t(E,d,p=P,"left"),t(h,p,d,"right"),O++,1!==z.length){if(0===z.length){var x=!0,T=!1,I=void 0;try{for(var D,M=Array.from(e.slice(O))[Symbol.iterator]();!(x=(D=M.next()).done);x=!0)j=D.value,r(E,j)}catch(e){T=!0,I=e}finally{try{!x&&M.return&&M.return()}finally{if(T)throw I}}P=null;break}var R=Array.from(a(e.slice(O),z)),A=f(R,2),N=A[0],L=A[1],H=!0,F=!1,U=void 0;try{for(var W,B=Array.from(N)[Symbol.iterator]();!(H=(W=B.next()).done);H=!0)j=W.value,r(E,j)}catch(e){F=!0,U=e}finally{try{!H&&B.return&&B.return()}finally{if(F)throw U}}var V=!0,q=!1,Z=void 0;try{for(var G,Y=Array.from(L)[Symbol.iterator]();!(V=(G=Y.next()).done);V=!0){var X=G.value;r(y,X)}}catch(e){q=!0,Z=e}finally{try{!V&&Y.return&&Y.return()}finally{if(q)throw Z}}P=null;break}P=z[0]}null!=P&&r(y,P),e=E}}catch(e){w=!0,k=e}finally{try{!_&&C.return&&C.return()}finally{if(w)throw k}}return[e,y]},e.transform=e.transform=function(e,n,r){if("left"!==r&&"right"!==r)throw new Error("type must be 'left' or 'right'");if(0===n.length)return e;if(1===e.length&&1===n.length)return t([],e[0],n[0],r);if("left"===r){var l,d=Array.from(a(e,n)),p=f(d,2);return l=p[0],p[1],l}var h=Array.from(a(n,e)),y=f(h,2);return y[0],y[1]}};var _={name:"text",create:function(){return""}},w=function(e,t,n){return e.slice(0,t)+n+e.slice(t)},k=function(e){if("number"!=typeof e.p)throw new Error("component missing position field");if(!("string"===p(e.i)^"string"===p(e.d)^"string"===p(e.c)))throw new Error("component needs an i, d or c field");if(!(e.p>=0))throw new Error("position cannot be negative")},S=function(e){var t=!0,n=!1,r=void 0;try{for(var a,l=Array.from(e)[Symbol.iterator]();!(t=(a=l.next()).done);t=!0){var d=a.value;k(d)}}catch(e){n=!0,r=e}finally{try{!t&&l.return&&l.return()}finally{if(n)throw r}}return!0};_.apply=function(e,t){S(t);var n=!0,r=!1,a=void 0;try{for(var l,d=Array.from(t)[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var p=l.value;if(null!=p.i)e=w(e,p.p,p.i);else if(null!=p.d){var f=e.slice(p.p,p.p+p.d.length);if(p.d!==f)throw new Error("Delete component '"+p.d+"' does not match deleted text '"+f+"'");e=e.slice(0,p.p)+e.slice(p.p+p.d.length)}else{if(null==p.c)throw new Error("Unknown op type");var h=e.slice(p.p,p.p+p.c.length);if(p.c!==h)throw new Error("Comment component '"+p.c+"' does not match commented text '"+h+"'")}}}catch(e){r=!0,a=e}finally{try{!n&&d.return&&d.return()}finally{if(r)throw a}}return e};var C=function(e,t){var n=void 0,r={};for(var a in e)n=e[a],r[a]=n;for(a in t)n=t[a],r[a]=n;return r};_._append=e=function(e,t){if(""!==t.i&&""!==t.d){if(0===e.length)return e.push(t);var n=e[e.length-1];return null!=n.i&&null!=t.i&&n.p<=t.p&&t.p<=n.p+n.i.length&&n.u===t.u?e[e.length-1]=C(n,{i:w(n.i,t.p-n.p,t.i)}):null!=n.d&&null!=t.d&&t.p<=n.p&&n.p<=t.p+t.d.length&&n.u===t.u?e[e.length-1]=C(n,{d:w(t.d,n.p-t.p,n.d),p:t.p}):e.push(t)}},_.compose=function(t,n){S(t),S(n);var r=t.slice(),a=!0,l=!1,d=void 0;try{for(var p,f=Array.from(n)[Symbol.iterator]();!(a=(p=f.next()).done);a=!0){var h=p.value;e(r,h)}}catch(e){l=!0,d=e}finally{try{!a&&f.return&&f.return()}finally{if(l)throw d}}return r},_.compress=function(e){return _.compose([],e)},_.normalize=function(t){var n=[];null==t.i&&null==t.p||(t=[t]);var r=!0,a=!1,l=void 0;try{for(var d,p=Array.from(t)[Symbol.iterator]();!(r=(d=p.next()).done);r=!0){var f=d.value;null==f.p&&(f.p=0),e(n,f)}}catch(e){a=!0,l=e}finally{try{!r&&p.return&&p.return()}finally{if(a)throw l}}return n};var P=function(e,t,n){if(null!=t.i)return t.p<e||t.p===e&&n?e+t.i.length:e;if(null!=t.d)return e<=t.p?e:e<=t.p+t.d.length?t.p:e-t.d.length;if(null!=t.c)return e;throw new Error("unknown op type")};_.transformCursor=function(e,t,n){var r="right"===n,a=!0,l=!1,d=void 0;try{for(var p,f=Array.from(t)[Symbol.iterator]();!(a=(p=f.next()).done);a=!0){var h=p.value;e=P(e,h,r)}}catch(e){l=!0,d=e}finally{try{!a&&f.return&&f.return()}finally{if(l)throw d}}return e},_._tc=n=function(t,n,r,a){var l=void 0,d=void 0,p=void 0;if(S([n]),S([r]),null!=n.i)e(t,C(n,{p:P(n.p,r,"right"===a)}));else if(null!=n.d)if(null!=r.i){var f=n.d;n.p<r.p&&(e(t,C(n,{d:f.slice(0,r.p-n.p)})),f=f.slice(r.p-n.p)),""!==f&&e(t,C(n,{d:f,p:n.p+r.i.length}))}else if(null!=r.d)if(n.p>=r.p+r.d.length)e(t,C(n,{p:n.p-r.d.length}));else if(n.p+n.d.length<=r.p)e(t,n);else{if(p=C(n,{d:""}),n.p<r.p&&(p.d=n.d.slice(0,r.p-n.p)),n.p+n.d.length>r.p+r.d.length&&(p.d+=n.d.slice(r.p+r.d.length-n.p)),d=Math.max(n.p,r.p),l=Math.min(n.p+n.d.length,r.p+r.d.length),n.d.slice(d-n.p,l-n.p)!==r.d.slice(d-r.p,l-r.p))throw new Error("Delete ops delete different text in the same region of the document");""!==p.d&&(p.p=P(p.p,r),e(t,p))}else{if(null==r.c)throw new Error("unknown op type");e(t,n)}else if(null!=n.c)if(null!=r.i)if(n.p<r.p&&r.p<n.p+n.c.length){var h=r.p-n.p,y=n.c.slice(0,+(h-1)+1||void 0)+r.i+n.c.slice(h);e(t,C(n,{c:y}))}else e(t,C(n,{p:P(n.p,r,!0)}));else if(null!=r.d)if(n.p>=r.p+r.d.length)e(t,C(n,{p:n.p-r.d.length}));else if(n.p+n.c.length<=r.p)e(t,n);else{if(p=C(n,{c:""}),n.p<r.p&&(p.c=n.c.slice(0,r.p-n.p)),n.p+n.c.length>r.p+r.d.length&&(p.c+=n.c.slice(r.p+r.d.length-n.p)),d=Math.max(n.p,r.p),l=Math.min(n.p+n.c.length,r.p+r.d.length),n.c.slice(d-n.p,l-n.p)!==r.d.slice(d-r.p,l-r.p))throw new Error("Delete ops delete different text in the same region of the document");p.p=P(p.p,r),e(t,p)}else{if(null==r.c)throw new Error("unknown op type");e(t,n)}return t};_.invert=function(e){return Array.from(e.slice().reverse()).map((function(e){return function(e){return null!=e.i?{d:e.i,p:e.p}:{i:e.d,p:e.p}}(e)}))},r.types||(r.types={}),t(_,n,S,e),r.types.text=_,_.api={provides:{text:!0},getLength:function(){return this.snapshot.length},getText:function(){return this.snapshot},insert:function(e,t,n,r){var a={p:e,i:t};return n&&(a.u=!0),a=[a],this.submitOp(a,r),a},del:function(e,t,n,r){var a={p:e,d:this.snapshot.slice(e,e+t)};return n&&(a.u=!0),a=[a],this.submitOp(a,r),a},_register:function(){return this.on("remoteop",(function(e){var t=this;return function(){var n=[],r=!0,a=!1,l=void 0;try{for(var d,p=Array.from(e)[Symbol.iterator]();!(r=(d=p.next()).done);r=!0){var f=d.value;void 0!==f.i?n.push(t.emit("insert",f.p,f.i)):void 0!==f.d?n.push(t.emit("delete",f.p,f.d)):n.push(void 0)}}catch(e){a=!0,l=e}finally{try{!r&&p.return&&p.return()}finally{if(a)throw l}}return n}()}))}};var E=function(e){return setTimeout(e,0)},O=function(){function e(){h(this,e)}return d(e,[{key:"on",value:function(e,t){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(t),this}},{key:"removeListener",value:function(e,t){var n=this;this._events||(this._events={});for(var r=this._events[e]||(this._events[e]=[]),a=0;a<r.length;)r[a]===t&&(r[a]=void 0),a++;return E((function(){return n._events[e]=Array.from(n._events[e]).filter((function(e){return e}))})),this}},{key:"emit",value:function(e){if(!(null!=this._events?this._events[e]:void 0))return this;for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=!0,l=!1,d=void 0;try{for(var p,f=Array.from(this._events[e])[Symbol.iterator]();!(a=(p=f.next()).done);a=!0){var h=p.value;h&&h.apply(this,n)}}catch(e){l=!0,d=e}finally{try{!a&&f.return&&f.return()}finally{if(l)throw d}}return this}}]),e}();O.mixin=function(e){var t=e.prototype||e;return t.on=O.prototype.on,t.removeListener=O.prototype.removeListener,t.emit=O.prototype.emit,e},r.extendDoc=function(e,t){return j.prototype[e]=t};var j=function(){function e(t,n,r){h(this,e),this.flush=this.flush.bind(this),this.setFlushDelay=this.setFlushDelay.bind(this),this.shout=this.shout.bind(this),this.connection=t,this.name=n,r||(r={}),this.version=r.v,this.snapshot=r.snaphot,r.type&&this._setType(r.type),this.state="closed",this.autoOpen=!1,this._create=r.create,this.inflightOp=null,this.inflightCallbacks=[],this.inflightSubmittedIds=[],this.pendingOp=null,this.pendingCallbacks=[]}return d(e,[{key:"_xf",value:function(e,t){return this.type.transformX?this.type.transformX(e,t):[this.type.transform(e,t,"left"),this.type.transform(t,e,"right")]}},{key:"_otApply",value:function(e,t,n){var r=this.snapshot;if(this.snapshot=this.type.apply(this.snapshot,e),this.emit("change",e,r,n),t)return this.emit("remoteop",e,r,n)}},{key:"_connectionStateChanged",value:function(e,t){switch(e){case"disconnected":this.state="closed",this.inflightOp&&this.inflightSubmittedIds.push(this.connection.id),this.emit("closed");break;case"ok":this.autoOpen&&this.open();break;case"stopped":"function"==typeof this._openCallback&&this._openCallback(t)}return this.emit(e,t)}},{key:"_setType",value:function(e){if("string"==typeof e&&(e=y[e]),!e||!e.compose)throw new Error("Support for types without compose() is not implemented");if(this.type=e,e.api){for(var t in e.api){var n=e.api[t];this[t]=n}return"function"==typeof this._register?this._register():void 0}return this.provides={}}},{key:"_onMessage",value:function(e){if(!0===e.open){if(this.state="open",this._create=!1,null==this.created&&(this.created=!!e.create),e.type&&this._setType(e.type),e.create?(this.created=!0,this.snapshot=this.type.create()):(!0!==this.created&&(this.created=!1),void 0!==e.snapshot&&(this.snapshot=e.snapshot)),null!=e.v&&(this.version=e.v),this.inflightOp){var t={doc:this.name,op:this.inflightOp,v:this.version};this.inflightSubmittedIds.length&&(t.dupIfSource=this.inflightSubmittedIds),this.connection.send(t)}else this.flush();return this.emit("open"),"function"==typeof this._openCallback?this._openCallback(null):void 0}if(!1===e.open)return e.error&&(l.c.error("Could not open document: "+e.error),this.emit("error",e.error),"function"==typeof this._openCallback&&this._openCallback(e.error)),this.state="closed",this.emit("closed"),"function"==typeof this._closeCallback&&this._closeCallback(),this._closeCallback=null;if(null!==e.op||"Op already submitted"!==r){if(void 0===e.op&&void 0!==e.v||e.op&&Array.from(this.inflightSubmittedIds).includes(e.meta.source)){var n=this.inflightOp;this.inflightOp=null,this.inflightSubmittedIds.length=0,null===this.pendingOp&&this.emit("saved");var r=e.error;if(r){if(this.type.invert){var a=this.type.invert(n);if(this.pendingOp){var d=Array.from(this._xf(this.pendingOp,a)),p=f(d,2);this.pendingOp=p[0],a=p[1]}this._otApply(a,!0,e)}else this.emit("error","Op apply failed ("+r+") and the op could not be reverted");var h=!0,y=!1,_=void 0;try{for(var w,k=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(h=(w=k.next()).done);h=!0)(0,w.value)(r)}catch(e){y=!0,_=e}finally{try{!h&&k.return&&k.return()}finally{if(y)throw _}}}else{if(e.v<this.version)return;if(e.v!==this.version)throw new Error("Invalid version from server");this.version++,this.emit("acknowledge",n);var S=!0,C=!1,P=void 0;try{for(var E,O=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(S=(E=O.next()).done);S=!0)(0,E.value)(null,n)}catch(e){C=!0,P=e}finally{try{!S&&O.return&&O.return()}finally{if(C)throw P}}}return this.delayedFlush()}if(e.op){if(e.v<this.version)return;if(e.doc!==this.name)return this.emit("error","Expected docName '"+this.name+"' but got "+e.doc);if(e.v!==this.version)return this.emit("error","Expected version "+this.version+" but got "+e.v);var j=e.op;if(null!==this.inflightOp){var z=Array.from(this._xf(this.inflightOp,j)),x=f(z,2);this.inflightOp=x[0],j=x[1]}if(null!==this.pendingOp){var T=Array.from(this._xf(this.pendingOp,j)),I=f(T,2);this.pendingOp=I[0],j=I[1]}return this.version++,this._otApply(j,!0,e)}if(e.meta){var D=e.meta,M=D.path,R=D.value;return"shout"===(null!=M?M[0]:void 0)?this.emit("shout",R):l.c.warn("Unhandled meta op:",e)}return l.c.warn("Unhandled document message:",e)}}},{key:"flush",value:function(){if(this.flushTimeout=null,"ok"===this.connection.state&&null===this.inflightOp&&null!==this.pendingOp){if(this.inflightOp=this.pendingOp,this.inflightCallbacks=this.pendingCallbacks,this.pendingOp=null,this.pendingCallbacks=[],this.emit("flipped_pending_to_inflight"),window.useShareJsHash||l.j){var e=Date.now(),t=this.__lastSubmitTimestamp&&e-this.__lastSubmitTimestamp;if(!this.__lastSubmitTimestamp||t>5e3||t<0||l.j){var n=a()("blob "+this.snapshot.length+"\0"+this.snapshot).toString();this.__lastSubmitTimestamp=e}}var r=this.__lastVersion;return this.__lastVersion=this.version,this.connection.send({doc:this.name,op:this.inflightOp,v:this.version,lastV:r,hash:n})}}},{key:"submitOp",value:function(e,t){null!=this.type.normalize&&(e=this.type.normalize(e));var n=this.snapshot;return this.snapshot=this.type.apply(this.snapshot,e),null!==this.pendingOp?this.pendingOp=this.type.compose(this.pendingOp,e):this.pendingOp=e,t&&this.pendingCallbacks.push(t),this.emit("change",e,n),this.delayedFlush()}},{key:"delayedFlush",value:function(){if(null==this.flushTimeout)return this.flushTimeout=setTimeout(this.flush,this._flushDelay||0)}},{key:"setFlushDelay",value:function(e){return this._flushDelay=e}},{key:"shout",value:function(e){return this.connection.send({doc:this.name,meta:{path:["shout"],value:e}})}},{key:"open",value:function(e){var t=this;if(this.autoOpen=!0,"closed"===this.state){var n={doc:this.name,open:!0};return void 0===this.snapshot&&(n.snapshot=null),this.type&&(n.type=this.type.name),null!=this.version&&(n.v=this.version),this._create&&(n.create=!0),this.connection.send(n),this.state="opening",this._openCallback=function(n){return t._openCallback=null,"function"==typeof e?e(n):void 0}}}},{key:"close",value:function(e){return this.autoOpen=!1,"closed"===this.state?"function"==typeof e?e():void 0:(this.connection.send({doc:this.name,open:!1}),this.state="closed",this.emit("closing"),this._closeCallback=e)}}]),e}();return O.mixin(j),r.Doc=j,r})();t.Z=window.sharejs},78504:function(e,t,n){"use strict";n.d(t,{c:function(){return d}});var r=n(2784),a=n(84864),l=n(85857);function d(e){let{children:t,count:n,parent:d,i18nKey:p,context:f,tOptions:h={},values:y,defaults:_,components:w,ns:k,i18n:S,t:C,shouldUnescape:P,...E}=e;const{i18n:O,defaultNS:j}=(0,r.useContext)(l.OO)||{},z=S||O||(0,l.nI)(),x=C||z&&z.t.bind(z);return(0,a.c)({children:t,count:n,parent:d,i18nKey:p,context:f,tOptions:h,values:y,defaults:_,components:w,ns:k||x&&x.ns||j||z&&z.options&&z.options.defaultNS,i18n:z,t:C,shouldUnescape:P,...E})}}},__webpack_module_cache__={},webpackQueues,webpackExports,webpackError,resolveQueue,deferred,leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,webpackQueues="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",webpackExports="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",webpackError="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",resolveQueue=function(e){e&&e.d<1&&(e.d=1,e.forEach((function(e){e.r--})),e.forEach((function(e){e.r--?e.r++:e()})))},__webpack_require__.a=function(e,t,n){var r;n&&((r=[]).d=-1);var a,l,d,p=new Set,f=e.exports,h=new Promise((function(e,t){d=t,l=e}));h[webpackExports]=f,h[webpackQueues]=function(e){r&&e(r),p.forEach(e),h.catch((function(){}))},e.exports=h,t((function(e){var t;a=function(e){return e.map((function(e){if(null!==e&&"object"==typeof e){if(e[webpackQueues])return e;if(e.then){var t=[];t.d=0,e.then((function(e){n[webpackExports]=e,resolveQueue(t)}),(function(e){n[webpackError]=e,resolveQueue(t)}));var n={};return n[webpackQueues]=function(e){e(t)},n}}var r={};return r[webpackQueues]=function(){},r[webpackExports]=e,r}))}(e);var n=function(){return a.map((function(e){if(e[webpackError])throw e[webpackError];return e[webpackExports]}))},l=new Promise((function(e){(t=function(){e(n)}).r=0;var l=function(e){e!==r&&!p.has(e)&&(p.add(e),e&&!e.d&&(t.r++,e.push(t)))};a.map((function(e){e[webpackQueues](l)}))}));return t.r?l:n()}),(function(e){e?d(h[webpackError]=e):l(f),resolveQueue(r)})),r&&r.d<0&&(r.d=0)},deferred=[],__webpack_require__.O=function(e,t,n,r){if(!t){var a=1/0;for(f=0;f<deferred.length;f++){t=deferred[f][0],n=deferred[f][1],r=deferred[f][2];for(var l=!0,d=0;d<t.length;d++)(!1&r||a>=r)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](t[d])}))?t.splice(d--,1):(l=!1,r<a&&(a=r));if(l){deferred.splice(f--,1);var p=n();void 0!==p&&(e=p)}}return e}r=r||0;for(var f=deferred.length;f>0&&deferred[f-1][2]>r;f--)deferred[f]=deferred[f-1];deferred[f]=[t,n,r]},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);__webpack_require__.r(n);var r={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var a=2&t&&e;"object"==typeof a&&!~leafPrototypes.indexOf(a);a=getProto(a))Object.getOwnPropertyNames(a).forEach((function(t){r[t]=function(){return e[t]}}));return r.default=function(){return e},__webpack_require__.d(n,r),n},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,n){return __webpack_require__.f[n](e,t),t}),[]))},__webpack_require__.u=function(e){return"js/"+({46:"zh-CN-json",123:"ru-json",320:"en-json",395:"tr-json",562:"cm6-theme8",588:"cm6-theme26",809:"cm6-theme1",929:"cm6-theme17",1312:"ja-json",1333:"cm6-theme4",1369:"cm6-theme27",1377:"ko-json",1787:"cm6-theme19",1897:"cm6-theme36",1921:"cm6-theme22",1949:"cm6-theme39",2231:"cm6-theme3",2268:"cm6-theme11",2461:"codemirror-emacs",2671:"nl-json",2834:"cm6-theme18",3340:"pt-json",3359:"cm6-theme6",3506:"cm6-theme9",3552:"cm6-theme32",3778:"cm6-theme0",4288:"cm6-theme16",4412:"cm6-theme31",4507:"no-json",4608:"cm6-theme13",4701:"cm6-theme2",4934:"cm6-theme20",5277:"pdf-js-viewer",5777:"cm6-theme15",5806:"da-json",5848:"cm6-theme12",6108:"cm6-theme5",6144:"cm6-theme35",6817:"it-json",6901:"de-json",6975:"cm6-theme33",7157:"cm6-theme10",7223:"cm6-theme25",7479:"cm6-theme7",7519:"cs-json",7530:"cm6-theme37",7846:"pl-json",7895:"cm6-theme14",8006:"fr-json",8166:"cm6-theme24",8244:"cm6-theme28",8367:"es-json",8671:"fi-json",8812:"cm6-theme23",8863:"cm6-theme34",8895:"cm6-theme30",8967:"cm6-theme38",9190:"cm6-theme29",9192:"cm6-theme21",9303:"sv-json",9516:"codemirror-editor"}[e]||e)+"-"+{46:"638538e0a9604ebcf5e7",50:"9404ec35722e1713d48d",88:"453ba1a7589d22bc4308",123:"b5c006bc6ea2b2d26f42",191:"49e3bf89192358f0e4b0",320:"2e150a6b69ebbb8f108e",375:"11f28bf3f6400a98dcd5",395:"71e7abf1c82916a2b6a4",483:"5c4ae7e90963e2a7c5b9",551:"73bcbe727344f8d100ed",562:"1f528507e3cf66b4a3a2",588:"4d6d8c9a0c56f670ad18",809:"f6afc861f6f71dc8a046",880:"9833f7c579032b9d5965",915:"1e8db6d6d6f1bc321273",929:"b3179f416508ddb8e803",1148:"db76b5d5d4b2cc80d01a",1312:"671378e76777c94bc115",1333:"1ed03e1ac162feb781d8",1369:"83fb3cbb7deddec367e9",1377:"ffadbe608f885363c5a9",1623:"fbe149964a71f0d036f6",1787:"77eddc04c3dc45c226ca",1897:"396b52df86a364fa80dc",1921:"c9201aa47642cff4a79d",1949:"657755e5eb289dcecccf",2231:"b0828f37548b7cd9a5e7",2268:"d8c0eac4a234ad18cd79",2461:"945e1fb1fe15291891a0",2671:"743c26b8240ae573c500",2834:"3ce23cff17c541f0169b",3148:"74f59966bdaea20c49f1",3340:"73c94673f4484c7deacc",3359:"1c878b33067a3c96e906",3506:"7e697b05655f5c319a31",3539:"35ba94dc4aae7f69a8b5",3546:"5477ff54ecb0d2bbbf4c",3552:"c11aca6a63c79c02f780",3568:"ce1cc9ac610ce40a6038",3621:"3628e13803d5dfba22ae",3699:"39332467c387cc46ce33",3778:"846e23fef6e212b77aec",4028:"112352d20f40e7d4b325",4288:"06f87a6cc0c84070cf2a",4412:"073b484afda9b373b3fd",4507:"20ff9c675a244fc33582",4608:"82779acab146d190138a",4690:"e80608a1705970565f39",4701:"0caef38351691c6d968b",4900:"87815e8c3cc1da7ea942",4934:"2b655579ac69b618952d",5063:"154fcb093f378b60213f",5085:"6ebfe11e3c5130b287d4",5173:"8255817ef893b1dc2f70",5277:"63f38a38ac5fb1d480f2",5303:"80f0673226079ca75227",5593:"37ec7e9629e43e283d3a",5777:"d56558c5f17e2a14dfcb",5806:"12cf74ab0b6a1ef072ac",5848:"3231276d88db380fb420",6108:"ca7f2a550497fe425f46",6144:"5aa1a05537326290c46f",6219:"8e5f703480d328881fc6",6543:"76b531dd2a251d40e4e8",6817:"f657ea993f3d35c47fd3",6849:"20ec8f5961bdb4d8542d",6901:"8454fb9abf1bf6af47dc",6975:"3d6ce9297448ca9dbee4",7029:"16c15ccc7fd90d00b31f",7036:"f0a07db36f4f3aa1ea46",7136:"ce76562531c715c1e085",7157:"31d40809844c4d00b806",7223:"a3db98b7b9571c6d74ce",7329:"938c74f1aa39fdecbc59",7479:"70186a97c19ade699b6a",7504:"7c0b98b8d85ed3d6f18f",7519:"39a72e1577bb03213fc6",7530:"37b0e7a0abdee7ca66e8",7536:"aa179817c032ab587d0c",7544:"d3e42547e781d57bd024",7681:"a570892b3fd73e671c2c",7710:"f7a3b6d191f945f02cc9",7846:"62bdd92ae7a2227734b2",7895:"068f5bcfe8422e85581e",7956:"f8f87551394bc7df0442",7960:"9db0be5084dbe0a2bb60",8006:"42d4879d5d33d6a09e8f",8166:"b05bba741081d97d6dce",8244:"3e4eae5dc817067c218b",8367:"2bf881a6546012326472",8522:"d4ac9e48b4c9154f42cc",8671:"4cfcf94531e11f449312",8812:"f625176b8ee1ab30a1e0",8863:"70e849c3b4934a1e597f",8895:"66f6715df3a63774e9ce",8931:"e4fc7db8fb848777cfda",8967:"8d5471ee59a209cff20e",9190:"692a22ec5ef0f93073f2",9192:"7974ac05e98ae4ceb922",9303:"356af740001135e1eff8",9493:"f38c3ea23f76d8ee2b5b",9516:"d1b166572702abed2927"}[e]+".js"},__webpack_require__.miniCssF=function(e){return"stylesheets/"+e+"-"+{1148:"03165e5d939e22429bc1",3621:"3421bafac1aa5f9b670b",4900:"287abf169c0359619098",6219:"e88824631fea5aac4685"}[e]+".css"},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},inProgress={},dataWebpackPrefix="Frontend:",__webpack_require__.l=function(e,t,n,r){if(inProgress[e])inProgress[e].push(t);else{var a,l;if(void 0!==n)for(var d=document.getElementsByTagName("script"),p=0;p<d.length;p++){var f=d[p];if(f.getAttribute("src")==e||f.getAttribute("data-webpack")==dataWebpackPrefix+n){a=f;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",dataWebpackPrefix+n),a.src=e),inProgress[e]=[t];var h=function(t,n){a.onerror=a.onload=null,clearTimeout(y);var r=inProgress[e];if(delete inProgress[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((function(e){return e(n)})),t)return t(n)},y=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},__webpack_require__.j=8696,__webpack_require__.p="/",function(){if("undefined"!=typeof document){var e=function(e){return new Promise((function(t,n){var r=__webpack_require__.miniCssF(e),a=__webpack_require__.p+r;if(function(e,t){for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var a=(d=n[r]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(a===e||a===t))return d}var l=document.getElementsByTagName("style");for(r=0;r<l.length;r++){var d;if((a=(d=l[r]).getAttribute("data-href"))===e||a===t)return d}}(r,a))return t();!function(e,t,n,r,a){var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onerror=l.onload=function(n){if(l.onerror=l.onload=null,"load"===n.type)r();else{var d=n&&("load"===n.type?"missing":n.type),p=n&&n.target&&n.target.href||t,f=new Error("Loading CSS chunk "+e+" failed.\n("+p+")");f.code="CSS_CHUNK_LOAD_FAILED",f.type=d,f.request=p,l.parentNode&&l.parentNode.removeChild(l),a(f)}},l.href=t,n?n.parentNode.insertBefore(l,n.nextSibling):document.head.appendChild(l)}(e,a,null,t,n)}))},t={8696:0};__webpack_require__.f.miniCss=function(n,r){t[n]?r.push(t[n]):0!==t[n]&&{1148:1,3621:1,4900:1,6219:1}[n]&&r.push(t[n]=e(n).then((function(){t[n]=0}),(function(e){throw delete t[n],e})))}}}(),function(){__webpack_require__.b=document.baseURI||self.location.href;var e={8696:0};__webpack_require__.f.j=function(t,n){var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else if(1148!=t){var a=new Promise((function(n,a){r=e[t]=[n,a]}));n.push(r[2]=a);var l=__webpack_require__.p+__webpack_require__.u(t),d=new Error;__webpack_require__.l(l,(function(n){if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),l=n&&n.target&&n.target.src;d.message="Loading chunk "+t+" failed.\n("+a+": "+l+")",d.name="ChunkLoadError",d.type=a,d.request=l,r[1](d)}}),"chunk-"+t,t)}else e[t]=0},__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,l=n[0],d=n[1],p=n[2],f=0;if(l.some((function(t){return 0!==e[t]}))){for(r in d)__webpack_require__.o(d,r)&&(__webpack_require__.m[r]=d[r]);if(p)var h=p(__webpack_require__)}for(t&&t(n);f<l.length;f++)a=l[f],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(h)},n=self.webpackChunkFrontend=self.webpackChunkFrontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var __webpack_exports__=__webpack_require__.O(void 0,[3296,3845,8182,5743,6029,7184,235,9517,4915,9535,3345,6620,2865,65,9034,8091,9295,7631,4121,9924,2842,4399,5278,9005,2616,6014,1981,6558,6917,9052,868],(function(){return __webpack_require__(93519)}));return __webpack_exports__=__webpack_require__.O(__webpack_exports__),__webpack_exports__}()}));